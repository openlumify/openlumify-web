{"version":3,"sources":["../../js/util/withDropdown.js"],"names":["define","withFormFieldErrors","withDropdown","call","defaultAttrs","cancelButtonSelector","open","attr","disableDropdownFeatures","self","node","$node","scrollParent","syncScrollTop","scrollToNode","tempNode","nodeEl","scrollIntoViewIfNeeded","scrollInfoView","scrollIntoView","scrollTop","parentNode","removeChild","requestAnimationFrame","syncScroll","outerWidth","css","position","_","defer","bind","on","TRANSITION_END","e","oe","originalEvent","target","propertyName","off","transition","height","width","overflow","trigger","form","find","outerHeight","tempScrollTo","$","insertBefore","after","closest","removeClass","remove","buttonLoading","selector","addClass","prop","clearLoading","manualOpen","teardown"],"mappings":"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","file":"withDropdown.js","sourcesContent":["\ndefine(['util/withFormFieldErrors'], function(withFormFieldErrors) {\n    'use strict';\n\n    function withDropdown() {\n\n        withFormFieldErrors.call(this);\n\n        this.defaultAttrs({\n            cancelButtonSelector: '.btn.cancel'\n        });\n\n        this.open = function() {\n            if (this.attr.disableDropdownFeatures) return;\n            var self = this,\n                node = this.$node,\n                scrollParent = node.scrollParent(),\n                syncScrollTop = true,\n                scrollToNode = function(tempNode) {\n                    var nodeEl = tempNode[0];\n                    if (nodeEl.scrollIntoViewIfNeeded) {\n                        nodeEl.scrollIntoViewIfNeeded();\n                    } else if (nodeEl.scrollInfoView) {\n                        nodeEl.scrollIntoView();\n                    }\n                    var scrollTop = scrollParent.scrollTop();\n                    nodeEl.parentNode.removeChild(nodeEl);\n                    requestAnimationFrame(function syncScroll() {\n                        scrollParent.scrollTop(scrollTop);\n                        if (syncScrollTop) {\n                            requestAnimationFrame(syncScroll);\n                        }\n                    })\n                };\n\n            if (node.outerWidth() <= 0) {\n                // Fix issue where dropdown is zero width/height\n                // when opening dropdown later in detail pane when\n                // dropdown is already open earlier in detail pane\n                node.css({position: 'relative'});\n                return _.defer(this.open.bind(this));\n            }\n\n            node.on(TRANSITION_END, function(e) {\n                var oe = e.originalEvent || e;\n\n                if (oe.target === self.node && oe.propertyName === 'height') {\n                    syncScrollTop = false;\n                    node.off(TRANSITION_END);\n                    node.css({\n                        transition: 'none',\n                        height: 'auto',\n                        width: '100%',\n                        overflow: 'visible'\n                    });\n                    self.trigger('opened');\n                }\n            });\n            var form = node.find('.form'),\n                outerHeight = form.outerHeight(true),\n                tempScrollTo = $('<div>')\n                    .css({ height: outerHeight + 'px' })\n                    .insertBefore(node);\n            // Add placeholder node that doesn't animate height which\n            // could confuse the browsers scrollTo logic\n            scrollToNode(tempScrollTo);\n            node.css({ height: outerHeight + 'px' });\n        };\n\n        this.after('teardown', function() {\n            this.trigger('dropdownClosed');\n            if (!this.attr.disableDropdownFeatures) {\n                this.$node.closest('.text').removeClass('dropdown');\n                this.$node.remove();\n            }\n        });\n\n        this.buttonLoading = function(selector) {\n            selector = selector || '.btn-primary';\n            this.$node.find(selector).addClass('loading').prop('disabled', true);\n        };\n\n        this.clearLoading = function() {\n            this.$node.find('.btn:disabled').removeClass('loading').prop('disabled', false);\n        };\n\n        this.manualOpen = function() {\n            if (this.attr.manualOpen) {\n                _.defer(this.open.bind(this));\n                this.attr.manualOpen = false;\n            }\n        }\n\n        this.after('initialize', function() {\n            if (this.attr.disableDropdownFeatures) {\n                this.on('click', {\n                    cancelButtonSelector: function() {\n                        this.trigger('closeDropdown');\n                    }\n                });\n            } else {\n                this.$node.closest('.text').addClass('dropdown');\n                this.on('click', {\n                    cancelButtonSelector: function() {\n                        this.trigger('closeDropdown');\n                        this.teardown();\n                    }\n                });\n                if (!this.attr.manualOpen) {\n                    _.defer(this.open.bind(this));\n                }\n            }\n        });\n    }\n\n    return withDropdown;\n});\n"]}