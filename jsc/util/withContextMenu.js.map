{"version":3,"sources":["../../js/util/withContextMenu.js"],"names":["define","withContextMenu","bindContextMenuClickEvent","$node","find","off","on","onContextMenuClick","bind","event","target","$","name","data","functionName","substring","toUpperCase","func","args","closest","length","stopPropagation","preventDefault","apply","blur","console","error","setTimeout","parent","removeClass","closeMenu","toggleMenu","position","menuElement","offset","padding","windowSize","x","window","width","y","height","menu","menuSize","outerWidth","outerHeight","submenu","submenuSize","placement","left","Math","min","positionInVertex","positionUsingEvent","originalEvent","pageX","top","pageY","submenuPlacement","right","bottom","extend","children","css","dropdown"],"mappings":"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","file":"withContextMenu.js","sourcesContent":["\ndefine([], function() {\n    'use strict';\n\n    return withContextMenu;\n\n    function withContextMenu() {\n\n        this.bindContextMenuClickEvent = function() {\n            this.$node.find('.dropdown-menu a').off('click.bindCtxMenu');\n            this.$node.find('.dropdown-menu a').on('click.bindCtxMenu', this.onContextMenuClick.bind(this));\n        };\n\n        this.onContextMenuClick = function(event) {\n            var target = $(event.target),\n                name = target.data('func'),\n                functionName = name && 'onContextMenu' + name.substring(0, 1).toUpperCase() + name.substring(1),\n                func = functionName && this[functionName],\n                args = target.data('args');\n\n            if (target.closest('li.disabled').length) {\n                event.stopPropagation();\n                event.preventDefault();\n                return;\n            }\n            if (func) {\n                if (!args) {\n                    args = [];\n                }\n                func.apply(this, args);\n            } else if (!functionName) {\n                event.stopPropagation();\n                event.preventDefault();\n                target.blur();\n                return;\n            } else {\n                console.error('No function exists for context menu command: ' + functionName);\n            }\n\n            setTimeout(function() {\n                target.blur();\n                this.$node.find('.dropdown-menu').blur().parent().removeClass('open');\n            }.bind(this), 0);\n        };\n\n        this.closeMenu = function() {\n            this.$node.find('.dropdown-menu').blur().parent().removeClass('open');\n        };\n\n        this.toggleMenu = function(position, menuElement) {\n            this.bindContextMenuClickEvent();\n\n            var offset = this.$node.offset(),\n                padding = 10,\n                windowSize = { x: $(window).width(), y: $(window).height() },\n                menu = menuElement || this.$node.find('.dropdown-menu'),\n                menuSize = { x: menu.outerWidth(true), y: menu.outerHeight(true) },\n                submenu = menu.find('li.dropdown-submenu ul'),\n                submenuSize = menuSize,\n                placement = {\n                    left: Math.min(\n                        position.positionInVertex ?\n                            position.positionInVertex.x :\n                            (position.positionUsingEvent.originalEvent.pageX - offset.left),\n                        windowSize.x - offset.left - menuSize.x - padding\n                    ),\n                    top: Math.min(\n                        position.positionInVertex ?\n                            position.positionInVertex.y :\n                            (position.positionUsingEvent.originalEvent.pageY - offset.top),\n                        windowSize.y - offset.top - menuSize.y - padding\n                    )\n                },\n                submenuPlacement = { left: '100%', right: 'auto', top: 0, bottom: 'auto' };\n            if ((placement.left + menuSize.x + submenuSize.x + padding) > windowSize.x) {\n                submenuPlacement = $.extend(submenuPlacement, { right: '100%', left: 'auto' });\n            }\n            if ((placement.top + menuSize.y + (submenu.children('li').length * 26) + padding) > windowSize.y) {\n                submenuPlacement = $.extend(submenuPlacement, { top: 'auto', bottom: '0' });\n            }\n\n            menu.parent('div').css($.extend({ position: 'absolute' }, placement));\n            submenu.css(submenuPlacement);\n\n            menu.dropdown('toggle');\n        };\n\n    }\n});\n"]}