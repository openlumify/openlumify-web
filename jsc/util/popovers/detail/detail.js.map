{"version":3,"sources":["../../../../js/util/popovers/detail/detail.js"],"names":["define","defineComponent","withPopover","F","withDataRequest","DetailPopover","defaultAttrs","addButtonSelector","cancelButtonSelector","zoomWithGraph","before","trigger","vertexId","attr","after","$node","remove","node","config","template","teardownOnTap","hideDialog","keepInView","self","dialog","css","popover","padding","border","find","on","teardown","show","hide","load","then","done","bind","catch","fail","dataRequest","vertexIds","edgeIds","elements","length","Promise","require","alertTemplate","html","error","i18n","positionDialog","element","Item","attachTo","model","constraints","context"],"mappings":"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","file":"detail.js","sourcesContent":["\ndefine([\n    'flight/lib/component',\n    '../withPopover',\n    'util/vertex/formatters',\n    'util/withDataRequest'\n], function(\n    defineComponent,\n    withPopover,\n    F,\n    withDataRequest) {\n    'use strict';\n\n    return defineComponent(DetailPopover, withPopover, withDataRequest);\n\n    function DetailPopover() {\n\n        this.defaultAttrs({\n            addButtonSelector: '.btn-primary',\n            cancelButtonSelector: '.btn-default',\n            zoomWithGraph: true\n        });\n\n        this.before('teardown', function() {\n            this.trigger('closePreviewVertex', { vertexId: this.attr.vertexId })\n        });\n\n        this.after('teardown', function() {\n            this.$node.remove();\n        })\n\n        this.before('initialize', function(node, config) {\n            config.template = 'detail/template';\n            config.teardownOnTap = false;\n            config.hideDialog = true;\n            config.keepInView = false;\n\n            this.after('setupWithTemplate', function() {\n                var self = this;\n\n                // Make even with graph so below panes\n                this.dialog.css({\n                    'z-index': 50,\n                    'pointer-events': 'none'\n                });\n                this.popover.css({\n                    padding: 0,\n                    'border-radius': '3px',\n                    border: 'none'\n                })\n                this.popover.find('.popover-content').css({\n                    'border-radius': '3px'\n                });\n\n                this.popover.find('.close-popover').css('pointer-events', 'all').on('click', function() {\n                    self.teardown();\n                })\n\n                this.on('show', function() {\n                    this.dialog.show();\n                })\n                this.on('hide', function() {\n                    this.dialog.hide();\n                })\n\n                this.load()\n                    .then(this.done.bind(this))\n                    .catch(this.fail.bind(this));\n            });\n        });\n\n        this.load = function() {\n            if (this.attr.vertexId) {\n                return this.dataRequest('vertex', 'store', { vertexIds: this.attr.vertexId });\n            } else {\n                return this.dataRequest('edge', 'store', { edgeIds: this.attr.edgeIds })\n                    .then(function(elements) {\n                        if (elements.length === 1) {\n                            return elements[0];\n                        }\n                        return elements;\n                    });\n            }\n        };\n\n        this.fail = function() {\n            var self = this;\n            Promise.require('tpl!util/alert').then(function(alertTemplate) {\n                self.popover.find('.popover-content')\n                    .html(alertTemplate({ error: i18n('popovers.preview_vertex.error') }));\n                self.dialog.css('display', 'block');\n                self.positionDialog();\n            })\n        };\n\n        this.done = function(element) {\n            var self = this,\n                $node = this.popover.find('.popover-content .type-content');\n\n            $node.on('finishedLoadingTypeContent errorLoadingTypeContent', function() {\n                self.dialog.css('display', 'block');\n                self.positionDialog();\n            });\n            require(['detail/item/item'], function(Item) {\n                Item.attachTo($node, {\n                    model: element,\n                    constraints: ['width', 'height'],\n                    context: 'popup'\n                });\n            })\n        };\n\n    }\n});\n"]}