define([],function(){'use strict';return withElementScrollingPositionUpdates;function withElementScrollingPositionUpdates(){this.before('teardown',function(){this.removePositionUpdating();});this.after('initialize',function(){this.on('registerForPositionChanges',this.onRegisterForPositionChanges);this.on('unregisterForPositionChanges',this.onUnregisterForPositionChanges);});this.onRegisterForPositionChanges=function(event,data){event.stopPropagation();var range=data.anchorTo&&data.anchorTo.range;if(range){range=range.cloneRange();}var self=this,$target=$(event.target),scroller=data&&data.scrollSelector?$target.closest(data.scrollSelector):$target.scrollParent(),sendPositionChange=function sendPositionChange(){var position=void 0,width=void 0,height=void 0;if(range){var rects=range.getClientRects();var _box=void 0;if(rects.length){_box=_.sortBy(rects,function(r){return r.top*-1;})[0];}else{_box=range.getBoundingClientRect();}width=_box.width;height=_box.height;var _box2=_box,left=_box2.left,top=_box2.top;position={left:left,top:top};if(scroller[0]===document){position.top+=scroller.scrollTop();}}else{width=$target.outerWidth();height=$target.outerHeight();position=$target.offset();if((width===0||height===0)&&_.isFunction(event.target.getBBox)){var box=event.target.getBBox();width=box.width;height=box.height;}}var eventData={position:{x:position.left+width/2,y:position.top+height/2,xMin:position.left,xMax:position.left+width,yMin:position.top,yMax:position.top+height}};if(data&&data.anchorTo){eventData.anchor=data.anchorTo;}self.trigger(event.target,'positionChanged',eventData);};this.positionChangeScroller=scroller;this.sendPositionChange=sendPositionChange;this.on(document,'graphPaddingUpdated',sendPositionChange);scroller.on('scroll.positionchange',sendPositionChange);sendPositionChange();};this.onUnregisterForPositionChanges=function(event,data){this.removePositionUpdating();};this.removePositionUpdating=function(){if(this.positionChangeScroller){this.positionChangeScroller.off('.positionchange');}if(this.sendPositionChange){this.off(document,'graphPaddingUpdated',this.sendPositionChange);}};}});
//# sourceMappingURL=withElementScrollingPositionUpdates.js.map
