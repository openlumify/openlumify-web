{"version":3,"sources":["../../js/util/withWorkspaceHelper.js"],"names":["define","withDataRequest","withWorkspaceHelper","loadWorkspaceAndListenOn","handler","_","isFunction","Error","self","Promise","race","fulfill","reject","on","document","workspaceLoaded","event","workspace","off","dataRequest","then","undefined","done","args","apply"],"mappings":"AAAAA,OAAO,CAAC,mBAAD,CAAP,CAA8B,SAASC,eAAT,CAA0B,CACpD,aAEA,MAAOC,oBAAP,CAEA,QAASA,oBAAT,EAA+B,CAE3B,KAAKC,wBAAL,CAAgC,SAASC,OAAT,CAAkB,CAC9C,GAAI,CAACC,EAAEC,UAAF,CAAaF,OAAb,CAAL,CAA4B,CACxB,KAAM,IAAIG,MAAJ,CAAU,4EAAV,CAAN,CACH,CAED,GAAIC,MAAO,IAAX,CACAC,QAAQC,IAAR,CAAa,CACT,GAAID,QAAJ,CAAY,SAASE,OAAT,CAAkBC,MAAlB,CAA0B,CAClCJ,KAAKK,EAAL,CAAQC,QAAR,CAAkB,iBAAlB,CAAqC,QAASC,gBAAT,CAAyBC,KAAzB,CAAgCC,SAAhC,CAA2C,CAC5ET,KAAKU,GAAL,CAASJ,QAAT,CAAmB,iBAAnB,CAAsCC,eAAtC,EACAP,KAAKK,EAAL,CAAQC,QAAR,CAAkB,iBAAlB,CAAqCV,OAArC,EACAO,QAAQ,CAACK,KAAD,CAAQC,SAAR,CAAR,EACH,CAJD,EAKH,CAND,CADS,CAQThB,gBAAgBkB,WAAhB,CAA4B,WAA5B,CAAyC,SAAzC,EACCC,IADD,CACM,SAASH,SAAT,CAAoB,CACtB,GAAI,CAACA,SAAL,CAAgB,CACZ,MAAO,IAAIR,QAAJ,CAAY,UAAW,CAAG,CAA1B,CAAP,CACH,CAED,MAAO,CAACY,SAAD,CAAYJ,SAAZ,CAAP,CACH,CAPD,CARS,CAAb,EAgBGK,IAhBH,CAgBQ,SAASC,IAAT,CAAe,CACnBnB,QAAQoB,KAAR,CAAchB,IAAd,CAAoBe,IAApB,EACH,CAlBD,EAmBH,CAzBD,CA0BH,CACJ,CAlCD","file":"withWorkspaceHelper.js","sourcesContent":["define(['./withDataRequest'], function(withDataRequest) {\n    'use strict';\n\n    return withWorkspaceHelper;\n\n    function withWorkspaceHelper() {\n\n        this.loadWorkspaceAndListenOn = function(handler) {\n            if (!_.isFunction(handler)) {\n                throw new Error('handler must be a function. Will be called once when loaded and on changes');\n            }\n\n            var self = this;\n            Promise.race([\n                new Promise(function(fulfill, reject) {\n                    self.on(document, 'workspaceLoaded', function workspaceLoaded(event, workspace) {\n                        self.off(document, 'workspaceLoaded', workspaceLoaded);\n                        self.on(document, 'workspaceLoaded', handler);\n                        fulfill([event, workspace]);\n                    });\n                }),\n                withDataRequest.dataRequest('workspace', 'current')\n                .then(function(workspace) {\n                    if (!workspace) {\n                        return new Promise(function() { });\n                    }\n\n                    return [undefined, workspace];\n                })\n            ]).done(function(args) {\n                handler.apply(self, args);\n            })\n        };\n    }\n});\n"]}