function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}define(['util/vertex/formatters'],function(F){var FALLBACK_PREFIX='OpenLumify_ElementIds: ';var supportsMultipleTypes=void 0;var checkIfSupportsMultipleTypes=function checkIfSupportsMultipleTypes(dataTransfer){if(supportsMultipleTypes!==undefined){return supportsMultipleTypes;}else{try{dataTransfer.setData('CHECK_ALLOWS_MANY_TYPES','true');var data=dataTransfer.getData('CHECK_ALLOWS_MANY_TYPES');if(data){supportsMultipleTypes=true;}return true;}catch(e){if(e.name==='NoModificationAllowedError'){return true;}else{supportsMultipleTypes=false;return false;}}}};return{dataTransferHasValidMimeType:function dataTransferHasValidMimeType(dataTransfer){var mimeTypes=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];if(checkIfSupportsMultipleTypes(dataTransfer)){return _.any(dataTransfer.types,function(type){return mimeTypes.includes(type);});}else{var text=dataTransfer.getData('Text');return text&&text.startsWith(FALLBACK_PREFIX)&&mimeTypes.includes(VISALLO_MIMETYPES.ELEMENTS);}},setDataTransferWithElements:function setDataTransferWithElements(dataTransfer,_ref){var vertexIds=_ref.vertexIds,edgeIds=_ref.edgeIds,_ref$elements=_ref.elements,elements=_ref$elements===undefined?[]:_ref$elements;var typeToData=segmentToTypes(vertexIds,edgeIds,elements);if(checkIfSupportsMultipleTypes(dataTransfer)){_.each(typeToData,function(data,type){if(data){dataTransfer.setData(type,data);}});}else{dataTransfer.setData('Text',FALLBACK_PREFIX+typeToData[VISALLO_MIMETYPES.ELEMENTS]);}dataTransfer.effectAllowed='all';Promise.all([Promise.require('data/web-worker/store/element/actions'),openlumifyData.storePromise]).spread(function(actions,store){return store.dispatch(actions.setFocus({elementIds:[]}));});},getElementsFromDataTransfer:function getElementsFromDataTransfer(dataTransfer){var dataStr;if(checkIfSupportsMultipleTypes(dataTransfer)){dataStr=dataTransfer.getData(VISALLO_MIMETYPES.ELEMENTS);}else{var text=dataTransfer.getData('Text');if(text&&text.indexOf(FALLBACK_PREFIX)===0){dataStr=text.substring(FALLBACK_PREFIX.length);}}if(dataStr){return JSON.parse(dataStr);}}};function segmentToTypes(){var vertexIds=arguments.length>0&&arguments[0]!==undefined?arguments[0]:[];var edgeIds=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];var elements=arguments[2];var hasFullElements=elements.length>0;if(hasFullElements){vertexIds=[];edgeIds=[];elements.forEach(function(_ref2){var id=_ref2.id,type=_ref2.type;if(type==='extendedDataRow'){if(id.elementType==='VERTEX'){vertexIds.push(id.elementId);}else{edgeIds.push(id.elementId);}}else if(type==='vertex'){vertexIds.push(id);}else{edgeIds.push(id);}});}var url=F.vertexUrl.url(hasFullElements?elements:vertexIds.concat(edgeIds),openlumifyData.currentWorkspaceId);var plain=hasFullElements?elements.map(function(item){return[F.vertex.title(item),F.vertexUrl.url([item],openlumifyData.currentWorkspaceId)].join('\n');}).join('\n\n'):url;return _defineProperty({'text/uri-list':url,'text/plain':plain,'Text':plain},VISALLO_MIMETYPES.ELEMENTS,JSON.stringify({vertexIds:vertexIds,edgeIds:edgeIds}));}});
//# sourceMappingURL=dnd.js.map
