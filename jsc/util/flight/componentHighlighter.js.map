{"version":3,"sources":["../../../js/util/flight/componentHighlighter.js"],"names":["define","registry","highlighter","$","addClass","css","appendTo","document","body","highlightComponents","enable","$doc","off","hide","on","_","debounce","mouseover","eventsFromComponentInstances","instances","events","Object","keys","forEach","identifier","instanceInfo","event","push","type","chain","unique","sortBy","e","value","nameFromComponent","component","toString","split","filter","test","n","sort","join","logComponent","name","closestComponent","info","console","groupCollapsed","log","groupEnd","node","highlightNode","$node","position","offset","height","outerHeight","parent","attr","left","Math","round","top","width","outerWidth","show","shortestSteps","Number","MAX_VALUE","components","componentInfo","attachedTo","instance","popover","walkNode","target","found","steps","parentNode"],"mappings":"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","file":"componentHighlighter.js","sourcesContent":["\ndefine(['flight/lib/registry'], function(registry) {\n    'use strict';\n\n    var highlighter = $('<div>')\n        .addClass('component-highlighter')\n        .css({\n        })\n        .appendTo(document.body)\n\n    return {\n        highlightComponents: function(enable) {\n            var $doc = $(document).off('.highlightcomps');\n            highlighter.hide();\n            if (enable) {\n                $doc.on('mouseover.highlightcomps', _.debounce(mouseover, 50))\n            }\n        }\n    };\n\n    function eventsFromComponentInstances(instances) {\n        var events = [];\n        Object.keys(instances).forEach(function(identifier) {\n            var instanceInfo = instances[identifier];\n            instanceInfo.events.forEach(function(event) {\n                events.push(event.type);\n            })\n        })\n        events = _.chain(events)\n           .unique()\n           .sortBy(function(e) {\n               return e;\n           })\n           .value();\n\n        return events;\n    }\n\n    function nameFromComponent(component) {\n        return component.toString()\n            .split(/\\s*,\\s*/)\n            .filter(n => !/^with/.test(n))\n            .sort()\n            .join(',')\n    }\n\n    function logComponent(name, closestComponent) {\n        var events = eventsFromComponentInstances(closestComponent.info.instances);\n\n        console.groupCollapsed('Found Component: ' + name);\n        /*eslint no-lone-blocks:0*/\n        {\n            console.groupCollapsed('Listens for events');\n            {\n                console.log(events.join(', '))\n            }\n            console.groupEnd();\n\n            console.groupCollapsed('Bound to Node');\n            {\n                console.log(closestComponent.node)\n            }\n            console.groupEnd();\n\n            console.groupCollapsed('Flight Component Info');\n            {\n                console.log(closestComponent.info)\n            }\n            console.groupEnd();\n        }\n        console.groupEnd();\n    }\n\n    function highlightNode(node, name) {\n        var $node = $(node),\n            position = $node.offset();\n\n        if (position) {\n            var height = $node.outerHeight() || $node.parent().outerHeight();\n\n            highlighter.attr('data-name', name);\n            highlighter.css({\n                left: Math.round(position.left) + 'px',\n                top: Math.round(position.top) + 'px',\n                width: $node.outerWidth(),\n                height: $node.outerHeight() || $node.parent().outerHeight()\n            }).show();\n        }\n    }\n\n    function mouseover(event) {\n        var closestComponent,\n            shortestSteps = Number.MAX_VALUE;\n\n        highlighter.hide();\n\n        registry.components.forEach(function(componentInfo) {\n            componentInfo.attachedTo.forEach(function(node) {\n                Object.keys(componentInfo.instances).forEach(function(identifier) {\n                    var instanceInfo = componentInfo.instances[identifier];\n                    if (instanceInfo.instance.popover) {\n                        node = instanceInfo.instance.popover[0];\n                    }\n                })\n                var walkNode = event.target,\n                    found = false,\n                    steps = 0;\n\n                while (walkNode) {\n                    if (walkNode === node) {\n                        found = true;\n                        break;\n                    }\n                    walkNode = walkNode.parentNode;\n                    steps++;\n                }\n\n                if (found && steps < shortestSteps) {\n                    shortestSteps = steps;\n                    closestComponent = {\n                        info: componentInfo,\n                        node: node,\n                        steps: steps\n                    };\n                }\n            })\n        })\n\n        if (closestComponent) {\n            var name = nameFromComponent(closestComponent.info.component);\n\n            logComponent(name, closestComponent);\n\n            highlightNode(closestComponent.node, name);\n        }\n    }\n});\n"]}