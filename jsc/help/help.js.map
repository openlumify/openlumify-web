{"version":3,"sources":["../../js/help/help.js"],"names":["define","defineComponent","F","helpTemplate","sectionsTemplate","SCOPE_SORTING_HINTS","map","i18n","Help","prettyCommand","shortcut","string","character","sortFn","s1","s2","i1","indexOf","i2","length","after","allShortcuts","onRegisterKeyboardShortcuts","_","debounce","bind","on","onEscape","document","onDisplay","onKeyboardShortcutsRegistered","$node","html","trigger","scope","shortcuts","escape","fire","desc","e","data","find","scopes","Object","keys","sort","className","toLowerCase","title","display","key","is","modal","defer","stopPropagation"],"mappings":"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","file":"help.js","sourcesContent":["\ndefine([\n    'flight/lib/component',\n    'util/formatters',\n    './help.hbs',\n    './sections.hbs'\n], function(\n    defineComponent,\n    F,\n    helpTemplate,\n    sectionsTemplate) {\n    'use strict';\n\n    var SCOPE_SORTING_HINTS = [\n        'openlumify.help.scope',\n        'search.help.scope',\n        'graph.help.scope',\n        'map.help.scope'\n    ].map(i18n);\n\n    return defineComponent(Help);\n\n    function prettyCommand(shortcut) {\n        return F.string.shortcut(shortcut.character, shortcut);\n    }\n\n    function sortFn(s1, s2) {\n        var i1 = SCOPE_SORTING_HINTS.indexOf(s1),\n            i2 = SCOPE_SORTING_HINTS.indexOf(s2);\n\n        if (i1 < 0) i1 = SCOPE_SORTING_HINTS.length;\n        if (i2 < 0) i2 = SCOPE_SORTING_HINTS.length;\n\n        return i1 === i2 ? 0 : i1 > i2;\n    }\n\n    function Help() {\n        this.after('initialize', function() {\n            this.allShortcuts = {};\n\n            this.onRegisterKeyboardShortcuts = _.debounce(this.onRegisterKeyboardShortcuts.bind(this), 1000);\n\n            this.on('escape', this.onEscape);\n            this.on(document, 'toggleHelp', this.onDisplay);\n            this.on(document, 'keyboardShortcutsRegistered', this.onKeyboardShortcutsRegistered);\n            this.on(document, 'registerKeyboardShortcuts', this.onRegisterKeyboardShortcuts);\n\n            this.$node.html(helpTemplate({}));\n\n            this.trigger(document, 'registerKeyboardShortcuts', {\n                scope: 'Help',\n                shortcuts: {\n                    escape: { fire: 'escape', desc: i18n('help.shortcut.escape.desc') },\n                    'shift-/': { fire: 'toggleHelp', desc: i18n('help.shortcut.toggle.desc') }\n                }\n            })\n            this.trigger(document, 'requestKeyboardShortcuts');\n\n        });\n\n        this.onRegisterKeyboardShortcuts = function() {\n            // Shortcuts updated, regenerate list from keyboard.js\n            this.trigger(document, 'requestKeyboardShortcuts');\n        };\n\n        this.onKeyboardShortcutsRegistered = function(e, data) {\n            this.$node.find('ul').html(\n                sectionsTemplate({\n                    scopes: Object.keys(data).sort(sortFn).map(scope => ({\n                        className: scope.toLowerCase(),\n                        title: scope,\n                        shortcuts: Object.keys(data[scope]).sort().map(key => ({\n                            display: prettyCommand(data[scope][key]),\n                            desc: data[scope][key].desc\n                        }))\n                    }))\n                })\n            );\n        };\n\n        this.onDisplay = function(e) {\n            if (this.$node.is(':visible')) {\n                this.$node.modal('hide');\n            } else {\n                this.$node.modal();\n                _.defer(function() {\n                    this.trigger('focusComponent');\n                }.bind(this));\n            }\n        };\n\n        this.onEscape = function(e) {\n            this.$node.modal('hide');\n            e.stopPropagation();\n        };\n    }\n});\n"]}