{"version":3,"sources":["../../../../../js/data/web-worker/store/product/selectors.js"],"names":["define","reselect","elementSelectors","createSelector","getWorkspaceId","state","workspace","currentId","getSelection","selection","idsByType","getFocused","element","focusing","getProductWorkspaces","product","workspaces","getProductTypes","types","getInteracting","interacting","getProductState","workspaceId","productWorkspaces","getPreviewHashesById","productState","previewHashes","getProductsById","products","getViewportsByProductId","viewports","getProducts","productsById","_","chain","values","sortBy","value","getSelectedId","selected","getViewport","productId","getProduct","getPreviewHash","getElementIdsInProduct","extendedData","elementIds","vertices","edges","mapObject","elements","pick","e","unauthorized","getElementsInProduct","getElements","Object","keys","getSelectedElementsInProduct","indexBy","intersection","getFocusedElementsInProduct","focused","isFocusing","forEach","vertexId","vertexIds","edgeId","edgeIds","getStatus","loading","loaded"],"mappings":"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","file":"selectors.js","sourcesContent":["define(['reselect', '../element/selectors'], function(reselect, elementSelectors) {\n    const { createSelector } = reselect;\n\n    const getWorkspaceId = (state) => state.workspace.currentId;\n\n    const getSelection = (state) => state.selection.idsByType;\n\n    const getFocused = (state) => state.element.focusing;\n\n    const getProductWorkspaces = (state) => state.product.workspaces;\n\n    const getProductTypes = (state) => state.product.types || [];\n\n    const getInteracting = (state) => state.product.interacting;\n\n    const getProductState = createSelector([getWorkspaceId, getProductWorkspaces], (workspaceId, productWorkspaces) => {\n        return productWorkspaces[workspaceId];\n    })\n\n    const getPreviewHashesById = createSelector([getProductState], (productState) => {\n        return productState ? productState.previewHashes : {};\n    })\n\n    const getProductsById = createSelector([getProductState], (productState) => {\n        return productState ? productState.products : {};\n    })\n\n    const getViewportsByProductId = createSelector([getProductState], (productState) => {\n        return productState && productState.viewports || {};\n    })\n\n    const getProducts = createSelector([getProductsById], (productsById) => {\n        return _.chain(productsById)\n            .values()\n            .sortBy('id')\n            .sortBy('title')\n            .sortBy('kind')\n            .value()\n    });\n\n    const getSelectedId = createSelector([getProductState], (productState) => {\n        return productState ? productState.selected : null\n    });\n\n    const getViewport = createSelector([getViewportsByProductId, getSelectedId], (viewports, productId) => {\n        return productId ? viewports[productId] : null\n    })\n\n    const getProduct = createSelector([getProductsById, getSelectedId], (productsById, productId) => {\n        return productId ? productsById[productId] : null;\n    })\n\n    const getPreviewHash = createSelector([getPreviewHashesById, getSelectedId], (previewHashes, productId) => {\n        return productId ? previewHashes[productId] : null;\n    })\n\n    const getElementIdsInProduct = createSelector([getProduct], (product) => {\n        if (product && product.extendedData) {\n            const elementIds = { vertices: product.extendedData.vertices, edges: product.extendedData.edges };\n            return _.mapObject(elementIds, (elements) => _.pick(elements, e => e.unauthorized !== true));\n        } else {\n            return { vertices: {}, edges: {} };\n        }\n    });\n\n    const getElementsInProduct = createSelector([getElementIdsInProduct, elementSelectors.getElements], (elementIds, elements) => {\n        const { vertices, edges } = elementIds;\n        return {\n            vertices: _.pick(elements.vertices, Object.keys(vertices)),\n            edges: _.pick(elements.edges, Object.keys(edges))\n        };\n    })\n\n    const getSelectedElementsInProduct = createSelector([getSelection, getElementIdsInProduct], (selection, elementIds) => {\n        const { vertices, edges } = elementIds;\n        return {\n            vertices: _.indexBy(_.intersection(selection.vertices, Object.keys(vertices))),\n            edges: _.indexBy(_.intersection(selection.edges, Object.keys(edges)))\n        };\n    });\n\n    const getFocusedElementsInProduct = createSelector([getFocused, getElementIdsInProduct], (focusing, elementIds) => {\n        const { vertices, edges } = elementIds;\n        const focused = {\n            vertices: {},\n            edges: {},\n            isFocusing: false\n        };\n        Object.keys(vertices).forEach(vertexId => {\n            if (vertexId in focusing.vertexIds) {\n                focused.vertices[vertexId] = true;\n                focused.isFocusing = true;\n            }\n        });\n        Object.keys(edges).forEach(edgeId => {\n            if (edgeId in focusing.edgeIds) {\n                focused.edges[edgeId] = true;\n                focused.isFocusing = true;\n            }\n        })\n        return focused;\n    });\n\n    const getStatus = createSelector([getProductState], (productState) => {\n        return productState ? _.pick(productState, 'loading', 'loaded') : { loading: false, loaded: false }\n    })\n\n    return {\n        getStatus,\n        getSelectedId,\n        getProduct,\n        getViewport,\n        getProducts,\n        getPreviewHash,\n        getProductsById,\n        getPreviewHashesById,\n        getProductTypes,\n        getInteracting,\n        getElementIdsInProduct,\n        getElementsInProduct,\n        getSelectedElementsInProduct,\n        getFocusedElementsInProduct\n    };\n})\n\n"]}