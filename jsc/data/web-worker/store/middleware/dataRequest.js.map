{"version":3,"sources":["../../../../../js/data/web-worker/store/middleware/dataRequest.js"],"names":["define","storeActions","dataRequest","dispatch","next","action","isValidAction","type","payload","service","name","params","prefix","join","Promise","require","then","apply","result","catch","error","isPromise","obj","_","isFunction"],"mappings":"gOAAAA,OAAO,CAAC,YAAD,CAAP,CAAuB,SAASC,YAAT,CAAuB,CAC1C,aAEA,MAAOC,YAAP,CAIA,QAASA,YAAT,MAAmC,IAAZC,SAAY,MAAZA,QAAY,CAC/B,MAAO,UAAUC,IAAV,CAAgB,CACnB,MAAO,UAAUC,MAAV,CAAkB,CACrB,GAAIJ,aAAaK,aAAb,CAA2BD,MAA3B,CAAJ,CAAwC,CACpC,GAAIA,OAAOE,IAAP,GAAgB,aAApB,CAAmC,qBACQF,OAAOG,OADf,CACvBC,OADuB,iBACvBA,OADuB,CACdC,IADc,iBACdA,IADc,uCACRC,MADQ,CACRA,MADQ,mCACC,EADD,uBAE/B,GAAMC,QAAS,CAACH,OAAD,CAAUC,IAAV,CAAgB,aAAhB,EAA+BG,IAA/B,CAAoC,GAApC,CAAf,CACA,MAAOC,SAAQC,OAAR,6BAA4CN,OAA5C,EACFO,IADE,CACG,SAASP,OAAT,CAAkB,CACpBN,SAAS,CACLI,KAAMK,OAAS,SADV,CAELJ,oBAAcH,OAAOG,OAArB,CAFK,CAAT,EAIA,MAAOC,SAAQC,IAAR,EAAcO,KAAd,CAAoB,IAApB,CAA0BN,MAA1B,CAAP,CACH,CAPE,EAQFK,IARE,CAQG,SAASE,MAAT,CAAiB,CACnBf,SAAS,CACLI,KAAMK,OAAS,SADV,CAELJ,oBAAcH,OAAOG,OAArB,EAA8BU,aAA9B,EAFK,CAAT,EAIH,CAbE,EAcFC,KAdE,CAcI,SAASC,KAAT,CAAgB,CACnBjB,SAAS,CACLI,KAAMK,OAAS,SADV,CAELJ,oBAAcH,OAAOG,OAArB,EAA8BY,WAA9B,EAFK,CAAT,EAIH,CAnBE,CAAP,CAoBH,CACJ,CAEDhB,KAAKC,MAAL,EACH,CA7BD,CA8BH,CA/BD,CAiCA,QAASgB,UAAT,CAAmBC,GAAnB,CAAwB,CACpB,MAAOA,MAAOC,EAAEC,UAAF,CAAaF,IAAIN,IAAjB,CAAd,CACH,CACJ,CACJ,CA7CD","file":"dataRequest.js","sourcesContent":["define(['../actions'], function(storeActions) {\n    'use strict';\n\n    return dataRequest;\n\n    // Transforms dataRequest actions into promise chain which\n    // dispatches multiple actions about the state of request\n    function dataRequest({ dispatch }) {\n        return function (next) {\n            return function (action) {\n                if (storeActions.isValidAction(action)) {\n                    if (action.type === 'dataRequest') {\n                        const { service, name, params = [] } = action.payload;\n                        const prefix = [service, name, 'dataRequest'].join('_');\n                        return Promise.require(`data/web-worker/services/${service}`)\n                            .then(function(service) {\n                                dispatch({\n                                    type: prefix + 'Loading',\n                                    payload: { ...action.payload }\n                                })\n                                return service[name].apply(null, params)\n                            })\n                            .then(function(result) {\n                                dispatch({\n                                    type: prefix + 'Success',\n                                    payload: { ...action.payload, result }\n                                })\n                            })\n                            .catch(function(error) {\n                                dispatch({\n                                    type: prefix + 'Failure',\n                                    payload: { ...action.payload, error }\n                                })\n                            })\n                    }\n                }\n\n                next(action);\n            };\n        };\n\n        function isPromise(obj) {\n            return obj && _.isFunction(obj.then);\n        }\n    }\n})\n"]}