{"version":3,"sources":["../../../../js/data/web-worker/util/queue.js"],"names":["define","queue","func","stack","promise","args","Array","prototype","slice","call","arguments","thisPromise","p","apply","tap","index","_","findIndex","splice","length","push","isCancelled","then"],"mappings":"AACAA,OAAO,EAAP,CAAW,UAAW,CAClB,aACA,MAAO,SAASC,MAAT,CAAeC,IAAf,CAAqB,CACxB,GAAIC,OAAQ,EAAZ,CAAgBC,OAAhB,CACA,MAAO,WAAW,CACd,GAAIC,MAAOC,MAAMC,SAAN,CAAgBC,KAAhB,CAAsBC,IAAtB,CAA2BC,SAA3B,CAAsC,CAAtC,CAAX,CACIC,YAAc,QAAdA,YAAc,EAAW,CACrB,GAAIC,GAAIV,KAAKW,KAAL,CAAW,IAAX,CAAiBR,IAAjB,CAAR,CACAO,EAAEE,GAAF,CAAM,UAAW,CACb,GAAIC,OAAQC,EAAEC,SAAF,CAAYd,KAAZ,CAAmBS,CAAnB,CAAZ,CACA,GAAIG,OAAS,CAAb,CAAgB,CACZZ,MAAMe,MAAN,CAAaH,KAAb,CAAoB,CAApB,EACH,CACD,GAAIZ,MAAMgB,MAAN,GAAiB,CAArB,CAAwB,CACpBf,QAAU,IAAV,CACH,CACJ,CARD,EASAD,MAAMiB,IAAN,CAAWR,CAAX,EACA,MAAOA,EAAP,CACH,CAdL,CAgBA,GAAIR,SAAW,CAACA,QAAQiB,WAAR,EAAhB,CAAuC,CACnCjB,QAAUA,QAAQkB,IAAR,CAAaX,WAAb,CAAV,CACH,CAFD,IAEO,CACHP,QAAUO,aAAV,CACH,CAED,MAAOP,QAAP,CACH,CAxBD,CAyBH,CA3BD,CA4BH,CA9BD","file":"queue.js","sourcesContent":["\ndefine([], function() {\n    'use strict';\n    return function queue(func) {\n        var stack = [], promise;\n        return function() {\n            var args = Array.prototype.slice.call(arguments, 0),\n                thisPromise = function() {\n                    var p = func.apply(null, args);\n                    p.tap(function() {\n                        var index = _.findIndex(stack, p);\n                        if (index >= 0) {\n                            stack.splice(index, 1);\n                        }\n                        if (stack.length === 0) {\n                            promise = null;\n                        }\n                    })\n                    stack.push(p);\n                    return p;\n                };\n\n            if (promise && !promise.isCancelled()) {\n                promise = promise.then(thisPromise)\n            } else {\n                promise = thisPromise();\n            }\n\n            return promise;\n        }\n    };\n});\n"]}