{"version":3,"sources":["../../js/data/withPublicApi.js"],"names":["define","withPublicApi","before","openlumifyData","window","after","on","document","onSetPublicApi","event","data","setPublicApi","key","obj","options","_","extend","onlyIfNull","trigger","object","worker","postMessage","type"],"mappings":"AAAAA,OAAO,EAAP,CAAW,UAAW,CAClB,aAEA,MAAOC,cAAP,CAEA,QAASA,cAAT,EAAyB,CAErB,KAAKC,MAAL,CAAY,YAAZ,CAA0B,UAAW,CACjC,KAAKC,cAAL,CAAsB,EAAtB,CACAC,OAAOD,cAAP,CAAwB,KAAKA,cAA7B,CACH,CAHD,EAKA,KAAKE,KAAL,CAAW,YAAX,CAAyB,UAAW,CAChC,KAAKC,EAAL,CAAQC,QAAR,CAAkB,cAAlB,CAAkC,KAAKC,cAAvC,EACH,CAFD,EAIA,KAAKA,cAAL,CAAsB,SAASC,KAAT,CAAgBC,IAAhB,CAAsB,CACxC,KAAKC,YAAL,CAAkBD,KAAKE,GAAvB,CAA4BF,KAAKG,GAAjC,EACH,CAFD,CAIA,KAAKF,YAAL,CAAoB,SAASC,GAAT,CAAcC,GAAd,CAAmBC,OAAnB,CAA4B,CAC5CA,QAAUC,EAAEC,MAAF,CAAS,CACXC,WAAY,KADD,CAAT,CAEHH,SAAW,EAFR,CAAV,CAIA,GAAIA,QAAQG,UAAR,EAAuBL,MAAO,MAAKT,cAAvC,CAAwD,CACpD,OACH,CAED,GAAI,MAAOU,IAAP,GAAe,WAAnB,CAAgC,CAC5B,MAAO,MAAKV,cAAL,CAAoBS,GAApB,CAAP,CACH,CAFD,IAEO,CACH,KAAKT,cAAL,CAAoBS,GAApB,EAA2BC,GAA3B,CACA,KAAKK,OAAL,CAAaN,IAAM,uBAAnB,CAA4C,CACxCA,IAAKA,GADmC,CAExCO,OAAQN,GAFgC,CAA5C,EAIH,CAED,KAAKO,MAAL,CAAYC,WAAZ,CAAwB,CACpBC,KAAM,WADc,CAEpBV,IAAKA,GAFe,CAGpBC,IAAKA,GAHe,CAAxB,EAKH,CAxBD,CAyBH,CACJ,CA9CD","file":"withPublicApi.js","sourcesContent":["define([], function() {\n    'use strict';\n\n    return withPublicApi;\n\n    function withPublicApi() {\n\n        this.before('initialize', function() {\n            this.openlumifyData = {};\n            window.openlumifyData = this.openlumifyData;\n        });\n\n        this.after('initialize', function() {\n            this.on(document, 'setPublicApi', this.onSetPublicApi);\n        });\n\n        this.onSetPublicApi = function(event, data) {\n            this.setPublicApi(data.key, data.obj);\n        };\n\n        this.setPublicApi = function(key, obj, options) {\n            options = _.extend({\n                    onlyIfNull: false\n                }, options || {});\n\n            if (options.onlyIfNull && (key in this.openlumifyData)) {\n                return;\n            }\n\n            if (typeof obj === 'undefined') {\n                delete this.openlumifyData[key];\n            } else {\n                this.openlumifyData[key] = obj;\n                this.trigger(key + 'OpenLumifyDataUpdated', {\n                    key: key,\n                    object: obj\n                });\n            }\n\n            this.worker.postMessage({\n                type: 'publicApi',\n                key: key,\n                obj: obj\n            });\n        }\n    }\n});\n"]}