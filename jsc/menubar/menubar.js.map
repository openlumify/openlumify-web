{"version":3,"sources":["../../js/menubar/menubar.js"],"names":["define","defineComponent","registry","Activity","template","AdminList","BUTTONS","split","PANE_AUXILIARY","products","name","action","type","componentPath","TOOLTIPS","activity","i18n","dashboard","search","workspaces","admin","logout","MUTALLY_EXCLUSIVE_SWITCHES","names","options","allowCollapse","ACTION_TYPES","full","pane","url","DISABLE_ACTIVE_SWITCH","DISABLE_HIDE_TOOLTIP_ON_CLICK","Menubar","nameToI18N","menubarItemHandler","sel","e","preventDefault","self","isSwitch","indexOf","forEach","exclusive","i","icon","select","_","contains","tooltip","hasClass","toggleClass","requestAnimationFrame","data","extensions","flashIcon","window","open","aux","trigger","document","addClass","delay","removeClass","activities","attrs","events","documentExtensionPoint","extensionsForPoint","cls","identifier","push","title","defaultAttrs","after","$node","html","isAdmin","getExtensions","length","insertExtensions","button","find","attr","Object","keys","selectorClass","placement","replace","show","hide","on","attachTo","productsIconSelector","event","$","dataTransfer","originalEvent","any","types","VISALLO_MIMETYPES","ELEMENTS","node","onMenubarToggle","onGraphPaddingUpdated","identifiers","pluck","dependenciesForId","sorted","chain","each","placementHint","placementHintAfter","placementHintBefore","console","warn","values","value","sort","e1","e2","deps1","deps2","vals","flatten","item","extend","anchorCss","newItem","append","text","css","container","$placement","insertAfter","insertBefore","len","approximateHeight","approximateNoTextHeight","windowHeight","height","auxName","findKey","a","isAux","Boolean","active","exclusiveName","otherIcon","otherIsActive","isSwitchButCollapse","setTimeout"],"mappings":"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","file":"menubar.js","sourcesContent":["\ndefine([\n    'flight/lib/component',\n    'configuration/plugins/registry',\n    './activity/activity',\n    './menubar.hbs',\n    'admin/admin'\n], function(defineComponent, registry, Activity, template, AdminList) {\n    'use strict';\n\n    // Add class name of <li> buttons here\n    var BUTTONS = 'dashboard search workspaces products admin activity logout'.split(' '),\n        PANE_AUXILIARY = {\n            products: { name: 'products-full', action: { type: 'full', componentPath: 'product/ProductDetailContainer' } }\n        },\n        TOOLTIPS = {\n            activity: i18n('menubar.icons.activity.tooltip'),\n            dashboard: i18n('menubar.icons.dashboard.tooltip'),\n            search: i18n('menubar.icons.search.tooltip'),\n            workspaces: i18n('menubar.icons.workspaces.tooltip'),\n            products: i18n('menubar.icons.products.tooltip'),\n            admin: i18n('menubar.icons.admin.tooltip'),\n            logout: i18n('menubar.icons.logout.tooltip')\n        },\n\n        // Which cannot both be active\n        MUTALLY_EXCLUSIVE_SWITCHES = [\n            { names: ['dashboard', 'products'], options: {} },\n            { names: ['dashboard', 'products-full'], options: { allowCollapse: false } },\n            { names: ['workspaces', 'search', 'admin', 'products'], options: { } }\n        ],\n\n        ACTION_TYPES = {\n            full: MUTALLY_EXCLUSIVE_SWITCHES[1],\n            pane: MUTALLY_EXCLUSIVE_SWITCHES[2],\n            url: { names: [], options: {}}\n        },\n\n        // Don't change state to highlighted on click\n        DISABLE_ACTIVE_SWITCH = 'logout'.split(' '),\n\n        DISABLE_HIDE_TOOLTIP_ON_CLICK = 'logout'.split(' ');\n\n    return defineComponent(Menubar);\n\n    function nameToI18N(name) {\n        return i18n('menubar.icons.' + name);\n    }\n\n    function menubarItemHandler(name) {\n        var sel = name + 'IconSelector';\n\n        return function(e) {\n            e.preventDefault();\n\n            var self = this,\n                isSwitch = false,\n                type = 'pane';\n\n            if (DISABLE_ACTIVE_SWITCH.indexOf(name) === -1) {\n                MUTALLY_EXCLUSIVE_SWITCHES.forEach(function(exclusive, i) {\n                    if (exclusive.names.indexOf(name) !== -1) {\n                        if (exclusive.options.allowCollapse === false) {\n                            isSwitch = true;\n                        }\n                        if (i === 0) {\n                            type = 'full';\n                        }\n                    }\n                });\n            }\n            var icon = this.select(sel);\n            if (!_.contains(DISABLE_HIDE_TOOLTIP_ON_CLICK, name)) {\n                icon.tooltip('hide');\n            }\n\n            if (isSwitch && icon.hasClass('active')) {\n                icon.toggleClass('toggled');\n            } else {\n                requestAnimationFrame(function() {\n                    var data = { name: name };\n                    if (name in self.extensions) {\n                        data.action = self.extensions[name].action;\n                    }\n                    if (data.action && data.action.type === 'url') {\n                        flashIcon(icon);\n                        window.open(data.action.url);\n                    } else {\n                        var aux = PANE_AUXILIARY[name];\n                        if (aux) {\n                            if (!icon.hasClass('active-aux') && icon.hasClass('only-open-auxiliary')) {\n                                self.trigger(document, 'menubarToggleDisplay', {\n                                    name: aux.name, action: aux.action\n                                });\n                                return;\n                            }\n                            icon.toggleClass('only-open-auxiliary', icon.hasClass('active'));\n                        }\n                        self.trigger(document, 'menubarToggleDisplay', data);\n                    }\n                });\n            }\n        };\n    }\n\n    function flashIcon(icon) {\n        icon.addClass('active');\n        _.delay(function() {\n            icon.removeClass('active');\n        }, 200);\n    }\n\n    function Menubar() {\n\n        this.activities = 0;\n\n        var attrs = {}, events = {};\n        BUTTONS.forEach(function(name) {\n            var sel = name + 'IconSelector';\n\n            attrs[sel] = '.' + name;\n            events[sel] = menubarItemHandler(name);\n        });\n\n        var self = this,\n            extensions = {};\n\n        /**\n         * Add additional icons into the menubar that can open a slide out\n         * panel or display a component in the content area like the built in\n         * dashboard.\n         *\n         * For placement hints options, these are the built-in identifiers:\n         * `dashboard`, `search`, `workspaces` (cases), `products`, `admin`,\n         * `activity`, `logout`.\n         *\n         * All `pane` type extensions will automatically save/restore pane\n         * size as a user preference.\n         *\n         * @param {string} title The text to display under the icon\n         * @param {string} identifier The unique identifier for this item.\n         * Should be valid CSS classname.\n         * @param {string} icon Url to the icon to display\n         * @param {object} action The unique identifier for this item\n         * @param {string} action.componentPath The path to a Flight or React\n         * component\n         * @param {string} action.type The type of action when clicked:\n         * * `pane` Slide out pane\n         * * `full` Use the full content (behind panes)\n         * * `url` Open url\n         * @param {string} [welcomeTemplatePath] Path to handlebars template file for use in dashboard welcome card.\n         * @param {string} [options]\n         * @param {string} [options.tooltip] Different text to display on hover\n         * in a tooltip, otherwise displays the `title`\n         * @param {string} [options.placementHint=top] If the item is added to\n         * `top` or `bottom` of menubar\n         * @param {string} [placementHintBefore] identifier of another menubar\n         * item that this item should be placed before\n         * @param {string} [placementHintAfter] identifier of another menubar\n         * item that this item should be placed after\n         */\n        registry.documentExtensionPoint('org.openlumify.menubar',\n            'Add items to menubar',\n            function(e) {\n                return ('title' in e) &&\n                    ('identifier' in e) &&\n                    ('action' in e) &&\n                    ('icon' in e);\n            },\n            'http://docs.openlumify.org/extension-points/front-end/menubar'\n        );\n        registry.extensionsForPoint('org.openlumify.menubar')\n            .forEach(function(data) {\n                var cls = data.identifier,\n                    type = data.action.type;\n\n                if (type in ACTION_TYPES) {\n                    ACTION_TYPES[type].names.push(cls);\n                }\n                TOOLTIPS[cls] = data.options && data.options.tooltip || data.title;\n\n                extensions[cls] = data;\n                attrs[cls + 'IconSelector'] = '.' + cls;\n                events[cls + 'IconSelector'] = menubarItemHandler(cls);\n            });\n\n        this.defaultAttrs(attrs);\n\n        this.after('initialize', function() {\n            var self = this;\n            this.$node.html(template({\n                isAdmin: AdminList.getExtensions().length > 0\n            }));\n            this.extensions = extensions;\n\n            this.insertExtensions();\n\n            BUTTONS.forEach(function(button) {\n                self.$node.find('.' + button).attr('data-identifier', button);\n            });\n\n            Object.keys(TOOLTIPS).forEach(function(selectorClass) {\n                self.$node.find('.' + selectorClass).tooltip({\n                    placement: 'right',\n                    html: true,\n                    title: (TOOLTIPS[selectorClass].html || TOOLTIPS[selectorClass]).replace(/\\s+/g, '&nbsp;'),\n                    delay: { show: 250, hide: 0 }\n                });\n            });\n\n            this.on('click', events);\n\n            Activity.attachTo(this.select('activityIconSelector'));\n\n            this.on('dragenter', {\n                productsIconSelector: function(event) {\n                    if (!this.select('productsIconSelector').hasClass('active')) {\n                        this.trigger('menubarToggleDisplay', { name: 'products' });\n                    }\n                }\n            })\n            $(document).on('dragstart', function(event) {\n                const dataTransfer = event.originalEvent.dataTransfer;\n                if (dataTransfer && !$('.products-pane.visible').length) {\n                    if (_.any(dataTransfer.types, type => type === VISALLO_MIMETYPES.ELEMENTS)) {\n                        const cls = 'hint-drop-normal';\n                        const node = $('.menubar-pane .products a').addClass(cls);\n                        _.delay(() => node.removeClass(cls), 1000)\n                    }\n                }\n            })\n\n            this.on(document, 'menubarToggleDisplay', this.onMenubarToggle);\n            this.on(document, 'graphPaddingUpdated', this.onGraphPaddingUpdated);\n        });\n\n        this.insertExtensions = function() {\n            var self = this,\n                identifiers = _.pluck(this.extensions, 'identifier'),\n                dependenciesForId = {},\n                sorted = _.chain(this.extensions)\n                    .each(function(e) {\n                        var placementHint = e.options && (e.options.placementHintAfter || e.options.placementHintBefore || '');\n                        if (placementHint && _.contains(identifiers, placementHint)) {\n                            if (!dependenciesForId[placementHint]) {\n                                dependenciesForId[placementHint] = [];\n                            }\n                            if (dependenciesForId[e.identifier] && _.contains(dependenciesForId[e.identifier], placementHint)) {\n                                console.warn('Circular dependency between menubar extensions. Deleting placement hint:', placementHint, 'from:', e.identifier);\n                                delete e.options.placementHintAfter;\n                                delete e.options.placementHintBefore;\n                            } else {\n                                dependenciesForId[placementHint].push(e.identifier);\n                            }\n                        }\n                    })\n                    .values()\n                    .value()\n                    .sort(function(e1, e2) {\n                        var deps1 = dependenciesForId[e1.identifier] || [],\n                            deps2 = dependenciesForId[e2.identifier] || [];\n\n                        if (_.contains(deps1, e2.identifier)) return -1;\n                        if (_.contains(deps2, e1.identifier)) return 1;\n\n                        var vals = _.flatten(_.values(dependenciesForId));\n                        if (_.contains(vals, e1.identifier)) return 1;\n                        if (_.contains(vals, e2.identifier)) return -1;\n                        return 0;\n                    });\n\n            _.each(sorted, function(item) {\n                var cls = item.identifier,\n                    options = $.extend({\n                        placementHint: 'top',\n                        tooltip: item.title,\n                        anchorCss: {}\n                    }, item.options),\n                    newItem = $('<li>')\n                        .addClass(cls)\n                        .attr('data-identifier', item.identifier)\n                        .append(\n                            $('<a>')\n                            .text(item.title)\n                            .css(\n                                $.extend({\n                                    'background-image': 'url(\"' + item.icon + '\")'\n                                }, options.anchorCss)\n                            )\n                        ),\n                    container = self.$node.find('.menu-' + options.placementHint),\n                    placementHint = options.placementHintAfter || options.placementHintBefore,\n                    $placement = placementHint && container.find('.' + placementHint)\n\n                if ($placement) {\n                    if ($placement.length) {\n                        if (options.placementHintAfter) {\n                            return newItem.insertAfter($placement);\n                        } else if (options.placementHintBefore) {\n                            return newItem.insertBefore($placement);\n                        }\n                    } else {\n                        console.warn('Unable to find menubar item placementHint:', placementHint, 'identifier:', item.identifier);\n                    }\n                }\n\n                newItem.insertBefore(container.find('.divider:last-child'));\n            })\n        };\n\n        this.onGraphPaddingUpdated = function(event, data) {\n            var len = this.$node.find('a').length,\n                approximateHeight = len * 50,\n                approximateNoTextHeight = len * 40,\n                windowHeight = $(window).height();\n            this.$node.toggleClass('hide-icon-text', approximateHeight >= windowHeight);\n            this.$node.toggleClass('hide-more', approximateNoTextHeight >= windowHeight);\n        };\n\n        this.onMenubarToggle = function(e, data) {\n            var self = this,\n                auxName = data && _.findKey(PANE_AUXILIARY, a => a.name === data.name),\n                isAux = Boolean(auxName),\n                name = data && auxName || data.name,\n                icon = this.select(name + 'IconSelector'),\n                active = isAux ? icon.hasClass('active-aux') : icon.hasClass('active');\n\n            if (DISABLE_ACTIVE_SWITCH.indexOf(name) === -1) {\n                var isSwitch = false;\n\n                if (!active) {\n                    MUTALLY_EXCLUSIVE_SWITCHES.forEach(function(exclusive, i) {\n                        if (exclusive.names.indexOf(data.name) !== -1) {\n                            isSwitch = true;\n                            exclusive.names.forEach(function(exclusiveName) {\n                                if (exclusiveName !== data.name) {\n                                    var otherIcon = self.select(exclusiveName + 'IconSelector');\n                                    var otherIsActive = false;\n                                    if (otherIcon.length) {\n                                        otherIsActive = otherIcon.hasClass('active');\n                                    } else {\n                                        var auxName = _.findKey(PANE_AUXILIARY, a => a.name === exclusiveName);\n                                        if (auxName) {\n                                            otherIcon = self.select(auxName + 'IconSelector');\n                                            otherIsActive = otherIcon.hasClass('active-aux');\n                                        }\n                                    }\n                                    if (otherIsActive) {\n                                        self.trigger(document, 'menubarToggleDisplay', {\n                                            name: exclusiveName,\n                                            isSwitchButCollapse: true\n                                        });\n                                    }\n                                } else {\n                                    if (isAux) {\n                                        icon.addClass('active-aux');\n                                    } else {\n                                        icon.addClass('active');\n                                    }\n                                }\n                            });\n                        }\n                    });\n                }\n\n                if (!isSwitch || data.isSwitchButCollapse) {\n                    icon.toggleClass(isAux ? 'active-aux' : 'active');\n                }\n\n                if (data && !isAux) {\n                    var aux = PANE_AUXILIARY[data.name];\n                    if (aux) {\n                        active = icon.hasClass('active');\n                        if (active && !icon.hasClass('active-aux')) {\n                            this.trigger(document, 'menubarToggleDisplay', { name: aux.name, action: aux.action });\n                        }\n                    }\n                }\n\n            } else {\n\n                // Just highlight briefly to show click worked\n                icon.addClass('active');\n                setTimeout(function() {\n                    icon.removeClass('active');\n                }, 200);\n            }\n        };\n    }\n});\n"]}