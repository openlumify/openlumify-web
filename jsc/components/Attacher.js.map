{"version":3,"sources":["../../js/components/Attacher.jsx"],"names":["define","React","createReactClass","PropTypes","attacher","Attacher","propTypes","componentPath","string","component","func","behavior","object","legacyMapping","nodeType","nodeStyle","nodeClassName","getDefaultProps","getInitialState","element","componentDidMount","reattach","props","componentWillReceiveProps","nextProps","componentWillUnmount","teardown","render","state","createElement","ref","style","className","rest","Error","inst","preferDirectReactChildren","path","params","refs","node","attach","teardownOptions","react","emptyFlight","then","_reactElement","setState","afterAttach","_","isFunction"],"mappings":"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","file":"Attacher.js","sourcesContent":["define([\n    'react',\n    'create-react-class',\n    'prop-types',\n    'util/component/attacher'\n], function(React, createReactClass, PropTypes, attacher) {\n    'use strict';\n\n    const Attacher = createReactClass({\n\n        propTypes: {\n            componentPath: PropTypes.string,\n            component: PropTypes.func,\n            behavior: PropTypes.object,\n            legacyMapping: PropTypes.object,\n            nodeType: PropTypes.string,\n            nodeStyle: PropTypes.object,\n            nodeClassName: PropTypes.string\n        },\n\n        getDefaultProps() {\n            return { nodeType: 'div', nodeStyle: {}, nodeClassName: '' };\n        },\n\n        getInitialState() {\n            return { element: null }\n        },\n\n        componentDidMount() {\n            this.reattach(this.props);\n        },\n\n        componentWillReceiveProps(nextProps) {\n            if (nextProps !== this.props) {\n                this.reattach(nextProps);\n            }\n        },\n\n        componentWillUnmount() {\n            if (this.attacher) {\n                this.attacher.teardown();\n                this.attacher = null;\n            }\n        },\n\n        render() {\n            const { nodeType, nodeStyle, nodeClassName } = this.props;\n            const { element } = this.state;\n\n            return element ? element : React.createElement(nodeType, {\n                ref: 'node',\n                style: nodeStyle,\n                className: nodeClassName\n            });\n        },\n\n        reattach(props) {\n            const { component, componentPath, legacyMapping, behavior, nodeType, nodeStyle, nodeClassName, ...rest } = props;\n\n            if (!component && !componentPath) {\n                throw new Error('Attacher requires either component or componentPath')\n            }\n\n            const inst = (this.attacher || (this.attacher = attacher({ preferDirectReactChildren: true })))\n                .path(componentPath)\n                .component(component)\n                .params(rest);\n\n            if (this.refs.node) {\n                inst.node(this.refs.node)\n            }\n\n            if (behavior) {\n                inst.behavior(behavior)\n            }\n\n            if (legacyMapping) {\n                inst.legacyMapping(legacyMapping)\n            }\n\n            inst.attach({\n                teardown: true,\n                teardownOptions: { react: false },\n                emptyFlight: true\n            }).then(attach => {\n                if (this.attacher) {\n                    if (attach._reactElement) {\n                        this.setState({ element: attach._reactElement })\n                    }\n                    this.afterAttach();\n                }\n            })\n        },\n\n        afterAttach() {\n            const afterAttach = this.props.afterAttach;\n\n            if (_.isFunction(afterAttach)) {\n                afterAttach(this.attacher);\n            }\n        }\n    });\n\n    return Attacher;\n});\n"]}