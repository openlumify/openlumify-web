var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};define(['create-react-class','prop-types','react-redux','util/vertex/formatters','data/web-worker/store/element/selectors','data/web-worker/store/element/actions','data/web-worker/store/selection/actions'],function(createReactClass,PropTypes,redux,F,elementSelectors,elementActions,selectionActions){var JustificationViewer=createReactClass({displayName:'JustificationViewer',propTypes:{value:PropTypes.shape({justificationText:PropTypes.string,sourceInfo:PropTypes.object})},componentDidMount:function componentDidMount(){this._checkForTitle(this.props);},componentWillReceiveProps:function componentWillReceiveProps(nextProps){this._checkForTitle(nextProps);},render:function render(){var value=this.props.value;var justificationText=value.justificationText,sourceInfo=value.sourceInfo;if(justificationText){return this.renderJustificationText(justificationText);}if(sourceInfo){return this.renderSourceInfo(sourceInfo);}return null;},renderJustificationText:function renderJustificationText(justificationText){return React.createElement('div',{className:'viewing'},React.createElement('div',{className:'text'},React.createElement('div',{className:'text-inner'},justificationText)));},renderSourceInfo:function renderSourceInfo(sourceInfo){var _props=this.props,sourceInfoVertex=_props.sourceInfoVertex,linkToSource=_props.linkToSource;var snippet=sourceInfo.snippet;var title=sourceInfoVertex?F.vertex.title(sourceInfoVertex):sourceInfoVertex===null?i18n('element.entity.not_found'):i18n('openlumify.loading');return React.createElement('div',{className:'viewing'},snippet&&React.createElement('div',{className:'text'},React.createElement('div',{className:'text-inner',dangerouslySetInnerHTML:{__html:snippet}})),React.createElement('div',{className:'source',title:title},React.createElement('strong',null,i18n('justification.field.reference.label'),': '),linkToSource!==false?React.createElement('button',{className:'ref-title btn btn-link',onClick:this.onClick},title):React.createElement('span',{className:'ref-title'},title)));},onClick:function onClick(event){event.preventDefault();event.stopPropagation();var _props2=this.props,openSourceInfo=_props2.openSourceInfo,value=_props2.value;openSourceInfo(value.sourceInfo);},_checkForTitle:function _checkForTitle(props){var value=props.value,sourceInfoVertex=props.sourceInfoVertex,loadVertex=props.loadVertex;if(!value)return;var sourceInfo=value.sourceInfo;if(!sourceInfo)return;if(sourceInfoVertex)return;var vertexId=sourceInfo.vertexId;if(!this._toRequest)this._toRequest={};if(vertexId in this._toRequest)return;this._toRequest[vertexId]=true;loadVertex(vertexId);}});return redux.connect(function(state,props){var sourceInfoVertex=void 0;if(props.value){var sourceInfo=props.value.sourceInfo;if(sourceInfo){var vertices=elementSelectors.getVertices(state);sourceInfoVertex=vertices[sourceInfo.vertexId];}}return _extends({sourceInfoVertex:sourceInfoVertex},props);},function(dispatch,props){return{openSourceInfo:function openSourceInfo(sourceInfo){var vertexId=sourceInfo.vertexId;var textPropertyKey=sourceInfo.textPropertyKey;var textPropertyName=sourceInfo.textPropertyName;var offsets=[sourceInfo.startOffset,sourceInfo.endOffset];dispatch(selectionActions.set({vertices:[vertexId],options:{focus:{vertexId:vertexId,textPropertyKey:textPropertyKey,textPropertyName:textPropertyName,offsets:offsets}}}));},loadVertex:function loadVertex(id){dispatch(elementActions.get({vertexIds:[id]}));}};})(JustificationViewer);});
//# sourceMappingURL=JustificationViewer.js.map
