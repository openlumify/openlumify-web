var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i];}return target;}define(['create-react-class','prop-types','util/dnd'],function(createReactClass,PropTypes,dnd){var Events='dragover dragenter dragleave drop'.split(' ');var DroppableHOC=function DroppableHOC(WrappedComponent,cls){return createReactClass({displayName:'DroppableHOC('+(WrappedComponent.displayName||'Component')+')',propTypes:{mimeTypes:PropTypes.arrayOf(PropTypes.string).isRequired,onDrop:PropTypes.func.isRequired,style:PropTypes.object},getInitialState:function getInitialState(){return{cls:''};},componentDidMount:function componentDidMount(){var _this=this;Events.forEach(function(event){if(event in _this){_this.refs.div.addEventListener(event,_this[event],false);}else console.error('No handler for event: '+event);});},componentWillUnmount:function componentWillUnmount(){var _this2=this;Events.forEach(function(event){if(event in _this2){_this2.refs.div.removeEventListener(event,_this2[event]);}else console.error('No handler for event: '+event);});},dataTransferHasValidMimeType:function dataTransferHasValidMimeType(dataTransfer){return dnd.dataTransferHasValidMimeType(dataTransfer,this.props.mimeTypes);},dragover:function dragover(event){var dataTransfer=event.dataTransfer;if(this.dataTransferHasValidMimeType(dataTransfer)){event.preventDefault();event.stopPropagation();}},dragleave:function dragleave(event){var _this3=this;_.delay(function(){var index=_this3.dragstack.indexOf(event.target);if(index>=0){_this3.dragstack.splice(index,1);}if(!_this3.dragstack.length){_this3.toggleClass(false);}},1);},dragenter:function dragenter(event){if(!this.dragstack)this.dragstack=[];if(!this.dragstack.length){if(this.dataTransferHasValidMimeType(event.dataTransfer)){this.toggleClass(true);}}this.dragstack.push(event.target);},drop:function drop(event){if(!this.dataTransferHasValidMimeType(event.dataTransfer)){return;}event.preventDefault();event.stopPropagation();this.toggleClass(false);var pageX=event.pageX,pageY=event.pageY;var box=(cls?$(event.target).closest(cls)[0]:event.target).getBoundingClientRect();var positionTransform,comp=this.refs.wrapped;while(!positionTransform){if(!comp)break;if(comp&&comp.droppableTransformPosition){positionTransform=comp.droppableTransformPosition;break;}comp=comp.refs.wrapped;}var position=(positionTransform||_.identity)({x:pageX-box.left,y:pageY-box.top});this.props.onDrop(event,position);},toggleClass:function toggleClass(toggle){var cls=toggle?'accepts-draggable':'';if(this.state.cls!==cls){this.setState({cls:cls});}},render:function render(){var cls=this.state.cls;var _props=this.props,onDrop=_props.onDrop,mimeTypes=_props.mimeTypes,_props$style=_props.style,style=_props$style===undefined?{position:'relative'}:_props$style,props=_objectWithoutProperties(_props,['onDrop','mimeTypes','style']);return React.createElement('div',{ref:'div',style:style,className:cls},React.createElement(WrappedComponent,_extends({ref:'wrapped'},props)));}});};return DroppableHOC;});
//# sourceMappingURL=DroppableHOC.js.map
