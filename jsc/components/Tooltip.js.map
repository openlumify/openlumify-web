{"version":3,"sources":["../../js/components/Tooltip.jsx"],"names":["define","React","ReactDOM","createReactClass","PropTypes","Popper","container","TriggerTypes","Focus","Manual","eventsForTrigger","Tooltip","propTypes","node","instanceOf","HTMLElement","message","string","isRequired","trigger","active","bool","className","subtitle","footer","placement","offset","allowOverflow","array","getDefaultProps","getInitialState","style","visibility","componentWillMount","el","document","createElement","$","on","onGraphPaddingUpdated","componentDidMount","getContainer","appendChild","props","toggle","componentWillReceiveProps","nextProps","prevNode","prevTrigger","forEach","removeEventListener","event","onHandleEvent","addEventListener","componentDidUpdate","Boolean","componentWillUnmount","popper","destroy","removeChild","off","render","initialPlacement","state","cls","trim","createPortal","tooltip","r","show","type","undefined","priority","modifiers","preventOverflow","length","without","applyStyle","enabled","applyReactStyle","order","fn","styles","setState","scheduleUpdate","id","getElementById","body"],"mappings":"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","file":"Tooltip.js","sourcesContent":["define([\n    'react',\n    'react-dom',\n    'create-react-class',\n    'prop-types',\n    'popper'\n], function(\n    React,\n    ReactDOM,\n    createReactClass,\n    PropTypes,\n    Popper) {\n\n    var container;\n\n    const TriggerTypes = { Focus: 'focus', Manual: 'manual' };\n    const eventsForTrigger = {\n        [TriggerTypes.Focus]: ['focus', 'blur'],\n        [TriggerTypes.Manual]: []\n    };\n\n    const Tooltip = createReactClass({\n\n        propTypes: {\n            node: PropTypes.instanceOf(HTMLElement),\n            message: PropTypes.string.isRequired,\n            trigger: PropTypes.string.isRequired,\n            active: PropTypes.bool,\n            className: PropTypes.string,\n            subtitle: PropTypes.string,\n            footer: PropTypes.string,\n            placement: PropTypes.string,\n            offset: PropTypes.string,\n            allowOverflow: PropTypes.array\n        },\n\n        getDefaultProps() {\n            return { trigger: TriggerTypes.Manual, placement: 'auto' }\n        },\n\n        getInitialState() {\n            return { style: { visibility: 'hidden' } }\n        },\n\n        componentWillMount() {\n            this.el = document.createElement('div');\n            $(document).on('graphPaddingUpdated', this.onGraphPaddingUpdated);\n        },\n\n        componentDidMount() {\n            getContainer().appendChild(this.el);\n            if (this.props.active) {\n                this.toggle(true)\n            }\n        },\n\n        componentWillReceiveProps(nextProps) {\n            const { node: prevNode, trigger: prevTrigger } = this.props;\n            const { node, trigger } = nextProps;\n\n            if (node !== prevNode || prevTrigger !== trigger) {\n                if (prevTrigger && prevNode) {\n                    eventsForTrigger[prevTrigger].forEach(event => {\n                        prevNode.removeEventListener(event, this.onHandleEvent, false);\n                    })\n                }\n                if (trigger && node) {\n                    eventsForTrigger[trigger].forEach(event => {\n                        node.addEventListener(event, this.onHandleEvent, false);\n                    })\n                }\n            }\n        },\n\n        componentDidUpdate() {\n            const { trigger, active } = this.props;\n            if (trigger === TriggerTypes.Manual) {\n                this.toggle(Boolean(this.props.active));\n            }\n        },\n\n        componentWillUnmount() {\n            const { node, trigger } = this.props;\n\n            if (node && trigger) {\n                eventsForTrigger[trigger].forEach(event => {\n                    node.removeEventListener(event, this.onHandleEvent, false);\n                })\n            }\n            if (this.popper) {\n                this.popper.destroy();\n            }\n            getContainer().removeChild(this.el);\n            $(document).off('graphPaddingUpdated', this.onGraphPaddingUpdated);\n        },\n\n        render() {\n            const { node, message, subtitle, footer, placement: initialPlacement, className = '' } = this.props;\n            const { style, placement } = this.state;\n            const cls = `tooltip fade ${placement || initialPlacement || ''} in ${className}`.trim();\n\n            // Mirror the bootstrap tooltip dom structure\n            return ReactDOM.createPortal(\n                (\n                    <div ref={r => {this.tooltip = r}} className={cls} style={style}>\n                        <div className=\"tooltip-arrow\"></div>\n                        <div className=\"tooltip-inner\">\n                            <div className=\"message\">{message}</div>\n                            { subtitle ? (<div className=\"subtitle\">{subtitle}</div>) : null }\n                            { footer ? (<div className=\"footer\">{footer}</div>) : null }\n                        </div>\n                    </div>\n                ),\n                this.el\n            );\n        },\n\n        onHandleEvent(event) {\n            const { node, trigger } = this.props;\n\n            if (node && trigger === TriggerTypes.Focus) {\n                const show = event.type === 'focus';\n                this.toggle(show);\n            }\n        },\n\n        toggle(show) {\n            const { node, placement, allowOverflow = [], offset = 0 } = this.props;\n            const { style } = this.state;\n            const visibility = show ? undefined : 'hidden';\n            const priority = ['left', 'right', 'top', 'bottom'];\n\n            if (style.visibility !== visibility) {\n\n                if (this.popper) {\n                    this.popper.destroy();\n                    this.popper = null;\n                }\n\n                if (show) {\n                    this.popper = new Popper(node, this.tooltip, {\n                        placement: placement,\n                        modifiers: {\n                            offset: { offset },\n                            preventOverflow: {\n                                priority: allowOverflow.length ?\n                                    _.without(priority, ...allowOverflow) :\n                                    priority\n                            },\n                            applyStyle: { enabled: false },\n                            applyReactStyle: {\n                                enabled: true,\n                                order: 900,\n                                fn: ({ styles, placement }) => {\n                                    this.setState({ placement, style: styles })\n                                }\n                            }\n                        }\n                    })\n                } else {\n                    this.setState({ style: { visibility } })\n                }\n            }\n        },\n\n        onGraphPaddingUpdated() {\n            if (this.popper) {\n                this.popper.scheduleUpdate();\n            }\n        }\n\n    })\n\n    return Tooltip;\n\n    function getContainer() {\n        const id = 'jsx-tooltip-container';\n        if (!container) {\n            container = document.getElementById(id);\n            if (!container) {\n                container = document.createElement('div');\n                container.id = id;\n                document.body.appendChild(container)\n            }\n        }\n        return container;\n    }\n})\n"]}