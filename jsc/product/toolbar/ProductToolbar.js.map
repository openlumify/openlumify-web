{"version":3,"sources":["../../../js/product/toolbar/ProductToolbar.jsx"],"names":["define","createReactClass","PropTypes","registry","RegistryInjectorHOC","DeepObjectCache","ProductToolbarItem","ProductToolbarMenu","documentExtensionPoint","e","_","isFunction","canHandle","some","key","placementHint","MENU","BUTTON","POPOVER","MENU_IDENTIFIER","HOVER_OPEN_DELAY","ProductToolbar","propTypes","product","shape","kind","string","isRequired","object","injectedProductProps","showNavigationControls","bool","onFit","func","onZoom","rightOffset","number","getDefaultProps","getInitialState","activeItem","stayOpen","componentDidMount","$","document","on","event","which","setState","triggerInitialize","componentDidUpdate","prevState","prevProps","state","openItemTimeout","clearTimeout","componentWillUnmount","triggerTeardown","off","render","props","menuItems","listItems","groupByPlacement","item","icon","label","push","items","sortBy","getDefaultItems","mapDeprecatedItems","eligibleForInitialize","forEach","_item","initialize","transform","length","map","identifier","onItemClick","onItemMouseEnter","onItemMouseLeave","setActiveItem","setTimeout","handler","partial","buttonClass","i18n","productKind","extensionPoint","optionComponentPath","config","mappedItem","itemComponentPath","initializedById","isEmpty","previous","id","teardown"],"mappings":"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","file":"ProductToolbar.js","sourcesContent":["define([\n    'create-react-class',\n    'prop-types',\n    'configuration/plugins/registry',\n    'components/RegistryInjectorHOC',\n    'util/deepObjectCache',\n    './ProductToolbarItem',\n    './ProductToolbarMenu'\n], function(\n    createReactClass,\n    PropTypes,\n    registry,\n    RegistryInjectorHOC,\n    DeepObjectCache,\n    ProductToolbarItem,\n    ProductToolbarMenu) {\n    'use strict';\n\n    /**\n     * Plugin to add custom item components (Flight or React) which display in toolbar at the top right of a product.\n     *\n     * @param {string} identifier Unique id for this item\n     * @param {string} itemComponentPath Path to {@link org.openlumify.product.toolbar.item~Component} to render\n     * @param {func} canHandle Given `product` should this item be placed\n     * @param {func} [initialize] Allows configuration of the product environment with same parameters passed to\n     *   {@link org.openlumify.product.toolbar.item~Component}.\n     * @param {func} [teardown] Allows cleanup of anything created in `initialize`\n     * @param {string} [placementHint=menu] How this item should be displayed in the toolbar\n     * * `menu` inside the hamburger menu list\n     * * `popover` as a button that will expand a popover where the component is rendered.\n     *   If specified one of `icon` or `label` is required. Also passed {@link org.openlumify.product.toolbar.popover~onResize}\n     * * `button` as an inline button component\n     * @param {string} [buttonClass] Css class to add to the button element when placed as `button` or `popover`\n     * @param {string} [icon] Path to the icon to render when displayed as a `popover`\n     * @param {string} [label] Label text to render when displayed as a `popover`\n     */\n    registry.documentExtensionPoint('org.openlumify.product.toolbar.item',\n        'Add components to the product toolbar',\n        function(e) {\n            return ('identifier' in e) && ('canHandle' in e && _.isFunction(e.canHandle))\n                && (['itemComponentPath', 'icon', 'label'].some(key => key in e));\n        },\n        'http://docs.openlumify.org/extension-points/front-end/productOptions'\n    );\n\n    const placementHint = {\n        MENU: 'menu',\n        BUTTON: 'button',\n        POPOVER: 'popover'\n    };\n    const MENU_IDENTIFIER = 'menu';\n    const HOVER_OPEN_DELAY = 600;\n\n    const ProductToolbar = createReactClass({\n\n        propTypes: {\n            product: PropTypes.shape({\n                kind: PropTypes.string.isRequired\n            }).isRequired,\n            registry: PropTypes.object.isRequired,\n            injectedProductProps: PropTypes.object,\n            showNavigationControls: PropTypes.bool,\n            onFit: PropTypes.func,\n            onZoom: PropTypes.func,\n            rightOffset: PropTypes.number\n        },\n\n        getDefaultProps() {\n            return {\n                rightOffset: 0,\n                showNavigationControls: false,\n                injectedProductProps: {}\n            }\n        },\n\n        getInitialState() {\n            return {\n                activeItem: null,\n                stayOpen: false\n            }\n        },\n\n        componentDidMount() {\n            $(document).on('keydown.org-openlumify-product-toolbar', (event) => {\n                if (event.which === 27) { //esc\n                    this.setState({ activeItem: null, stayOpen: false });\n                }\n            });\n            this.triggerInitialize()\n        },\n\n        componentDidUpdate(prevState, prevProps) {\n            if (this.state.stayOpen && this.openItemTimeout) {\n                clearTimeout(this.openItemTimeout);\n                this.openItemTimeout = null;\n            }\n            this.triggerInitialize()\n        },\n\n        componentWillUnmount() {\n            this.triggerTeardown()\n            $(document).off('keydown.org-openlumify-product-toolbar');\n        },\n\n        render() {\n            const { activeItem } = this.state;\n            const { onFit, onZoom, rightOffset, registry, injectedProductProps, product } = this.props;\n            const menuItems = [], listItems = [];\n            const groupByPlacement = (item) => {\n               const { placementHint, icon, label } = item;\n\n               if (placementHint) {\n                   if (placementHint === placementHint.MENU) {\n                       menuItems.push(item);\n                   } else {\n                       listItems.push(item);\n                   }\n               } else if (icon || label) {\n                   listItems.push(item);\n               } else {\n                   menuItems.push(item);\n               }\n            };\n            const items = [\n                ..._.sortBy(registry['org.openlumify.product.toolbar.item'], 'identifier'),\n                ...this.getDefaultItems(),\n                ...this.mapDeprecatedItems()\n            ];\n\n            this.eligibleForInitialize = [];\n            items.forEach(_item => {\n                const item = { ..._item, props: { ..._item.props, ...injectedProductProps}}\n                if (item.canHandle(product)) {\n                    if (_.isFunction(item.initialize)) {\n                        this.eligibleForInitialize.push(item)\n                    }\n                    groupByPlacement(item);\n                }\n            });\n\n            return (\n                <div className=\"product-toolbar\" style={{transform: `translate(-${rightOffset}px, 0)`}}>\n                    <div className=\"toolbar-list\">\n                        {listItems.length ?\n                            <ul className=\"extensions\">\n                                {listItems.map(item => (\n                                    <ProductToolbarItem\n                                        item={item}\n                                        active={activeItem === item.identifier}\n                                        key={item.identifier}\n                                        onClick={this.onItemClick}\n                                        onItemMouseEnter={this.onItemMouseEnter}\n                                        onItemMouseLeave={this.onItemMouseLeave}\n                                        rightOffset={rightOffset}\n                                    />\n                                ))}\n                            </ul>\n                        : null}\n                        {menuItems.length ?\n                            <ProductToolbarMenu\n                                items={menuItems}\n                                active={activeItem === MENU_IDENTIFIER}\n                                identifier={MENU_IDENTIFIER}\n                                onToggle={this.onItemClick}\n                                onItemMouseEnter={this.onItemMouseEnter}\n                                onItemMouseLeave={this.onItemMouseLeave}\n                            />\n                        : null}\n                    </div>\n                </div>\n            );\n        },\n\n        onItemClick(identifier) {\n            const { activeItem, stayOpen } = this.state;\n\n            if (activeItem) {\n                if (activeItem === identifier && !stayOpen) {\n                    this.setState({ stayOpen: true });\n                } else if (activeItem === identifier) {\n                    this.setActiveItem();\n                } else {\n                    this.setActiveItem(identifier, true);\n                }\n            } else if (identifier) {\n                this.setActiveItem(identifier, true);\n            } else {\n                this.setActiveItem();\n            }\n        },\n\n        onItemMouseEnter(identifier) {\n            if (!this.state.stayOpen) {\n                this.openItemTimeout = setTimeout(() => { this.setActiveItem(identifier) }, HOVER_OPEN_DELAY);\n            }\n        },\n\n        onItemMouseLeave(identifier) {\n            if (!this.state.stayOpen) {\n                const { activeItem, stayOpen } = this.state;\n\n                if (this.openItemTimeout) {\n                    clearTimeout(this.openItemTimeout);\n                    this.openItemTimeout = null;\n                }\n\n                if (activeItem && !stayOpen) {\n                    this.setActiveItem();\n                }\n            }\n        },\n\n        setActiveItem(activeItem = null, stayOpen = false) {\n            this.setState({ activeItem, stayOpen });\n        },\n\n        getDefaultItems() {\n            const { showNavigationControls, onZoom, onFit } = this.props;\n\n            return ([\n                {\n                    identifier: 'org-openlumify-product-zoom-out',\n                    placementHint: 'button',\n                    label: '-',\n                    props: { handler: _.partial(onZoom, 'out') },\n                    buttonClass: 'zoom',\n                    canHandle: () => showNavigationControls && !!onZoom\n                },\n                {\n                    identifier: 'org-openlumify-product-zoom-in',\n                    placementHint: 'button',\n                    label: '+',\n                    props: { handler: _.partial(onZoom, 'in') },\n                    buttonClass: 'zoom',\n                    canHandle: () => showNavigationControls && !!onZoom\n                },\n                {\n                    identifier: 'org-openlumify-product-fit',\n                    placementHint: 'button',\n                    label: i18n('product.toolbar.fit'),\n                    props: { handler: onFit},\n                    canHandle: () => showNavigationControls && !!onFit\n                }\n            ]);\n        },\n\n        mapDeprecatedItems() {\n            const { product, registry } = this.props;\n            const items = [];\n\n            ['org.openlumify.map.options', 'org.openlumify.graph.options'].forEach(extensionPoint => {\n                const productKind = extensionPoint === 'org.openlumify.graph.options' ?\n                    'org.openlumify.web.product.graph.GraphWorkProduct' : 'org.openlumify.web.product.map.MapWorkProduct';\n\n                registry[extensionPoint].forEach(item => {\n                    const { optionComponentPath, ...config } = item;\n                    const mappedItem = {\n                        ...config,\n                        canHandle: (product) => product.kind === productKind\n                    };\n\n                    if (optionComponentPath) {\n                        mappedItem.itemComponentPath = optionComponentPath;\n                    }\n\n                    items.push(mappedItem);\n                });\n            });\n\n            return items;\n        },\n\n        // Trigger initialize/teardown on extensions only once per product change\n        triggerInitialize() {\n            if (this.eligibleForInitialize) {\n                if (!this.initializedById) {\n                    this.initializedById = {};\n                }\n                this.eligibleForInitialize.forEach(item => {\n                    const { identifier, initialize, props } = item;\n                    const { product } = props;\n\n                    if (!_.isEmpty(props)) {\n                        const previous = this.initializedById[identifier];\n                        if (!previous || previous.props.product.id !== product.id) {\n                            if (previous && _.isFunction(previous.teardown)) {\n                                previous.teardown(previous.props)\n                            }\n                            this.initializedById[identifier] = item;\n                            initialize(props);\n                        }\n                    }\n                })\n            }\n        },\n\n        triggerTeardown() {\n            if (this.eligibleForInitialize) {\n                this.eligibleForInitialize.forEach(({ teardown, props }) => {\n                    if (_.isFunction(teardown)) {\n                        teardown(props)\n                    }\n                })\n            }\n        }\n    });\n\n    return RegistryInjectorHOC(ProductToolbar, [\n        'org.openlumify.graph.options',\n        'org.openlumify.map.options',\n        'org.openlumify.product.toolbar.item'\n    ]);\n});\n"]}