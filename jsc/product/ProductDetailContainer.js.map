{"version":3,"sources":["../../js/product/ProductDetailContainer.jsx"],"names":["define","createReactClass","redux","registry","ProductDetail","ProductDetailEmpty","ProductDetailNoSelection","productActions","productSelectors","ProductDetailContainer","render","props","product","products","extensions","length","connect","state","getProduct","getStatus","loading","loaded","extensionsForPoint","workspace","currentId","byId","productExtensions","_","where","identifier","kind","Error","padding","panel","hasPreview","Boolean","getPreviewHash","extension","user","current","getProducts","editable","privileges","includes","dispatch","onGetProduct","id","get","onCreateProduct","create","i18n"],"mappings":"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","file":"ProductDetailContainer.js","sourcesContent":["define([\n    'create-react-class',\n    'react-redux',\n    'configuration/plugins/registry',\n    './ProductDetail',\n    './ProductDetailEmpty',\n    './ProductDetailNoSelection',\n    'data/web-worker/store/product/actions',\n    'data/web-worker/store/product/selectors'\n], function(\n    createReactClass,\n    redux,\n    registry,\n    ProductDetail,\n    ProductDetailEmpty,\n    ProductDetailNoSelection,\n    productActions,\n    productSelectors) {\n    'use strict';\n\n    const ProductDetailContainer = createReactClass({\n        render() {\n            const props = this.props;\n            var { product, products, extensions } = props;\n\n            if (product) {\n                return (<ProductDetail {...props} />);\n            } else if (products && products.length) {\n                return (<ProductDetailNoSelection {...props} />);\n            } else if (extensions) {\n                return (<ProductDetailEmpty {...props} />);\n            }\n\n            return null\n        }\n    })\n\n    return redux.connect(\n\n        (state, props) => {\n            const product = productSelectors.getProduct(state);\n            const { loading, loaded } = productSelectors.getStatus(state);\n            const extensions = registry.extensionsForPoint('org.openlumify.workproduct');\n            const workspace = state.workspace.currentId ?\n                state.workspace.byId[state.workspace.currentId] : null;\n\n            if (product) {\n                const productExtensions = _.where(extensions, { identifier: product.kind });\n\n                if (productExtensions.length === 0) {\n                    throw Error('No org.openlumify.workproduct extensions registered for: ' + product.kind)\n                }\n                if (productExtensions.length !== 1) {\n                    throw Error('Multiple org.openlumify.workproduct extensions registered for: ' + product.kind)\n                }\n                return {\n                    padding: state.panel.padding,\n                    product,\n                    hasPreview: Boolean(productSelectors.getPreviewHash(state)),\n                    extension: productExtensions[0],\n                    workspace\n                }\n            } else if (extensions.length && loaded) {\n                const user = state.user.current;\n                return {\n                    padding: state.panel.padding,\n                    products: productSelectors.getProducts(state),\n                    extensions,\n                    editable: workspace && user ?\n                        workspace.editable && user.privileges.includes('EDIT') :\n                        false,\n                    workspace\n                };\n            }\n            return {}\n        },\n\n        (dispatch) => {\n            return {\n                onGetProduct: (id) => dispatch(productActions.get(id)),\n                onCreateProduct: (kind) => dispatch(productActions.create(i18n('product.item.title.default'), kind))\n            }\n        }\n\n    )(ProductDetailContainer);\n});\n"]}