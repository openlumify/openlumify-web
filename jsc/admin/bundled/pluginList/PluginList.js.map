{"version":3,"sources":["../../../../js/admin/bundled/pluginList/PluginList.jsx"],"names":["define","createReactClass","PropTypes","DetailKeys","split","TypeDateKeys","PluginItem","item","api","details","map","key","_","contains","formatters","date","dateTimeString","display","formatKeyForDisplay","value","filter","name","description","PluginSection","getInitialState","expanded","toggleCollapsed","event","setState","state","render","props","pluginItems","items","className","fileName","sectionClassName","length","propTypes","string","isRequired","array","PluginList","loading","plugins","componentWillUnmount","request","cancel","componentDidMount","self","openlumifyApi","v1","dataRequest","then","catch","error","statusText","message","pluginSections","sortBy","Object","keys","toLowerCase","plugin","substring","toUpperCase","replace","cap"],"mappings":"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","file":"PluginList.js","sourcesContent":["define([\n    'create-react-class', 'prop-types'\n], function(createReactClass, PropTypes) {\n    'use strict';\n\n    const DetailKeys = 'fileName className projectVersion builtBy builtOn gitRevision'.split(' ');\n    const TypeDateKeys = 'builtOn'.split(' ');\n\n    const PluginItem = function({item, api}) {\n        var details = DetailKeys.map(function(key) {\n                    if (_.contains(TypeDateKeys, key) && (key in item)) {\n                        item[key] = api.formatters.date.dateTimeString(item[key]);\n                    }\n                    return { display: formatKeyForDisplay(key), value: item[key] }\n                })\n                .filter(function(item) {\n                    return !!item.value;\n                })\n\n        return (\n            <li>\n                <h1 className=\"name\">{item.name}</h1>\n                <h2 className=\"description\">{item.description}</h2>\n                <dl>\n                {details.map(function({display, value}) {\n                    return [\n                        <dt key=\"dt\">{display}</dt>,\n                        <dd key=\"dd\" title={value}>{value}</dd>\n                    ];\n                })}\n                </dl>\n            </li>\n        )\n    };\n\n    const PluginSection = createReactClass({\n        getInitialState: function() {\n            return { expanded: false }\n        },\n        toggleCollapsed: function(event) {\n            this.setState({ expanded: !this.state.expanded })\n        },\n        render: function() {\n            var api = this.props.api,\n                pluginItems = this.props.items.map(function(item) {\n                    var key = item.className || item.fileName || item.name;\n                    return <PluginItem api={api} key={key} item={item} />\n                }),\n                sectionClassName = 'collapsible has-badge-number',\n                name = formatKeyForDisplay(this.props.name);\n            if (this.props.items.length === 0) {\n                sectionClassName += ' disabled'\n            }\n            if (this.state.expanded) {\n                sectionClassName += ' expanded';\n            }\n\n            return (\n                <section onClick={this.toggleCollapsed} className={sectionClassName}>\n                    <h1 className=\"collapsible-header\">\n                        <span className=\"badge\">{this.props.items.length}</span>\n                        <strong title={name}>{name}</strong>\n                    </h1>\n                    <div>\n                        <ol className=\"inner-list\">\n                            {pluginItems}\n                        </ol>\n                    </div>\n                </section>\n            )\n        },\n        propTypes: {\n            name: PropTypes.string.isRequired,\n            items: PropTypes.array.isRequired\n        }\n    });\n\n    const PluginList = createReactClass({\n        getInitialState: function() {\n            return {\n                loading: true,\n                plugins: []\n            }\n        },\n        componentWillUnmount: function() {\n            this.request.cancel();\n        },\n        componentDidMount: function() {\n            var self = this;\n            this.request = this.props.openlumifyApi.v1.dataRequest('admin', 'plugins')\n                .then(function(plugins) {\n                    self.setState({ loading: false, plugins: plugins })\n                })\n                .catch(function(error) {\n                    self.setState({ loading: false, error: error.statusText || error.message })\n                })\n        },\n        render: function() {\n            var state = this.state,\n                api = this.props.openlumifyApi.v1;\n\n            if (state.loading) {\n                return (\n                    <ul className=\"nav nav-list\">\n                      <li className=\"nav-header\">Plugins<span className=\"badge loading\"></span></li>\n                    </ul>\n                )\n            } else if (state.error) {\n                return (\n                    <ul className=\"nav nav-list\">\n                      <li className=\"nav-header\">{state.error}</li>\n                    </ul>\n                )\n            }\n            var pluginSections = _.sortBy(Object.keys(state.plugins), function(name) {\n                    return name.toLowerCase();\n                }).map(function(plugin) {\n                    return <PluginSection api={api} key={plugin} name={plugin} items={state.plugins[plugin]} />;\n                });\n            return (\n                <div className=\"admin-plugin-list\">\n                  {pluginSections}\n                </div>\n            );\n        }\n    });\n\n    return PluginList;\n\n    function formatKeyForDisplay(key) {\n        if (key.length > 1) {\n            return key.substring(0, 1).toUpperCase() + key.substring(1).replace(/[A-Z]/g, function(cap) {\n                return ' ' + cap;\n            });\n        }\n        return key;\n    }\n});\n\n"]}