{"version":3,"sources":["../../../../js/admin/bundled/uiExtensionList/index.js"],"names":["define","defineComponent","withFormHelpers","F","withDataRequest","withCollapsibleSections","registry","beautify","UIExtensionList","after","self","renderPlugins","plugins","$list","$node","empty","text","Promise","all","require","dataRequest","done","results","d3","shift","webWorkerRegistry","_","mapObject","e","webWorker","select","get","selectAll","data","chain","extend","extensionPointDocumentation","pairs","tap","list","length","sortBy","pair","toLowerCase","value","call","enter","append","attr","d","style","html","description","externalDocumentationUrl","js_beautify","validator","indent_size","wrap_line_length","number","pretty","registered","string","plural","map","replaceFunctions","object","isString","test","substring","toString","isArray","isObject","JSON","stringify","replace","exit","remove"],"mappings":"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","file":"index.js","sourcesContent":["define([\n    'flight/lib/component',\n    'configuration/admin/utils/withFormHelpers',\n    'util/formatters',\n    'util/withDataRequest',\n    'util/withCollapsibleSections',\n    'configuration/plugins/registry',\n    'beautify'\n], function(\n    defineComponent,\n    withFormHelpers,\n    F,\n    withDataRequest,\n    withCollapsibleSections,\n    registry,\n    beautify) {\n    'use strict';\n\n    return defineComponent(UIExtensionList, withDataRequest, withFormHelpers, withCollapsibleSections);\n\n    function UIExtensionList() {\n\n        this.after('initialize', function() {\n            var self = this;\n\n            this.renderPlugins();\n        });\n\n        this.renderPlugins = function(plugins) {\n            var self = this,\n                $list = this.$node.empty().text('Loading...');\n\n            Promise.all([\n                Promise.require('d3'),\n                this.dataRequest('extensionRegistry', 'get')\n            ]).done(function(results) {\n                var d3 = results.shift(),\n                    webWorkerRegistry = _.mapObject(results.shift(), function(e) {\n                        e.webWorker = true;\n                        return e;\n                    })\n\n                d3.select($list.empty().get(0))\n                    .selectAll('section.collapsible')\n                    .data(\n                        _.chain({})\n                        .extend(registry.extensionPointDocumentation())\n                        .extend(webWorkerRegistry)\n                        .pairs()\n                        .tap(function(list) {\n                            if (list.length === 0) {\n                                self.$node.text('No extensions found')\n                            }\n                        })\n                        .sortBy(function(pair) {\n                            return pair[0].toLowerCase();\n                        })\n                        .sortBy(function(pair) {\n                            return pair[1].webWorker ? 1 : 0\n                        })\n                        .value()\n                    )\n                    .call(function() {\n                        this.enter()\n                            .append('section').attr('class', 'collapsible has-badge-number')\n                            .call(function() {\n                                this.append('h1').attr('class', 'collapsible-header')\n                                    .call(function() {\n                                        this.append('span').attr('class', 'badge');\n                                        this.append('strong');\n                                    })\n                                this.append('div').attr('class', 'ui-extension-body')\n                                    .call(function() {\n                                        this.append('p')\n                                        this.append('a')\n                                            .attr('target', 'ext-docs')\n                                            .attr('class', 'external-link')\n                                            .text(function(d) { return 'External Documentation'; })\n\n                                        this.append('div').attr('class', 'collapsible val')\n                                            .call(function() {\n                                                this.append('a')\n                                                    .attr('class', 'collapsible-header')\n                                                    .text(function(d) { return 'Validation Function'; })\n                                                    .attr('title', 'Registered extensions must pass validation')\n                                                this.append('div')\n                                                    .append('pre').style('font-size', '75%')\n                                            })\n                                        this.append('div').attr('class', 'collapsible reg')\n                                            .call(function() {\n                                                this.append('a')\n                                                    .attr('class', 'collapsible-header')\n                                                this.append('div')\n                                                    .append('ol').attr('class', 'inner-list ui-extension-list');\n                                            })\n                                    })\n                            });\n\n                        this.select('h1 strong').text(function(d) {\n                            return d[0] + (d[1].webWorker ? ' (webworker)' : '');\n                        });\n                        this.select('p').html(function(d) {\n                            return d[1].description;\n                        })\n                        this.select('a.external-link')\n                            .attr('title', function(d) {\n                                return 'Open external documentation for ' + d[0];\n                            })\n                            .style('display', function(d) {\n                                if (!d[1].externalDocumentationUrl) {\n                                    return 'none'\n                                }\n                            })\n                            .attr('href', function(d) {\n                                return d[1].externalDocumentationUrl;\n                            })\n                        this.select('pre').text(function(d) {\n                            return beautify.js_beautify(d[1].validator, {\n                                /*eslint camelcase:0 */\n                                indent_size: 2,\n                                wrap_line_length: 80\n                            })\n                        })\n                        this.select('.badge').text(function(d) {\n                            return F.number.pretty(d[1].registered.length);\n                        });\n                        this.select('.reg').style('display', function(d) {\n                                if (d[1].registered.length === 0) return 'none';\n                            })\n                            .select('.collapsible-header')\n                            .text(function(d) {\n                                return F.string.plural(d[1].registered.length, 'Plugin') + ' Registered';\n                            })\n                        this.select('ol.inner-list')\n                            .selectAll('li')\n                            .data(function(d) {\n                                return d[1].registered.map(replaceFunctions);\n                                function replaceFunctions(object) {\n                                    if (_.isString(object) && (/^FUNCTION/).test(object)) {\n                                        return beautify.js_beautify(object.substring('FUNCTION'.length).toString(), { indent_size: 2});\n                                    } else if (_.isArray(object)) {\n                                        return _.map(object, replaceFunctions);\n                                    } else if (_.isObject(object)) {\n                                        return _.mapObject(object, replaceFunctions);\n                                    }\n                                    return object;\n                                }\n                            })\n                            .call(function() {\n                                this.enter()\n                                    .append('li')\n                                    .append('a').style('white-space', 'pre')\n\n                                this.select('a')\n                                    .text(function(d) {\n                                        return JSON.stringify(d, null, 2).replace(/\\\\n/g, '\\n');\n                                    })\n                            });\n\n                    })\n                    .exit().remove();\n            });\n        };\n\n    }\n});\n"]}