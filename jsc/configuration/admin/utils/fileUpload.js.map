{"version":3,"sources":["../../../../js/configuration/admin/utils/fileUpload.js"],"names":["define","defineComponent","require","i18n","FileUpload","defaultAttrs","buttonText","uploadSelector","uploadInputSelector","removeSelector","selectedFileSelector","after","self","on","onFileChange","onRemove","tpl","$node","html","attr","event","select","val","updateFile","files","target","length","file","trigger","hide","show","empty"],"mappings":"AAAAA,OAAO,CACH,sBADG,CAEH,SAFG,CAGH,eAHG,CAAP,CAIG,SACCC,eADD,CAECC,OAFD,CAGCC,IAHD,CAGO,CACN,aAEA,MAAOF,iBAAgBG,UAAhB,CAAP,CAEA,QAASA,WAAT,EAAsB,CAElB,KAAKC,YAAL,CAAkB,CACdC,WAAYH,KAAK,uCAAL,CADE,CAEdI,eAAgB,WAFF,CAGdC,oBAAqB,OAHP,CAIdC,eAAgB,aAJF,CAKdC,qBAAsB,gBALR,CAAlB,EAUA,KAAKC,KAAL,CAAW,YAAX,CAAyB,UAAW,CAChC,GAAIC,MAAO,IAAX,CAEA,KAAKC,EAAL,CAAQ,QAAR,CAAkB,CACdL,oBAAqB,KAAKM,YADZ,CAAlB,EAGA,KAAKD,EAAL,CAAQ,OAAR,CAAiB,CACbJ,eAAgB,KAAKM,QADR,CAAjB,EAGA,KAAKF,EAAL,CAAQ,OAAR,CAAiB,KAAKE,QAAtB,EAEAb,QAAQ,CAAC,0BAAD,CAAR,CAAsC,SAASc,GAAT,CAAc,CAChDJ,KAAKK,KAAL,CAAWC,IAAX,CAAgBF,IAAIJ,KAAKO,IAAT,CAAhB,EACH,CAFD,EAGH,CAdD,EAgBA,KAAKJ,QAAL,CAAgB,SAASK,KAAT,CAAgB,CAC5B,KAAKC,MAAL,CAAY,qBAAZ,EAAmCC,GAAnC,CAAuC,EAAvC,EACA,KAAKC,UAAL,GACH,CAHD,CAKA,KAAKT,YAAL,CAAoB,SAASM,KAAT,CAAgB,CAChC,GAAII,OAAQJ,MAAMK,MAAN,CAAaD,KAAzB,CAEA,KAAKD,UAAL,CAAgBC,OAASA,MAAME,MAAf,EAAyBF,MAAM,CAAN,CAAzC,EACH,CAJD,CAMA,KAAKD,UAAL,CAAkB,SAASI,IAAT,CAAe,CAC7B,GAAIf,MAAO,IAAX,CAEA,KAAKgB,OAAL,CAAa,aAAb,CAA4B,CACxBD,KAAMA,IADkB,CAA5B,EAIA,GAAI,CAACA,IAAL,CAAW,CACP,KAAKN,MAAL,CAAY,gBAAZ,EAA8BQ,IAA9B,GACA,KAAKR,MAAL,CAAY,gBAAZ,EAA8BS,IAA9B,GACA,MAAO,MAAKT,MAAL,CAAY,sBAAZ,EAAoCU,KAApC,EAAP,CACH,CAED7B,QAAQ,CAAC,8BAAD,CAAR,CAA0C,SAASc,GAAT,CAAc,CACpDJ,KAAKS,MAAL,CAAY,gBAAZ,EAA8BQ,IAA9B,GACAjB,KAAKS,MAAL,CAAY,gBAAZ,EAA8BS,IAA9B,GACAlB,KAAKS,MAAL,CAAY,sBAAZ,EAAoCH,IAApC,CAAyCF,IAAI,CAAEW,KAAMA,IAAR,CAAJ,CAAzC,EACH,CAJD,EAKH,CAlBD,CAoBH,CACJ,CAxED","file":"fileUpload.js","sourcesContent":["define([\n    'flight/lib/component',\n    'require',\n    'util/messages'\n], function(\n    defineComponent,\n    require,\n    i18n) {\n    'use strict';\n\n    return defineComponent(FileUpload);\n\n    function FileUpload() {\n\n        this.defaultAttrs({\n            buttonText: i18n('admin.utils.file-upload.button.select'),\n            uploadSelector: '.btn-file',\n            uploadInputSelector: 'input',\n            removeSelector: '.btn-danger',\n            selectedFileSelector: '.selected-file'\n\n            // TODO: add accepted filetypes attribute\n        });\n\n        this.after('initialize', function() {\n            var self = this;\n\n            this.on('change', {\n                uploadInputSelector: this.onFileChange\n            });\n            this.on('click', {\n                removeSelector: this.onRemove\n            });\n            this.on('reset', this.onRemove);\n\n            require(['./fileUploadTemplate.hbs'], function(tpl) {\n                self.$node.html(tpl(self.attr));\n            });\n        });\n\n        this.onRemove = function(event) {\n            this.select('uploadInputSelector').val('');\n            this.updateFile();\n        }\n\n        this.onFileChange = function(event) {\n            var files = event.target.files;\n\n            this.updateFile(files && files.length && files[0]);\n        };\n\n        this.updateFile = function(file) {\n            var self = this;\n\n            this.trigger('fileChanged', {\n                file: file\n            });\n\n            if (!file) {\n                this.select('removeSelector').hide();\n                this.select('uploadSelector').show();\n                return this.select('selectedFileSelector').empty();\n            }\n\n            require(['./fileUploadItemTemplate.hbs'], function(tpl) {\n                self.select('uploadSelector').hide();\n                self.select('removeSelector').show();\n                self.select('selectedFileSelector').html(tpl({ file: file }));\n            });\n        };\n\n    }\n});\n"]}