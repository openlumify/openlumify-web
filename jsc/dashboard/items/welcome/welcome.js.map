{"version":3,"sources":["../../../../js/dashboard/items/welcome/welcome.js"],"names":["define","defineComponent","registry","template","SPOTLIGHT_SHOW_DELAY_MS","Welcome","builtIn","activity","admin","dashboard","logout","products","search","workspaces","icons","menubarExtensions","extensionsForPoint","attributes","highlightSelector","before","$","remove","after","$node","css","addClass","html","on","onSpotlight","document","Promise","resolve","getTemplates","map","v","require","path","then","done","render","bind","event","onSpotlightInterval","clearTimeout","type","_","delay","onSpotlightNoDelay","srcElement","target","selector","dataset","valid","contains","targetElement","length","get","adjustSpotlight","hide","src","dest","srcRect","rectForEl","destRect","d3","select","body","selectAll","data","call","enter","append","attr","style","position","display","left","top","bottom","right","width","height","stroke","fill","pathForSrcDestRect","svg","node","opacity","requestAnimationFrame","s","d","dx","x","dy","y","dd","Math","sqrt","r","padding","rInner","moveAbs","x1","y1","line","h","w","a","asin","b","atan2","t","ta","sin","cos","taInner","tb","arc","counterClockwise","el","rects","getClientRects","max","sections","section","identifier","toggleClass","icon","text","prepend","compact","getMenuIdentifiers","getDisplayAndTemplatePathForIdentifier","toArray","i18n","extension","findWhere","welcomeTemplatePath","options","tooltip","title","console","warn"],"mappings":"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","file":"welcome.js","sourcesContent":["define([\n    'flight/lib/component',\n    'configuration/plugins/registry',\n    './welcomeTpl.hbs'\n], function(\n    defineComponent,\n    registry,\n    template) {\n    'use strict';\n\n    var SPOTLIGHT_SHOW_DELAY_MS = 350;\n\n    return defineComponent(Welcome);\n\n    function Welcome() {\n\n        var builtIn = {\n                activity: 'dashboard/items/welcome/activity.hbs',\n                admin: 'dashboard/items/welcome/admin.hbs',\n                dashboard: 'dashboard/items/welcome/dashboard.hbs',\n                logout: 'dashboard/items/welcome/logout.hbs',\n                products: 'dashboard/items/welcome/products.hbs',\n                search: 'dashboard/items/welcome/search.hbs',\n                workspaces: 'dashboard/items/welcome/workspaces.hbs'\n            },\n            icons = {\n                activity: 'img/glyphicons/white/glyphicons_023_cogwheels@2x.png',\n                admin: 'img/glyphicons/white/glyphicons_439_wrench@2x.png',\n                dashboard: 'img/openlumify-icon@2x.png',\n                logout: 'img/glyphicons/white/glyphicons_387_log_out@2x.png',\n                products: 'img/glyphicons/white/glyphicons_330_blog@2x.png',\n                search: 'img/glyphicons/white/glyphicons_027_search@2x.png',\n                workspaces: 'img/white_glyphicons_341_briefcase@2x_no_gray.png'\n            },\n            menubarExtensions = registry.extensionsForPoint('org.openlumify.menubar');\n\n        this.attributes({\n            highlightSelector: '*[data-selector]'\n        });\n\n        this.before('teardown', function() {\n            $('.welcome-spotlight').remove();\n        })\n\n        this.after('initialize', function() {\n            this.$node\n                .css('overflow', 'auto')\n                .addClass('org-openlumify-welcome')\n                .html(template({}));\n\n            this.on('mouseover', {\n                highlightSelector: this.onSpotlight\n            });\n            this.on('mouseout', {\n                highlightSelector: this.onSpotlight\n            })\n\n            this.on(document, 'click', this.onSpotlight);\n\n            Promise.resolve(getTemplates())\n                .map(function(v) {\n                    return Promise.require(v.path).then(function(template) {\n                        v.template = template;\n                        return v;\n                    })\n                })\n                .done(this.render.bind(this));\n        });\n\n        this.onSpotlight = function(event) {\n            if (this.onSpotlightInterval) {\n                clearTimeout(this.onSpotlightInterval)\n            }\n            if (event.type !== 'mouseout') {\n                this.onSpotlightInterval = _.delay(this.onSpotlightNoDelay.bind(this, event), SPOTLIGHT_SHOW_DELAY_MS);\n                return;\n            }\n            this.onSpotlightNoDelay(event);\n        };\n\n        this.onSpotlightNoDelay = function(event) {\n            var srcElement = event.target,\n                selector = srcElement.dataset && srcElement.dataset.selector,\n                valid = _.contains(['click', 'mouseover'], event.type),\n                targetElement = selector && $(selector);\n\n            if (valid && targetElement && targetElement.length) {\n                targetElement = targetElement.get(0);\n                this.adjustSpotlight(srcElement, targetElement);\n            } else {\n                $('.welcome-spotlight').hide();\n            }\n        };\n\n        this.adjustSpotlight = function(src, dest) {\n            var srcRect = rectForEl(src),\n                destRect = rectForEl(dest);\n\n            if (srcRect && destRect) {\n                require(['d3'], function(d3) {\n                    d3.select(document.body)\n                        .selectAll('svg.welcome-spotlight')\n                        .data([1])\n                        .call(function() {\n                            this.enter()\n                                .append('svg')\n                                    .attr('class', 'welcome-spotlight')\n                                    .style({\n                                        'pointer-events': 'none',\n                                        position: 'absolute',\n                                        display: 'none',\n                                        left: 0,\n                                        top: 0,\n                                        bottom: 0,\n                                        right: 0,\n                                        width: '100%',\n                                        height: '100%',\n                                        'z-index': 1000\n                                    })\n                                .append('path')\n\n                            this.select('path')\n                                .style({\n                                    stroke: 'rgba(251, 232, 37, 0.93)',\n                                    fill: 'rgba(255, 236, 45, 0.48)',\n                                    'stroke-width': 1\n                                })\n                                .attr('d', pathForSrcDestRect(srcRect, destRect))\n\n                            var svg = this.node();\n                            svg.style.opacity = 0;\n                            svg.style.display = '';\n                            requestAnimationFrame(function() {\n                                svg.style.opacity = 1;\n                            })\n                        });\n                });\n            }\n\n            function pathForSrcDestRect(s, d) {\n                var dx = d.x - s.x,\n                    dy = d.y - s.y,\n                    dd = Math.sqrt(dx * dx + dy * dy),\n                    r = d.r + 10,\n                    padding = 5,\n                    rInner = d.r + padding;\n\n                if (dd < r) {\n                    // Special case when too close or target too large,\n                    // just draw rect around\n                    return moveAbs(d.x1, d.y1) +\n                        line(0, d.h) +\n                        line(d.w, 0) +\n                        line(0, -d.h) + 'Z ' +\n                        moveAbs(d.x1 + padding, d.y1 + padding) +\n                        line(d.w - padding * 2, 0) +\n                        line(0, d.h - padding * 2) +\n                        line((d.w - padding * 2) * -1, 0) + ' Z';\n                }\n\n                var a = Math.asin(r / dd),\n                    b = Math.atan2(dy, dx),\n                    t = b - a,\n                    ta = { x: r * Math.sin(t) + dx, y: r * -Math.cos(t) + dy },\n                    taInner = { x: rInner * Math.sin(t) + dx, y: rInner * -Math.cos(t) + dy },\n                    tb;\n\n                t = b + a;\n                tb = { x: r * -Math.sin(t) + dx, y: r * Math.cos(t) + dy };\n\n                //M 657,294 l 148,-268 a 14,14,20 1 1 25,16 L 657,294\n                return moveAbs(s.x, s.y) +\n                    line(ta.x, ta.y) +\n                    arc(tb.x - ta.x, tb.y - ta.y, r) + 'Z ' +\n                    moveAbs(d.x - rInner, d.y) +\n                    //line(rInner * 2, 0)\n                    //moveAbs(taInner.x + s.x, taInner.y + s.y) +\n                    //line(tb.x, tb.y)\n                    arc(rInner * 2, 0, rInner, true) +\n                    arc(rInner * -2, 0, rInner, true);\n                    //M657,294 m155,-248 a 10,10,10 1 0 .1,.1 z\n\n                function moveAbs(x, y) { return 'M ' + x + ',' + y + ' '; }\n                function arc(x, y, r, counterClockwise) {\n                    return 'a' + r + ',' + r + ',' + r +\n                        ' 1 ' + (counterClockwise ? 0 : 1) + ' ' +\n                        x + ',' + y + ' ';\n                }\n                function line(x, y) { return 'l ' + x + ',' + y + ' '; }\n            }\n\n            function rectForEl(el) {\n                var rects = el.getClientRects();\n                if (rects.length) {\n                    var r = rects[0];\n                    return {\n                        x: r.left + r.width / 2,\n                        y: r.top + r.height / 2,\n                        r: Math.max(r.width / 2, r.height / 2),\n                        x1: r.left,\n                        y1: r.top,\n                        w: r.width,\n                        h: r.height\n                    };\n                }\n            }\n        };\n\n        this.render = function(sections) {\n            this.$node.append($.map(sections, function(section) {\n                var selector = '.menubar-pane .' + section.identifier;\n                return $('<section>')\n                    .append($('<h2>')\n                        .toggleClass('has-icon', !!section.icon)\n                        .text(section.display)\n                        .prepend($('<div>')\n                            .attr('data-selector', selector)\n                            .css('background-image', section.icon && ('url(' + section.icon + ')') || null)\n                        )\n                    )\n                    .append($('<p>').html(section.template({})));\n            }));\n        }\n\n        function getTemplates() {\n            return _.compact(getMenuIdentifiers().map(getDisplayAndTemplatePathForIdentifier));\n        }\n\n        function getMenuIdentifiers() {\n            return _.compact(\n                $('.menubar-pane li')\n                .map(function() {\n                    return $(this).data('identifier');\n                })\n                .toArray()\n            );\n        }\n\n        function getDisplayAndTemplatePathForIdentifier(identifier) {\n            if (identifier in builtIn) {\n                return {\n                    identifier: identifier,\n                    display: i18n('menubar.icons.' + identifier),\n                    icon: icons[identifier],\n                    path: builtIn[identifier]\n                };\n            }\n\n            var extension = _.findWhere(menubarExtensions, { identifier: identifier });\n            if (extension) {\n                if (extension.welcomeTemplatePath) {\n                    return {\n                        identifier: identifier,\n                        display: extension.options && extension.options.tooltip || extension.title,\n                        icon: extension.icon,\n                        path: extension.welcomeTemplatePath\n                    };\n                } else console.warn('Consider adding welcomeTemplatePath to menubar extension', extension);\n                return;\n            }\n\n            console.warn('No welcome template for identifier', identifier)\n        }\n    }\n});\n"]}