function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i];}return target;}define(['flight/lib/component','util/withDataRequest','util/element/list','util/popovers/withPopover'],function(defineComponent,withDataRequest,ElementList,withPopover){'use strict';return defineComponent(SearchResultsPopover,withPopover,withDataRequest);function SearchResultsPopover(){this.defaultAttrs({openSearchSelector:'.open-in-search'});this.before('initialize',function(node,config){config.template='/dashboard/reportRenderers/resultsPopoverTpl.hbs';config.hideDialog=true;});this.after('initialize',function(){var self=this;this.after('setupWithTemplate',function(){var $content=this.popover.find('.popover-content'),$list=$content.find('.list'),position=function position(){self.dialog.show();self.positionDialog();},error=function error(message,isError){$('<div>').text(message).addClass('message').appendTo($list.empty());},finishedRender=this.dataRequest('dashboard','postData',this.attr.searchUrl||'/element/search',this.attr.search||{}).then(function(results){if(_.isEmpty(results.elements)){$list.removeClass('loading-small-animate');error(i18n('dashboard.search.results.none'));}else{return new Promise(function(f){self.on(self.popover,'renderFinished',function finished(){self.off('renderFinished',finished);$list.removeClass('loading-small-animate');f();});ElementList.attachTo($list.empty(),{items:results.elements});});}}).catch(function(){$list.removeClass('loading-small-animate');error(i18n('dashboard.search.results.error'));}).then(position);this.on(this.popover,'click',{openSearchSelector:this.onOpenInSearch});Promise.timeout(100).then(position);});});this.onOpenInSearch=function(event){var _attr=this.attr,searchUrl=_attr.searchUrl,search=_attr.search;var parametersUrl=search.url,searchParameters=_objectWithoutProperties(search,['url']);var url=parametersUrl||searchUrl;this.trigger('searchByParameters',{url:url,parameters:searchParameters});this.teardown();};}});
//# sourceMappingURL=resultsPopover.js.map
