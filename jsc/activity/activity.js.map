{"version":3,"sources":["../../js/activity/activity.js"],"names":["define","defineComponent","template","builtinHandlers","d3","registry","Attacher","F","withCollapsibleSections","withDataRequest","AUTO_UPDATE_INTERVAL_SECONDS","ACTIVITY_EXTENSTION_POINT","handlersByKind","handlersByType","Activity","processIsIndeterminate","process","handler","type","kind","indeterminateProgress","processIsFinished","canceled","endTime","processShouldAutoDismiss","autoDismiss","processAllowCancel","allowCancel","attributes","typesSelector","deleteButtonSelector","cancelButtonSelector","noActivitySelector","before","clearInterval","autoUpdateTimer","updateByKindAndTypeExtensions","e","extensionsForPoint","_","indexBy","groupBy","after","documentExtensionPoint","isFunction","titleRenderer","isArray","eventNames","length","forEach","h","registerExtension","removedTasks","$node","html","tasks","openlumifyData","currentUser","longRunningProcesses","tasksById","throttledUpdate","debounce","update","bind","updateEventWatchers","on","document","onToggleDisplay","onLongRunningProcessChanged","onLongRunningProcessDeleted","onShowActivityDisplay","onExtensionsChanged","onVerticesUpdated","onDelete","onCancel","event","visible","closest","trigger","name","callServiceMethodRemove","self","$button","$","target","processId","data","addClass","dataRequest","then","remove","finally","removeClass","task","addOrUpdateTask","removeTask","extensionPoint","namespace","eventWatchers","eventWatcher","off","activityHandler","onActivityHandlerStart","onActivityHandlerEnd","taskId","onRemove","call","console","error","splice","indexOf","existingTask","id","enqueueTime","Date","now","startTime","eventData","openingActivity","isOpen","startAutoUpdate","pauseAutoUpdate","setInterval","notifyActivityMonitors","count","reduce","previousCountForNotify","closeIfEmpty","chain","filter","p","sortBy","value","pairs","pair","toLowerCase","currentTaskCount","uniqueTypes","map","unique","byType","finishedComponentPath","warn","compact","promises","Promise","require","all","deps","updateWithDependencies","apply","concat","delay","requirePaths","finishedComponents","object","Array","prototype","slice","arguments","select","toggle","get","selectAll","order","enter","append","attr","exit","each","teardownAllComponents","text","i18n","number","pretty","property","datum","componentPath","Component","node","component","params","attach","teardown","style","progress","cls","timePrefix","date","relativeToNow","utc","progressMessage"],"mappings":"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","file":"activity.js","sourcesContent":["\ndefine([\n    'flight/lib/component',\n    './template.hbs',\n    './handlers',\n    'd3',\n    'configuration/plugins/registry',\n    'util/component/attacher',\n    'util/formatters',\n    'util/withCollapsibleSections',\n    'util/withDataRequest'\n], function(\n    defineComponent,\n    template,\n    builtinHandlers,\n    d3,\n    registry,\n    Attacher,\n    F,\n    withCollapsibleSections,\n    withDataRequest) {\n    'use strict';\n\n    var AUTO_UPDATE_INTERVAL_SECONDS = 60, // For updating relative times\n        ACTIVITY_EXTENSTION_POINT = 'org.openlumify.activity',\n        handlersByKind = {},\n        handlersByType = {};\n\n    return defineComponent(Activity, withCollapsibleSections, withDataRequest);\n\n    function processIsIndeterminate(process) {\n        var handler = handlersByType[process.type];\n        return handler && (handler.kind === 'eventWatcher' || handler.indeterminateProgress);\n    }\n\n    function processIsFinished(process) {\n        return process.canceled || process.endTime;\n    }\n\n    function processShouldAutoDismiss(process) {\n        var handler = handlersByType[process.type];\n        return handler && handler.autoDismiss === true;\n    }\n\n    function processAllowCancel(process) {\n        var handler = handlersByType[process.type];\n        return !handler || (handler.kind === 'longRunningProcess' || handler.allowCancel === true);\n    }\n\n    function Activity() {\n\n        this.attributes({\n            typesSelector: '.types',\n            deleteButtonSelector: 'button.delete',\n            cancelButtonSelector: 'button.cancel',\n            noActivitySelector: '.no-activity'\n        })\n\n        this.before('teardown', function() {\n            clearInterval(this.autoUpdateTimer);\n        });\n\n        this.updateByKindAndTypeExtensions = function() {\n            var e = registry.extensionsForPoint(ACTIVITY_EXTENSTION_POINT);\n            handlersByType = _.indexBy(e, 'type');\n            handlersByKind = _.groupBy(e, 'kind');\n        };\n\n        this.after('initialize', function() {\n\n            /**\n             * Activity items display in the floating panel accessed from the\n             * menubar gears icon.\n             *\n             * @param {string} type Type identifier for this kind of activity. There can be more than one activity of this type in progress, and the display will group by this value.\n             *\n             * Define `activity.tasks.type.[MY_ACTIVITY_TYPE]` message bundle string for localized display.\n             * @param {string} kind Either `eventWatcher` or `longRunningProcess`\n             * @param {org.openlumify.activity~titleRenderer} titleRenderer Render the title for row\n             * @param {Array.<string>} [eventNames] Required if `eventWatcher`. Start event name, end event name.\n             * @param {string} [finishedComponentPath] Path to {@link org.openlumify.activity~FinishedComponent} to render when task is complete.\n             * @param {org.openlumify.activity~onRemove} [onRemove] Invoked when row is removed\n             * @param {boolean} [indeterminateProgress=false] If determinate progress is not available, will render indeterminate progress bar.\n             * @param {boolean} [autoDismiss=false] Remove this activity row when complete\n             * @param {boolean} [allowCancel=false] Whether the activity supports cancelling (will render cancel button if true).\n             */\n            registry.documentExtensionPoint(\n                'org.openlumify.activity',\n                'Custom activity rows based on events or long running processes',\n                function(e) {\n                    return ('type' in e) && ('kind' in e) && _.isFunction(e.titleRenderer) &&\n                        (e.kind !== 'eventWatcher' || (_.isArray(e.eventNames) && e.eventNames.length === 2));\n                },\n                'http://docs.openlumify.org/extension-points/front-end/activity'\n            );\n\n            builtinHandlers.forEach(function(h) {\n                registry.registerExtension(ACTIVITY_EXTENSTION_POINT, h);\n            });\n\n            this.updateByKindAndTypeExtensions();\n\n            this.removedTasks = {};\n            this.$node.html(template({}));\n\n            this.tasks = openlumifyData.currentUser && openlumifyData.currentUser.longRunningProcesses || [];\n            this.tasksById = _.indexBy(this.tasks, 'id');\n\n            this.throttledUpdate = _.debounce(this.update.bind(this), 100);\n            this.updateEventWatchers();\n\n            this.on(document, 'menubarToggleDisplay', this.onToggleDisplay);\n            this.on(document, 'longRunningProcessChanged', this.onLongRunningProcessChanged);\n            this.on(document, 'longRunningProcessDeleted', this.onLongRunningProcessDeleted);\n            this.on(document, 'showActivityDisplay', this.onShowActivityDisplay);\n            this.on(document, 'extensionsChanged', this.onExtensionsChanged);\n            this.on(document, 'verticesUpdated', this.onVerticesUpdated);\n\n            this.on('click', {\n                deleteButtonSelector: this.onDelete,\n                cancelButtonSelector: this.onCancel\n            })\n        });\n\n        this.onShowActivityDisplay = function(event) {\n            var visible = this.$node.closest('.visible').length > 0;\n\n            if (!visible) {\n                this.trigger('menubarToggleDisplay', { name: 'activity' });\n            }\n        };\n\n        this.onCancel = function(event) {\n            this.callServiceMethodRemove(event, 'cancel');\n        };\n\n        this.onDelete = function(event) {\n            this.callServiceMethodRemove(event, 'delete');\n        };\n\n        this.callServiceMethodRemove = function(event, name) {\n            var self = this,\n                $button = $(event.target),\n                processId = $button.closest('li').data('processId');\n\n            if (processId) {\n                $button.addClass('loading');\n                this.dataRequest('longRunningProcess', name, processId)\n                    .then(function() {\n                        $(event.target).closest('li').remove();\n                    })\n                    .finally(function() {\n                        $button.removeClass('loading');\n                    })\n            }\n        };\n\n        this.onLongRunningProcessChanged = function(event, data) {\n            var task = data.process;\n\n            this.addOrUpdateTask(task);\n            this.update(true);\n        };\n\n        this.onLongRunningProcessDeleted = function(event, data) {\n            var self = this,\n                processId = data.processId;\n\n            this.removeTask(processId);\n            this.update(true);\n        };\n\n        this.onVerticesUpdated = function(event, data) {\n            this.throttledUpdate();\n        };\n\n        this.onExtensionsChanged = function(event, data) {\n            if (data.extensionPoint === ACTIVITY_EXTENSTION_POINT) {\n                this.updateByKindAndTypeExtensions();\n                this.updateEventWatchers();\n                this.update();\n            }\n        };\n\n        this.updateEventWatchers = function() {\n            var self = this,\n                namespace = '.ACTIVITY_HANDLER',\n                eventWatchers = handlersByKind.eventWatcher;\n\n            this.off(document, namespace);\n            eventWatchers.forEach(function(activityHandler) {\n                self.on(\n                    document,\n                    activityHandler.eventNames[0] + namespace,\n                    self.onActivityHandlerStart.bind(self, activityHandler)\n                );\n                self.on(\n                    document,\n                    activityHandler.eventNames[1] + namespace,\n                    self.onActivityHandlerEnd.bind(self, activityHandler)\n                );\n            });\n        };\n\n        this.removeTask = function(taskId) {\n            this.removedTasks[taskId] = true;\n            var task = this.tasksById[taskId];\n            var handler = handlersByType[task.type];\n\n            if (handler && handler.onRemove) {\n                if (_.isFunction(handler.onRemove)) {\n                    /**\n                     * Invoked when the row is removed by user or `autoDismiss`\n                     *\n                     * @callback org.openlumify.activity~onRemove\n                     * @example\n                     * onRemove() {\n                     *     // \"this\" is the flight activity component\n                     *     this.trigger(...);\n                     * }\n                     */\n                    handler.onRemove.call(this);\n                } else {\n                    console.error('handler.onRemove expected a function, instead got: ', handler.onRemove);\n                }\n            }\n\n            delete this.tasksById[taskId];\n            this.tasks.splice(this.tasks.indexOf(task), 1);\n        };\n\n        this.addOrUpdateTask = function(task) {\n            var existingTask = this.tasksById[task.id];\n\n            if (this.removedTasks[task.id]) {\n                return;\n            }\n\n            if (existingTask) {\n                this.tasks.splice(this.tasks.indexOf(existingTask), 1, task);\n            } else {\n                this.tasks.splice(0, 0, task);\n            }\n\n            this.tasksById[task.id] = task;\n        };\n\n        this.onActivityHandlerStart = function(handler, event, data) {\n            this.addOrUpdateTask({\n                id: handler.type,\n                type: handler.type,\n                enqueueTime: Date.now(),\n                startTime: Date.now(),\n                eventData: data\n            });\n            this.update();\n        };\n\n        this.onActivityHandlerEnd = function(handler, event, data) {\n            this.addOrUpdateTask({\n                id: handler.type,\n                type: handler.type,\n                endTime: Date.now(),\n                eventData: data\n            });\n            this.update();\n        };\n\n        this.onToggleDisplay = function(event, data) {\n            var openingActivity = data.name === 'activity' && this.$node.closest('.visible').length;\n\n            this.isOpen = openingActivity;\n\n            if (openingActivity) {\n                this.update();\n                this.startAutoUpdate();\n            } else {\n                this.pauseAutoUpdate();\n            }\n        };\n\n        this.pauseAutoUpdate = function() {\n            clearInterval(this.autoUpdateTimer);\n        };\n\n        this.startAutoUpdate = function() {\n            this.autoUpdateTimer = setInterval(this.update.bind(this), AUTO_UPDATE_INTERVAL_SECONDS * 1000)\n        };\n\n        this.notifyActivityMonitors = function(tasks) {\n            var count = _.reduce(tasks, function(count, task) {\n                if (processIsFinished(task)) {\n                    return count;\n                }\n\n                return count + 1;\n            }, 0);\n\n            if (!this.previousCountForNotify || count !== this.previousCountForNotify) {\n                this.trigger('activityUpdated', { count: count });\n            }\n        }\n\n        this.update = function(closeIfEmpty) {\n            var self = this,\n                tasks = _.chain(this.tasks)\n                    .filter(function(p) {\n                        if (p.canceled) {\n                            return false;\n                        }\n\n                        if (processIsFinished(p) && processShouldAutoDismiss(p)) {\n                            return false;\n                        }\n\n                        return true;\n                    })\n                    .sortBy(function(p) {\n                        return p.enqueueTime * -1;\n                    })\n                    .value(),\n                data = _.chain(tasks)\n                    .groupBy('type')\n                    .pairs()\n                    .sortBy(function(pair) {\n                        return pair[0].toLowerCase();\n                    })\n                    .value();\n\n            this.currentTaskCount = tasks.length;\n            this.notifyActivityMonitors(tasks);\n\n            if (!this.isOpen) {\n                return;\n            }\n\n            var uniqueTypes = _.chain(data)\n                .map(function(p) {\n                    return p[0];\n                })\n                .unique()\n                .map(function(type) {\n                    var byType = handlersByType;\n                    if (type in byType) {\n                        if (byType[type].finishedComponentPath) {\n                            return byType[type].finishedComponentPath;\n                        }\n                        return;\n                    }\n\n                    console.warn('No activity handler registered for type:', type);\n                })\n                .compact()\n                .value();\n\n            var promises = _.map(uniqueTypes, function(type) {\n                return Promise.require(type);\n            });\n\n            return Promise.all(promises)\n                .then(function(deps) {\n                    self.updateWithDependencies.apply(self, [data, uniqueTypes].concat(deps))\n                })\n                .then(function() {\n                    if (closeIfEmpty && self.currentTaskCount === 0) {\n                        _.delay(function() {\n                            var visible = self.$node.closest('.visible').length > 0;\n                            if (visible) {\n                                self.trigger('menubarToggleDisplay', { name: 'activity' });\n                            }\n                        }, 250)\n                    }\n                })\n        };\n\n        this.updateWithDependencies = function(data, requirePaths) {\n            var finishedComponents = _.object(requirePaths, Array.prototype.slice.call(arguments, 2))\n\n            this.select('noActivitySelector').toggle(data.length === 0);\n\n            d3.select(this.select('typesSelector').get(0))\n                .selectAll('section')\n                .data(data)\n                .order()\n                .call(function() {\n                    this.enter()\n                        .append('section')\n                        .call(function() {\n                            this.attr('class', 'collapsible expanded')\n                            this.append('h1')\n                                .attr('class', 'collapsible-header')\n                                .call(function() {\n                                    this.append('strong');\n                                    this.append('span').attr('class', 'badge');\n                                })\n                            this.append('ul').attr('class', 'collapsible-section')\n                        });\n                    this.exit()\n                        .each(function() {\n                            $('.actions-plugin', this).teardownAllComponents();\n                        })\n                        .remove();\n\n                    this.select('.collapsible-header strong').text(function(pair) {\n                        return i18n('activity.tasks.type.' + pair[0]);\n                    })\n\n                    this.select('.collapsible-header .badge').text(function(pair) {\n                        return F.number.pretty(pair[1].length);\n                    })\n\n                    this.select('ul')\n                        .selectAll('li')\n                        .data(function(pair) {\n                            return pair[1];\n                        }, function(process) {\n                            return process.id;\n                        })\n                        .order()\n                        .call(function() {\n                            this.enter()\n                                .append('li')\n                                .call(function() {\n                                    this.append('div')\n                                        .attr('class', 'process')\n                                        .call(function() {\n                                            this.append('div')\n                                                .attr('class', 'type-container')\n\n                                            this.append('div')\n                                                .attr('class', 'progress-container')\n                                                .call(function() {\n                                                    this.append('button').attr('class', 'cancel')\n                                                    this.append('div').attr('class', 'progress')\n                                                        .append('div')\n                                                            .attr('class', 'bar')\n                                                })\n                                            this.append('div')\n                                                .attr('class', 'progress-description')\n\n                                        });\n\n                                    this.append('div')\n                                        .attr('class', 'actions-container')\n                                        .call(function() {\n                                            this.append('div')\n                                                .attr('class', 'actions-plugin')\n                                            this.append('button')\n                                                .attr('class', 'btn btn-mini btn-danger delete')\n                                                .text(i18n('activity.process.button.dismiss'))\n                                        })\n\n                                });\n                            this.exit()\n                                .each(function() {\n                                    $('.actions-plugin', this).teardownAllComponents();\n                                })\n                                .remove();\n\n                            this.attr('data-process-id', _.property('id'));\n                            // TODO: add transition to delay this?\n                            this.attr('class', function(process) {\n                                if (processIsFinished(process)) {\n                                    return 'finished';\n                                }\n                            });\n\n                            this.select('.actions-plugin').each(function() {\n                                var datum = d3.select(this).datum(),\n                                    handler = handlersByType[datum.type];\n\n                                if (handler) {\n                                    var componentPath = handler.finishedComponentPath,\n                                        Component = componentPath && finishedComponents[componentPath];\n\n                                    if (Component && datum.endTime) {\n                                        /**\n                                         * FlightJS or React Component to render when activity is completed\n                                         *\n                                         * @typedef org.openlumify.activity~FinishedComponent\n                                         * @property {object} activityItem The activity item\n                                         */\n                                        Attacher()\n                                            .node(this)\n                                            .component(Component)\n                                            .params({\n                                                process: datum\n                                            })\n                                            .attach()\n                                        return;\n                                    }\n                                }\n\n                                Attacher().node(this).teardown();\n                            });\n\n                            this.select('.type-container').each(function() {\n                                var datum = d3.select(this).datum();\n\n                                if (datum.type && datum.type in handlersByType) {\n                                    /**\n                                     * Function that is responsible for populating the text of the activity row.\n                                     *\n                                     * @callback org.openlumify.activity~titleRenderer\n                                     * @param {Element} el Html element to render title in\n                                     * @param {object} activity The activity object. Either long running process json, or object with eventData.\n                                     */\n                                    handlersByType[datum.type].titleRenderer(this, datum);\n                                } else if (datum.type) {\n                                    console.warn('No activity formatter for ', datum.type);\n                                } else {\n                                    console.warn('No activity process doesn\\'t contain a type property');\n                                }\n                            });\n\n                            this.select('.bar').style('width', function(process) {\n                                if (processIsIndeterminate(process)) {\n                                    return '100%';\n                                }\n                                return ((process.progress || 0) * 100) + '%';\n                            });\n\n                            this.select('.progress-container').attr('class', function(process) {\n                                var cls = 'progress-container ';\n                                if (processAllowCancel(process)) {\n                                    return cls;\n                                }\n\n                                return cls + 'no-cancel';\n                            });\n\n                            this.select('.progress').attr('class', function(process) {\n                                var cls = 'progress ';\n\n                                if (processIsIndeterminate(process)) {\n                                    return cls + 'active progress-striped';\n                                }\n                                return cls + ' determinate';\n                            });\n\n                            this.select('.progress-description').text(function(process) {\n                                var timePrefix = '';\n\n                                if (process.endTime) {\n                                    timePrefix = 'Finished ' + F.date.relativeToNow(F.date.utc(process.endTime));\n                                } else if (process.startTime) {\n                                    timePrefix = 'Started ' + F.date.relativeToNow(F.date.utc(process.startTime));\n                                } else {\n                                    timePrefix = 'Enqueued ' + F.date.relativeToNow(F.date.utc(process.enqueueTime));\n                                }\n\n                                if (process.progressMessage) {\n                                    return timePrefix + ' – ' + process.progressMessage;\n                                }\n\n                                return timePrefix;\n                            });\n                        })\n                });\n        }\n\n    }\n});\n"]}