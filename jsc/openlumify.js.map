{"version":3,"sources":["../js/openlumify.js"],"names":["require","jQuery","compose","registry","advice","withLogging","debug","_","_inflection","Visibility","Privileges","$","ui","keyCode","ENTER","fn","size","console","warn","length","andSelf","addBack","apply","arguments","lockDownUnderscore","window","requestIdleCallback","callback","setTimeout","cancelIdleCallback","handle","clearTimeout","requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame","TRANSITION_END","ANIMATION_END","VISALLO_MIMETYPES","mapObject","_PREFIX","_FORMAT","_DataTransferHasOpenLumify","dataTransfer","specificType","any","types","type","indexOf","ELEMENTS","RESOLVED_INFO","str","key","obj","substring","progress","progressBar","progressBarText","TOTAL_PROGRESS","MAX_RESIZE_TRIGGER_INTERVAL","App","FullScreenApp","F","withDataRequest","previousUrl","location","href","configureApplication","Data","enable","DEBUG","events","logNone","e","templateSettings","escape","evaluate","interpolate","attachTo","document","on","loadApplicationTypeBasedOnUrlHash","throttle","event","target","trigger","Promise","then","_i18n","i18n","updateOpenLumifyLoadingProgress","React","_F","_withDataRequest","define","identity","userHasValidPrivileges","me","privileges","toOpen","vertexUrl","parametersInUrl","vertexIds","edgeIds","toOpenIds","workspaceId","redirectUrl","popoutDetails","originalEvent","mainApp","newUrl","isAddUrl","isRedirectUrl","isMainApp","isPopoutUrl","all","openlumifyPluginResources","beforeAuth","map","loadUser","Error","attachApplication","catch","loginRequired","message","options","user","toggleClass","isFullscreenDetails","openlumifyData","isFullscreen","one","afterAuth","error","loginSuccess","animate","Login","removeOpenLumifyLoading","teardownAll","errorMessage","errorMessageOptions","len","i","pluginTimes","path","t0","Date","getTime","t1","push","finally","groupCollapsed","log","table","groupEnd","dataRequest","test","hash","reload","resolve","html","config","bootstrapTypeaheadScrollFix","configureDateFormats","remove","comp","appOptions","addVertexIds","section","name","openAdminTool","pick","isEmpty","tools","openMenubarTools","removeClass","animateFromLogin","defer","find","teardownAllComponents","end","dateDisplay","timeDisplay","showTz","date","setDateFormat","setTimeFormat","datepicker","defaults","format","datepickerFormat","autoclose","showMeridian","timepicker","maxHours","string","percentInProgress","dataset","finished","translatedString","segment","inc","textContent","style","width","Math","round","color","fulfill","delay","url","isFullscreenUrl","Object","defineProperty","value","writable"],"mappings":"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","file":"openlumify.js","sourcesContent":["require([\n    'jquery',\n    'flight/lib/compose',\n    'flight/lib/registry',\n    'flight/lib/advice',\n    'flight/lib/logger',\n    'flight/lib/debug',\n    'underscore',\n    'underscore.inflection',\n    'util/visibility',\n    'util/privileges',\n    'util/jquery.flight',\n    'util/jquery.removePrefixedClasses',\n    'util/jquery/plugins',\n    'util/promise'\n],\nfunction(jQuery,\n         compose,\n         registry,\n         advice,\n         withLogging,\n         debug,\n         _,\n         _inflection,\n         Visibility,\n         Privileges) {\n    'use strict';\n\n    $.ui = { keyCode: { ENTER: 13 } };\n    // For backward compatibility\n    jQuery.fn.size = function() {\n        console.warn('$.size is deprecated');\n        return this.length;\n    };\n    jQuery.fn.andSelf = function() {\n        console.warn('$.andSelf is deprecated, use $.addBack');\n        return jQuery.fn.addBack.apply(this, arguments);\n    };\n\n    lockDownUnderscore(_);\n\n    // Debug retina/non-retina by changing to 1/2\n    // window.devicePixelRatio = 1;\n\n    window.requestIdleCallback =\n        typeof window === 'undefined' ?\n        function() { } :\n        (\n            window.requestIdleCallback ||\n            function(callback) {\n                return setTimeout(callback, 1000 / 60);\n            }\n        );\n    window.cancelIdleCallback =\n        typeof window === 'undefined' ?\n        function() { } :\n        (\n            window.cancelIdleCallback ||\n            function(handle) {\n                clearTimeout(handle, 1000 / 60);\n            }\n        );\n    window.requestAnimationFrame =\n        typeof window === 'undefined' ?\n        function() { } :\n        (\n            window.requestAnimationFrame ||\n            window.mozRequestAnimationFrame ||\n            window.webkitRequestAnimationFrame ||\n            window.msRequestAnimationFrame ||\n            function(callback) {\n                return setTimeout(callback, 1000 / 60);\n            }\n        );\n    window.TRANSITION_END = 'transitionend webkitTransitionEnd MSTransitionEnd oTransitionEnd otransitionend';\n    window.ANIMATION_END = 'animationend webkitAnimationEnd MSAnimationEnd oAnimationEnd oanimationend';\n    window.VISALLO_MIMETYPES = _.mapObject({\n        _PREFIX: 'application/x-openlumify.',\n        _FORMAT: '+json',\n        _DataTransferHasOpenLumify: (dataTransfer, specificType) => {\n            return _.any(dataTransfer.types, (type) => {\n                if (specificType) return type === specificType\n                return type.indexOf(VISALLO_MIMETYPES._PREFIX) === 0;\n            })\n        },\n\n        ELEMENTS: 'elements',\n        RESOLVED_INFO: 'resolvedInfo'\n    }, (str, key, obj) => {\n        if (key.substring(0, 1) !== '_') {\n            return obj._PREFIX + str + obj._FORMAT;\n        }\n        return str;\n    })\n\n    var progress = 0,\n        progressBar = null,\n        progressBarText = null,\n        TOTAL_PROGRESS = 4,\n        MAX_RESIZE_TRIGGER_INTERVAL = 250,\n        App, FullScreenApp, F, withDataRequest,\n        previousUrl = window.location.href;\n\n    $(function() {\n        require(['cli']);\n        require(['data/data'], configureApplication);\n        require(['urlPolyfill']);\n\n        function configureApplication(Data) {\n            // Flight Logging\n            try {\n                debug.enable(false);\n                DEBUG.events.logNone();\n            } catch(e) {\n                console.warn('Error enabling DEBUG mode for flight' +\n                ', probably because Safari Private Browsing enabled', e);\n            }\n\n            // Default templating\n            _.templateSettings.escape = /\\{([\\s\\S]+?)\\}/g;\n            _.templateSettings.evaluate = /<%([\\s\\S]+?)%>/g;\n            _.templateSettings.interpolate = /\\{-([\\s\\S]+?)\\}/g;\n\n            Data.attachTo(document);\n            Visibility.attachTo(document);\n            Privileges.attachTo(document);\n            $(window)\n                .on('hashchange', loadApplicationTypeBasedOnUrlHash)\n                .on('resize', _.throttle(function(event) {\n                    if (event.target !== window) {\n                        return;\n                    }\n                    $(document).trigger('windowResize');\n                }, MAX_RESIZE_TRIGGER_INTERVAL));\n\n            Promise.require('util/messages')\n                .then(function(_i18n) {\n                    window.i18n = _i18n;\n                    updateOpenLumifyLoadingProgress('dependencies');\n\n                    require([\n                        'react',\n                        'util/vertex/urlFormatters',\n                        'util/withDataRequest',\n                        'util/handlebars/before_auth_helpers',\n                    ], function(React, _F, _withDataRequest) {\n                        // Don't need to require react in jsx even if never used\n                        window.React = React;\n                        // Provide for react-virtualized\n                        define('React', [], React);\n                        define('ReactDOM', ['react-dom'], _.identity);\n                        F = _F;\n                        withDataRequest = _withDataRequest;\n                        loadApplicationTypeBasedOnUrlHash();\n                    })\n                })\n        }\n    });\n\n    function userHasValidPrivileges(me) {\n        return me.privileges && me.privileges.length > 0;\n    }\n\n    /**\n     * Switch between openlumify and openlumify-fullscreen-details based on url hash\n     */\n    function loadApplicationTypeBasedOnUrlHash(e) {\n        var toOpen = F.vertexUrl.parametersInUrl(location.href),\n            vertexIds = toOpen && toOpen.vertexIds,\n            edgeIds = toOpen && toOpen.edgeIds,\n            toOpenIds = (\n                (vertexIds && vertexIds.length) ||\n                (edgeIds && edgeIds.length)\n            ),\n\n            workspaceId = toOpen && toOpen.workspaceId,\n\n            redirectUrl = toOpen && toOpen.redirectUrl,\n\n            // Is this the popoout details app? ids passed to hash?\n            popoutDetails = !!(toOpen && toOpen.type === 'FULLSCREEN' && toOpenIds),\n\n            // If this is a hash change\n            event = e && e.originalEvent,\n\n            // Is this the default openlumify application?\n            mainApp = !popoutDetails,\n            newUrl = window.location.href;\n\n        if (event && (isAddUrl(previousUrl) || isRedirectUrl(previousUrl)) && isMainApp(newUrl)) {\n            previousUrl = newUrl;\n            return;\n        }\n\n        if (event && isPopoutUrl(previousUrl) && isPopoutUrl(newUrl)) {\n            previousUrl = newUrl;\n            return $('#app').trigger('vertexUrlChanged', {\n                vertexIds: vertexIds,\n                edgeIds: edgeIds,\n                workspaceId: workspaceId,\n                redirectUrl: redirectUrl\n            });\n        }\n\n        previousUrl = newUrl;\n        Promise.all(openlumifyPluginResources.beforeAuth.map(Promise.require))\n            .then(loadUser)\n            .then(function(me) {\n                if (!userHasValidPrivileges(me)) {\n                    throw new Error('missing privileges')\n                }\n                attachApplication(false, null, null, me);\n            })\n            .catch(function() {\n                attachApplication(true, '', {});\n            });\n\n        function attachApplication(loginRequired, message, options, user) {\n            if (!event) {\n                $('html')\n                    .toggleClass('fullscreenApp', mainApp)\n                    .toggleClass('fullscreenDetails', popoutDetails);\n\n                window.isFullscreenDetails = popoutDetails;\n            }\n\n            openlumifyData.isFullscreen = false;\n\n            if (loginRequired) {\n                // Login required, once less progress item (no after-auth plugins)\n                TOTAL_PROGRESS--;\n                updateOpenLumifyLoadingProgress('userinterface');\n\n                $(document).one('loginSuccess', function() {\n                    loadUser().then(user => {\n                        Promise.all(openlumifyPluginResources.afterAuth.map(Promise.require))\n                            .catch(function(error) {\n                                $('#login').trigger('showErrorMessage', {\n                                    message: i18n('openlumify.loading.progress.pluginerror')\n                                })\n                                throw error;\n                            })\n                            .then(function() {\n                                loginSuccess({ animate: true, user });\n                            })\n                    })\n                });\n\n                require(['login'], function(Login) {\n                    removeOpenLumifyLoading().then(function() {\n                        Login.teardownAll();\n                        Login.attachTo('#login', {\n                            errorMessage: message,\n                            errorMessageOptions: options,\n                            toOpen: toOpen\n                        });\n                    })\n                });\n            } else {\n                updateOpenLumifyLoadingProgress('extensions', 0);\n                var len = openlumifyPluginResources.afterAuth.length,\n                    i = 0,\n                    pluginTimes = [];\n                Promise.all(openlumifyPluginResources.afterAuth.map(function(path) {\n                    const t0 = new Date().getTime();\n                    return Promise.require(path).then(function() {\n                        const t1 = new Date().getTime();\n                        pluginTimes.push({ path, 'duration (ms)': t1 - t0 });\n                        updateOpenLumifyLoadingProgress('extensions', ++i / len);\n                    })\n                }))\n                    .catch(function(error) {\n                        removeOpenLumifyLoading('pluginerror');\n                        throw error;\n                    })\n                    .then(function() {\n                        updateOpenLumifyLoadingProgress('userinterface');\n                        loginSuccess({ user });\n                    })\n                    .finally(function() {\n                        if (window.console) {\n                            if ('groupCollapsed' in console && 'table' in console) {\n                                console.groupCollapsed('Plugin Load Metrics');\n                                console.log('Later plugins will be slower due to network concurrency limits')\n                                console.table(pluginTimes);\n                                console.groupEnd();\n                            }\n                        }\n                    })\n            }\n        }\n\n        function loadUser() {\n            return withDataRequest.dataRequest('user', 'me')\n        }\n\n        function loginSuccess({ animate = false, user }) {\n            if (animate && (/^#?[a-z]+=/i).test(location.hash)) {\n                window.location.reload();\n            } else {\n                Promise.resolve(user || loadUser()).then(function(me) {\n                    if (!userHasValidPrivileges(me)) {\n                        $('#login .authentication').html(\n                            '<span style=\"color: #D42B34;\">' + i18n('openlumify.login.missingPrivileges')\n                            + '<p/><a class=\"logout\" href=\"\">' + i18n('openlumify.login.logout') + '</a>'\n                            + '</span>');\n                        return;\n                    }\n\n                    require([\n                        'util/requirejs/promise!util/service/propertiesPromise',\n                        'util/formatters',\n                        'util/jquery/bootstrapTypeaheadScrollFix',\n                        'bootstrap',\n                        'easing',\n                        'jquery-scrollstop',\n                        'bootstrap-datepicker',\n                        'bootstrap-timepicker',\n                        'util/visibility/util',\n                        'util/handlebars/after_auth_helpers'\n                    ], function(config, F, bootstrapTypeaheadScrollFix) {\n\n                        configureDateFormats(config, F)\n\n                        bootstrapTypeaheadScrollFix();\n\n                        if (popoutDetails) {\n                            openlumifyData.isFullscreen = true;\n                            $('#login').remove();\n                            require(['appFullscreenDetails'], function(comp) {\n                                removeOpenLumifyLoading().then(function() {\n                                    if (event) {\n                                        location.reload();\n                                    } else {\n                                        if (App) {\n                                            App.teardownAll();\n                                        }\n                                        FullScreenApp = comp;\n                                        FullScreenApp.teardownAll();\n                                        FullScreenApp.attachTo('#app', {\n                                            vertexIds: vertexIds,\n                                            edgeIds: edgeIds,\n                                            workspaceId: workspaceId\n                                        });\n                                    }\n                                });\n                            });\n                        } else {\n                            if (!animate) {\n                                $('#login').remove();\n                            }\n                            require(['app'], function(comp) {\n                                removeOpenLumifyLoading().then(function() {\n                                    App = comp;\n                                    if (event) {\n                                        location.reload();\n                                    } else {\n                                        if (FullScreenApp) {\n                                            FullScreenApp.teardownAll();\n                                        }\n                                        App.teardownAll();\n                                        var appOptions = {};\n                                        if (toOpen && toOpen.type === 'ADD' && vertexIds.length) {\n                                            appOptions.addVertexIds = toOpen;\n                                        }\n                                        if (toOpen && toOpen.type === 'ADMIN' && toOpen.section && toOpen.name) {\n                                            appOptions.openAdminTool = _.pick(toOpen, 'section', 'name');\n                                        }\n                                        if (toOpen && toOpen.type === 'REDIRECT' && toOpen.redirectUrl) {\n                                            window.location.href = toOpen.redirectUrl;\n                                            return;\n                                        }\n                                        if (toOpen && toOpen.type === 'TOOLS' && !_.isEmpty(toOpen.tools)) {\n                                            appOptions.openMenubarTools = toOpen.tools;\n                                        }\n                                        if (animate) {\n                                            $('#login .authentication button.loading').removeClass('loading');\n                                            appOptions.animateFromLogin = true;\n                                        }\n\n                                        App.attachTo('#app', appOptions);\n                                        _.defer(function() {\n                                            // Cache login in case server goes down\n                                            require(['login']);\n                                        });\n\n                                        if (animate) {\n                                            $('#login .logo').one(TRANSITION_END, function() {\n                                                $('#login')\n                                                    .find('.authentication').teardownAllComponents()\n                                                    .end().teardownAllComponents();\n                                            });\n                                        }\n                                    }\n                                });\n                            });\n                        }\n                    });\n                });\n            }\n        }\n    }\n\n    function configureDateFormats(config, F) {\n        const dateDisplay = config['formats.date.dateDisplay'];\n        const timeDisplay = config['formats.date.timeDisplay'];\n        const showTz = config['formats.date.showTimezone'] !== 'false';\n\n        F.date.setDateFormat(dateDisplay);\n        F.date.setTimeFormat(timeDisplay, showTz);\n\n        // Default datepicker options\n        $.fn.datepicker.defaults.format = F.date.datepickerFormat();\n        $.fn.datepicker.defaults.autoclose = true;\n\n        // Check whether to show am/pm and twelve hour time in timepicker\n        const showMeridian = /(h|a|A)/.test(timeDisplay);\n        $.fn.timepicker.defaults.showMeridian = showMeridian;\n        $.fn.timepicker.defaults.maxHours = showMeridian ? 12 : 24;\n    }\n\n    function updateOpenLumifyLoadingProgress(string, percentInProgress) {\n        if (!progressBar) {\n            progressBar = $('#openlumify-loading-static .bar')[0];\n            progressBarText = $('#openlumify-loading-static span')[0];\n        }\n        if (progressBar.dataset.finished) return;\n\n        var translatedString = i18n('openlumify.loading.progress.' + string);\n\n        if (arguments.length === 2 && percentInProgress < 1.0) {\n            var segment = 1 / TOTAL_PROGRESS,\n                inc = segment * percentInProgress;\n            progressBarText.textContent = translatedString;\n            progressBar.style.width = Math.round((progress / TOTAL_PROGRESS + inc) * 100) + '%';\n        } else {\n            progress++;\n            progressBarText.textContent = translatedString;\n            progressBar.style.width = Math.round(progress / TOTAL_PROGRESS * 100) + '%';\n        }\n    }\n\n    function removeOpenLumifyLoading(error) {\n        if (error) {\n            progressBar.dataset.finished = true;\n            progressBarText.textContent = i18n('openlumify.loading.progress.' + error);\n            progressBarText.style.color = '#D42B34';\n        } else {\n            updateOpenLumifyLoadingProgress('starting');\n            return new Promise(function(fulfill) {\n                _.delay(function() {\n                    $('#openlumify-loading-static').remove();\n                    fulfill();\n                }, 500)\n            });\n        }\n    }\n\n    function isPopoutUrl(url) {\n        return F.vertexUrl.isFullscreenUrl(url);\n    }\n\n    function isAddUrl(url) {\n        return (/#add=/).test(url);\n    }\n\n    function isRedirectUrl(url) {\n        return (/#redirect=/).test(url);\n    }\n\n    function isMainApp(url) {\n        return (/#\\s*$/).test(url) || url.indexOf('#') === -1;\n    }\n\n    // Both lodash and underscore pollute the global 'window' object with '_', this prevents future includes of these\n    // libraries from doing that.\n    function lockDownUnderscore(_) {\n        Object.defineProperty(window, '_', {\n            value: _,\n            writable: false\n        });\n    }\n});\n"]}