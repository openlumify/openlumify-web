{"version":3,"sources":["../../../js/detail/audio/audio.js"],"names":["define","defineComponent","AudioScrubber","F","Audio","attributes","model","previewSelector","after","attr","on","event","data","render","$node","parents","onAVLinkClicked","isAudioReady","vertex","props","concat","length","rendered","empty","rawUrl","raw","html","attachTo","select","trigger"],"mappings":"AACAA,OAAO,CACH,sBADG,CAEH,qBAFG,CAGH,wBAHG,CAAP,CAIG,SACCC,eADD,CAECC,aAFD,CAGCC,CAHD,CAGI,CACH,aAEA,MAAOF,iBAAgBG,KAAhB,CAAP,CAEA,QAASA,MAAT,EAAiB,CAEb,KAAKC,UAAL,CAAgB,CACZC,MAAO,IADK,CAEZC,gBAAiB,gBAFL,CAAhB,EAKA,KAAKC,KAAL,CAAW,YAAX,CAAyB,UAAW,CAChC,KAAKF,KAAL,CAAa,KAAKG,IAAL,CAAUH,KAAvB,CACA,KAAKI,EAAL,CAAQ,aAAR,CAAuB,SAASC,KAAT,CAAgBC,IAAhB,CAAsB,CACzC,KAAKN,KAAL,CAAaM,KAAKN,KAAlB,CACA,KAAKO,MAAL,GACH,CAHD,EAIA,KAAKH,EAAL,CAAQ,KAAKI,KAAL,CAAWC,OAAX,CAAmB,eAAnB,CAAR,CAA6C,eAA7C,CAA8D,KAAKC,eAAnE,EACA,KAAKH,MAAL,GACH,CARD,EAUA,KAAKI,YAAL,CAAoB,UAAW,CAC3B,MACI,CAACd,EAAEe,MAAF,CAASC,KAAT,CAAe,KAAKb,KAApB,CAA2B,iCAA3B,GAAiE,EAAlE,EACCc,MADD,CAEKjB,EAAEe,MAAF,CAASC,KAAT,CAAe,KAAKb,KAApB,CAA2B,iCAA3B,GAAiE,EAFtE,CADG,CAKLe,MALK,EAKK,CALZ,CAMH,CAPD,CASA,KAAKR,MAAL,CAAc,UAAW,CACrB,GAAI,CAAC,KAAKI,YAAL,EAAL,CAA0B,CACtB,KAAKK,QAAL,CAAgB,KAAhB,CACA,MAAO,MAAKR,KAAL,CAAWS,KAAX,EAAP,CACH,CACD,GAAI,CAAC,KAAKD,QAAV,CAAoB,CAChB,GAAIE,QAASrB,EAAEe,MAAF,CAASO,GAAT,CAAa,KAAKnB,KAAlB,CAAb,CACA,GAAIkB,MAAJ,CAAY,CACR,KAAKV,KAAL,CAAWY,IAAX,CAAgB,mCAAhB,EACAxB,cAAcyB,QAAd,CAAuB,KAAKC,MAAL,CAAY,iBAAZ,CAAvB,CAAuD,CACnDJ,OAAQA,MAD2C,CAAvD,EAGA,KAAKF,QAAL,CAAgB,IAAhB,CACH,CACJ,CACJ,CAfD,CAiBA,KAAKN,eAAL,CAAuB,SAASL,KAAT,CAAgBC,IAAhB,CAAsB,CACzC,KAAKiB,OAAL,CAAa,KAAKD,MAAL,CAAY,iBAAZ,CAAb,CAA6C,YAA7C,CAA2DhB,IAA3D,EACH,CAFD,CAGH,CACJ,CA3DD","file":"audio.js","sourcesContent":["\ndefine([\n    'flight/lib/component',\n    'util/audio/scrubber',\n    'util/vertex/formatters'\n], function(\n    defineComponent,\n    AudioScrubber,\n    F) {\n    'use strict';\n\n    return defineComponent(Audio);\n\n    function Audio() {\n\n        this.attributes({\n            model: null,\n            previewSelector: '.audio-preview'\n        })\n\n        this.after('initialize', function() {\n            this.model = this.attr.model;\n            this.on('updateModel', function(event, data) {\n                this.model = data.model;\n                this.render();\n            })\n            this.on(this.$node.parents('.type-content'), 'avLinkClicked', this.onAVLinkClicked);\n            this.render();\n        });\n\n        this.isAudioReady = function() {\n            return (\n                (F.vertex.props(this.model, 'http://openlumify.org#audio-ogg') || [])\n                .concat(\n                    (F.vertex.props(this.model, 'http://openlumify.org#audio-mp4') || [])\n                )\n            ).length >= 2;\n        };\n\n        this.render = function() {\n            if (!this.isAudioReady()) {\n                this.rendered = false;\n                return this.$node.empty();\n            }\n            if (!this.rendered) {\n                var rawUrl = F.vertex.raw(this.model);\n                if (rawUrl) {\n                    this.$node.html('<div class=\"audio-preview\"></div>')\n                    AudioScrubber.attachTo(this.select('previewSelector'), {\n                        rawUrl: rawUrl\n                    });\n                    this.rendered = true;\n                }\n            }\n        };\n\n        this.onAVLinkClicked = function(event, data) {\n            this.trigger(this.select('previewSelector'), 'seekToTime', data);\n        };\n    }\n});\n"]}