var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i];}return target;}define(['create-react-class','prop-types','classnames','components/Alert','components/element/ElementSelector','components/ontology/ConceptSelector','components/justification/JustificationEditor','components/visibility/VisibilityEditor','util/vertex/formatters'],function(createReactClass,PropTypes,classNames,Alert,ElementSelector,ConceptSelector,JustificationEditor,VisibilityEditor,F){var DefaultVisibility={value:'',valid:true};var Resolve=createReactClass({displayName:'Resolve',propTypes:{artifactId:PropTypes.string.isRequired,propertyKey:PropTypes.string.isRequired,propertyName:PropTypes.string.isRequired,mentionEnd:PropTypes.number.isRequired,mentionStart:PropTypes.number.isRequired,sign:PropTypes.string.isRequired,onCancel:PropTypes.func.isRequired,onResolve:PropTypes.func.isRequired,error:PropTypes.instanceOf(Error),loading:PropTypes.bool,resolvedFromTermMention:PropTypes.string,conceptType:PropTypes.string},getInitialState:function getInitialState(){return{visibility:DefaultVisibility,conceptId:this.props.conceptType};},render:function render(){var _props=this.props,onCancel=_props.onCancel,sign=_props.sign,conceptType=_props.conceptType,error=_props.error,_props$loading=_props.loading,loading=_props$loading===undefined?false:_props$loading,rest=_objectWithoutProperties(_props,['onCancel','sign','conceptType','error','loading']);var _state=this.state,resolvedVertexId=_state.resolvedVertexId,newElementText=_state.newElementText,conceptId=_state.conceptId,_state$justification=_state.justification,justification=_state$justification===undefined?{}:_state$justification,visibility=_state.visibility;var justificationValid=justification.valid,justificationValues=justification.value;return React.createElement('div',{className:'form'},error?React.createElement(Alert,{error:error}):null,React.createElement('h1',null,resolvedVertexId?i18n('detail.text.terms.form.resolve.existing'):newElementText?i18n('detail.text.terms.form.resolve.new'):i18n('detail.text.terms.form.resolve.search')),React.createElement(ElementSelector,{creatable:true,filterResultsToTitleField:true,searchOptions:{matchType:'vertex'},value:sign,placeholder:i18n('detail.text.terms.form.resolve.placeholder'),onElementSelected:this.onElementSelected,onCreateNewElement:this.onCreateNewElement,createNewRenderer:function createNewRenderer(value){return i18n('detail.text.terms.form.resolve.create',value);},createNewValueRenderer:function createNewValueRenderer(value){return value;}}),resolvedVertexId||newElementText?React.createElement('div',null,!resolvedVertexId&&newElementText?React.createElement(ConceptSelector,{clearable:conceptId!==conceptType,onSelected:this.onConceptSelected,value:conceptId||conceptType||''}):null,React.createElement(JustificationEditor,{value:justificationValues,onJustificationChanged:this.onJustificationChanged}),!resolvedVertexId?React.createElement(VisibilityEditor,{value:visibility&&visibility.value,onVisibilityChanged:this.onVisibilityChanged}):null):null,React.createElement('div',{className:'buttons'},React.createElement('button',{onClick:onCancel,className:'btn btn-link btn-small'},i18n('detail.text.terms.form.cancel')),React.createElement('button',{disabled:loading||!this.isValid(),onClick:this.onResolve,className:classNames('btn-success btn btn-small',{loading:loading})},i18n('detail.text.terms.form.resolve.button'))));},onResolve:function onResolve(){var _props2=this.props,artifactId=_props2.artifactId,propertyName=_props2.propertyName,propertyKey=_props2.propertyKey,resolvedFromTermMention=_props2.resolvedFromTermMention,initialSign=_props2.sign,mentionStart=_props2.mentionStart,mentionEnd=_props2.mentionEnd;var _state2=this.state,resolvedVertexId=_state2.resolvedVertexId,sign=_state2.newElementText,conceptId=_state2.conceptId,justification=_state2.justification,visibility=_state2.visibility;this.props.onResolve(_extends({visibilitySource:visibility.value,artifactId:artifactId,propertyName:propertyName,propertyKey:propertyKey,resolvedFromTermMention:resolvedFromTermMention,mentionStart:mentionStart,mentionEnd:mentionEnd},justification.value,resolvedVertexId?{resolvedVertexId:resolvedVertexId,sign:initialSign}:{sign:sign,conceptId:conceptId}));},onElementSelected:function onElementSelected(element){this.setState({resolvedVertexId:element?element.id:null,newElementText:null,visibility:DefaultVisibility});},onCreateNewElement:function onCreateNewElement(text){this.setState({newElementText:text,resolvedVertexId:null});},onConceptSelected:function onConceptSelected(concept){var conceptType=this.props.conceptType;this.setState({conceptId:concept?concept.id:conceptType});},onJustificationChanged:function onJustificationChanged(justification){this.setState({justification:justification});},onVisibilityChanged:function onVisibilityChanged(visibility){this.setState({visibility:visibility});},isValid:function isValid(){var _state3=this.state,resolvedVertexId=_state3.resolvedVertexId,newElementText=_state3.newElementText,conceptId=_state3.conceptId,justification=_state3.justification,visibility=_state3.visibility;var entity=resolvedVertexId||newElementText&&conceptId;var others=_.all([justification,visibility],function(o){return o&&o.valid;});return entity&&others;}});return Resolve;});
//# sourceMappingURL=Resolve.js.map
