var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};define(['create-react-class','prop-types','classnames','components/Alert','components/ontology/RelationshipSelector','components/justification/JustificationEditor','components/visibility/VisibilityEditor','util/vertex/formatters','components/element/Element'],function(createReactClass,PropTypes,classNames,Alert,RelationshipSelector,JustificationEditor,VisibilityEditor,F,Element){var Relationship=createReactClass({displayName:'Relationship',propTypes:{onCancel:PropTypes.func.isRequired,onSave:PropTypes.func.isRequired,sourceVertexId:PropTypes.string.isRequired,targetVertexId:PropTypes.string.isRequired},getInitialState:function getInitialState(){return{invert:false,visibility:{value:'',valid:true}};},render:function render(){var _props=this.props,loading=_props.loading,error=_props.error,onCancel=_props.onCancel,onSave=_props.onSave,vertices=_props.vertices,onFocusElements=_props.onFocusElements;var _state=this.state,invert=_state.invert,relationshipId=_state.relationshipId,_state$justification=_state.justification,justification=_state$justification===undefined?{}:_state$justification,visibility=_state.visibility;var justificationValid=justification.valid,justificationValues=justification.value;var _props2=this.props,sourceVertexId=_props2.sourceVertexId,targetVertexId=_props2.targetVertexId;if(invert){var _ref=[targetVertexId,sourceVertexId];sourceVertexId=_ref[0];targetVertexId=_ref[1];}var sourceVertex=vertices[sourceVertexId];var targetVertex=vertices[targetVertexId];var sourceId=sourceVertex&&F.vertex.prop(sourceVertex,'conceptType');var targetId=targetVertex&&F.vertex.prop(targetVertex,'conceptType');return React.createElement('div',{className:'form relationshipform'},error?React.createElement(Alert,{error:error}):null,React.createElement('h1',null,i18n('detail.text.terms.form.relationship')),React.createElement('div',{className:'rel-elements'},React.createElement('p',null,React.createElement(Element,{element:sourceVertex,onFocusElements:onFocusElements})),React.createElement('div',{className:'rel-arrow-wrap'},React.createElement('div',{className:'rel-arrow'}),React.createElement('button',{title:i18n('detail.text.terms.form.relationship.invert.tooltip'),onClick:this.onInvert,className:'invert btn btn-link btm-mini'},i18n('detail.text.terms.form.relationship.invert'))),React.createElement('p',null,React.createElement(Element,{element:targetVertex,onFocusElements:onFocusElements}))),React.createElement(RelationshipSelector,{onSelected:this.onSelected,disabled:!sourceId||!targetId,value:relationshipId,filter:{sourceId:sourceId,targetId:targetId}}),React.createElement(JustificationEditor,{value:justificationValues,onJustificationChanged:this.onJustificationChanged}),React.createElement(VisibilityEditor,{value:visibility&&visibility.value,onVisibilityChanged:this.onVisibilityChanged}),React.createElement('div',{className:'buttons'},React.createElement('button',{onClick:onCancel,className:'btn btn-link btn-small'},i18n('detail.text.terms.form.cancel')),React.createElement('button',{disabled:loading||!this.isValid(),onClick:this.onSave,className:classNames('btn-primary btn btn-small',{loading:loading})},i18n('detail.text.terms.form.create'))));},onInvert:function onInvert(){var invert=this.state.invert;this.setState({invert:!invert,relationshipId:null});},onJustificationChanged:function onJustificationChanged(justification){this.setState({justification:justification});},onVisibilityChanged:function onVisibilityChanged(visibility){this.setState({visibility:visibility});},onSelected:function onSelected(relationship){this.setState({relationshipId:relationship?relationship.title:null});},onSave:function onSave(){var _state2=this.state,invert=_state2.invert,relationshipId=_state2.relationshipId,justification=_state2.justification,visibility=_state2.visibility;var _props3=this.props,sourceVertexId=_props3.sourceVertexId,targetVertexId=_props3.targetVertexId;if(invert){var _ref2=[targetVertexId,sourceVertexId];sourceVertexId=_ref2[0];targetVertexId=_ref2[1];}this.props.onSave(_extends({outVertexId:sourceVertexId,inVertexId:targetVertexId,predicateLabel:relationshipId,visibilitySource:visibility.value},justification.value));},isValid:function isValid(){var _state3=this.state,relationshipId=_state3.relationshipId,justification=_state3.justification,visibility=_state3.visibility;var others=_.all([justification,visibility],function(o){return o&&o.valid;});return relationshipId&&others;}});return Relationship;});
//# sourceMappingURL=Relationship.js.map
