var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i];}return target;}define(['create-react-class','prop-types','classnames','components/element/Element','util/vertex/formatters'],function(createReactClass,PropTypes,classNames,Element,F){var sharedProps={refId:PropTypes.string.isRequired,id:PropTypes.string.isRequired,start:PropTypes.number.isRequired,end:PropTypes.number.isRequired,sandboxStatus:PropTypes.string.isRequired,outVertexId:PropTypes.string.isRequired,type:PropTypes.string.isRequired};var selectionProps={mentionStart:PropTypes.number.isRequired,mentionEnd:PropTypes.number.isRequired,type:PropTypes.string.isRequired,snippet:PropTypes.string.isRequired};var url=function url(src){return'url('+src+')';};var getSelectionText=function getSelectionText(snippet){var el=document.createElement('div');el.innerHTML=snippet;return el.textContent;};var Icon=function Icon(props){var src=props.src,_props$isImage=props.isImage,isImage=_props$isImage===undefined?false:_props$isImage;return React.createElement('div',{className:'icon'+(isImage?' image':'')},React.createElement('div',{style:{backgroundImage:url(src)}}));};var Actions=function Actions(props){var actions=props.actions;if(actions.length){return React.createElement('div',{className:'buttons'},actions.map(function(_ref){var label=_ref.label,title=_ref.title,handler=_ref.handler,_ref$classes=_ref.classes,classes=_ref$classes===undefined?{}:_ref$classes;return React.createElement('button',{title:title,className:classNames('btn btn-mini',classes),key:label,onClick:handler},label);}));}return null;};var TermSelection=createReactClass({displayName:'TermSelection',propTypes:_extends({},selectionProps),render:function render(){var _props=this.props,onHoverTerm=_props.onHoverTerm,onResolve=_props.onResolve,onProperty=_props.onProperty,onComment=_props.onComment,canEdit=_props.canEdit,snippet=_props.snippet;var actions=canEdit?[{label:i18n('detail.text.terms.resolve'),title:i18n('detail.text.terms.resolve.tooltip'),handler:this.onResolve,classes:{'btn-success':true}},{label:i18n('detail.text.terms.property'),title:i18n('detail.text.terms.property.tooltip'),handler:onProperty},{label:i18n('detail.text.terms.comment'),title:i18n('detail.text.terms.comment.tooltip'),handler:onComment}]:[];return React.createElement('li',{className:'termselection',onMouseEnter:onHoverTerm},React.createElement(Icon,{src:'../img/glyphicons_custom/selection.png'}),React.createElement('section',null,React.createElement(Actions,{actions:actions}),React.createElement('h1',null,React.createElement('strong',null,i18n('detail.text.terms.selection'))),React.createElement('article',{title:getSelectionText(snippet),dangerouslySetInnerHTML:{__html:snippet}})));},onResolve:function onResolve(){var _props2=this.props,sign=_props2.sign,mentionStart=_props2.mentionStart,mentionEnd=_props2.mentionEnd,snippet=_props2.snippet;this.props.onResolve({sign:sign,mentionStart:mentionStart,mentionEnd:mentionEnd,snippet:snippet});}});var Justification=createReactClass({displayName:'Justification',propTypes:_extends({},sharedProps,{sandboxStatus:PropTypes.string.isRequired,termMentionFor:PropTypes.string.isRequired,termMentionForElementId:PropTypes.string.isRequired,snippet:PropTypes.string.isRequired,resolvedToVertexId:PropTypes.string,resolvedToEdgeId:PropTypes.string}),render:function render(){var _props3=this.props,snippet=_props3.snippet,onHoverTerm=_props3.onHoverTerm,onFocusElements=_props3.onFocusElements,onOpen=_props3.onOpen,onFullscreen=_props3.onFullscreen,termMentionFor=_props3.termMentionFor,termMentionForElementId=_props3.termMentionForElementId,resolvedToEdgeId=_props3.resolvedToEdgeId,resolvedToVertexId=_props3.resolvedToVertexId;var actions=[{label:i18n('detail.text.terms.open'),title:i18n('detail.text.terms.open.tooltip'),handler:onOpen},{label:i18n('detail.text.terms.openfullscreen'),title:i18n('detail.text.terms.openfullscreen.tooltip'),handler:onFullscreen}];var what=i18n('detail.text.terms.justification.prefix.'+(termMentionFor==='PROPERTY'?'property':'element'));var type=termMentionFor==='VERTEX'||termMentionFor==='PROPERTY'&&termMentionForElementId===resolvedToVertexId?'vertices':'edges';var element=this.props[type][termMentionForElementId];return React.createElement('li',{className:'justification',onMouseEnter:onHoverTerm},React.createElement(Icon,{src:'../img/glyphicons_custom/justification.png'}),React.createElement('section',null,React.createElement(Actions,{actions:actions}),React.createElement('h1',null,React.createElement('strong',null,i18n('detail.text.terms.justification')),' ',what,' ',React.createElement(Element,{element:element,onFocusElements:onFocusElements})),React.createElement('article',{title:getSelectionText(snippet),dangerouslySetInnerHTML:{__html:snippet}})));}});var Resolved=createReactClass({displayName:'Resolved',propTypes:_extends({},sharedProps,{title:PropTypes.string.isRequired,termMentionFor:PropTypes.string.isRequired,resolvedToVertexId:PropTypes.string.isRequired,resolvedToEdgeId:PropTypes.string.isRequired,conceptType:PropTypes.string,process:PropTypes.string}),render:function render(){var _props4=this.props,title=_props4.title,onOpen=_props4.onOpen,onFullscreen=_props4.onFullscreen,onUnresolve=_props4.onUnresolve,onHoverTerm=_props4.onHoverTerm,onFocusElements=_props4.onFocusElements,canEdit=_props4.canEdit,termMentionFor=_props4.termMentionFor,sandboxStatus=_props4.sandboxStatus,conceptType=_props4.conceptType,getConceptOrDefault=_props4.getConceptOrDefault,resolvedToVertexId=_props4.resolvedToVertexId,vertices=_props4.vertices;var concept=getConceptOrDefault(conceptType);var element=vertices[resolvedToVertexId];var actions=[];if(element){actions.push({label:i18n('detail.text.terms.open'),title:i18n('detail.text.terms.open.tooltip'),handler:onOpen},{label:i18n('detail.text.terms.openfullscreen'),title:i18n('detail.text.terms.openfullscreen.tooltip'),handler:onFullscreen});var canUnresolve=canEdit&&termMentionFor==='VERTEX'&&sandboxStatus!=='PUBLIC';if(canUnresolve){actions.push({label:i18n('detail.text.terms.unresolve'),title:i18n('detail.text.terms.unresolve.tooltip'),handler:onUnresolve,classes:{'btn-danger':true}});}}return React.createElement('li',{className:'resolved',onMouseEnter:onHoverTerm},element&&!F.vertex.imageIsFromConcept(element)?React.createElement(Icon,{isImage:true,src:F.vertex.image(element,null,30)}):React.createElement(Icon,{src:concept.glyphIconHref}),React.createElement('section',null,React.createElement(Actions,{actions:actions}),React.createElement('h1',null,React.createElement('strong',null,i18n('detail.text.terms.resolved')),' ',i18n('detail.text.terms.resolved.prefix'),' ',React.createElement('em',null,concept.displayName),' ',React.createElement(Element,{element:element,onFocusElements:onFocusElements})),React.createElement('article',null,React.createElement('span',{className:'selection'},title))));}});var Suggestion=createReactClass({displayName:'Suggestion',propTypes:_extends({},sharedProps,{title:PropTypes.string.isRequired,process:PropTypes.string,conceptType:PropTypes.string}),render:function render(){var _props5=this.props,title=_props5.title,process=_props5.process,conceptType=_props5.conceptType,getConceptOrDefault=_props5.getConceptOrDefault,onHoverTerm=_props5.onHoverTerm,onProperty=_props5.onProperty,canEdit=_props5.canEdit;var actions=[];var concept=getConceptOrDefault(conceptType);if(canEdit){actions.push({label:i18n('detail.text.terms.resolve'),title:i18n('detail.text.terms.resolve.tooltip'),handler:this.onResolve,classes:{'btn-success':true}});}return React.createElement('li',{className:'suggestion',onMouseEnter:onHoverTerm},React.createElement(Icon,{src:'../img/glyphicons/glyphicons_194_circle_question_mark@2x.png'}),React.createElement('section',null,React.createElement(Actions,{actions:actions}),React.createElement('h1',null,React.createElement('strong',null,i18n('detail.text.terms.resolvable')),' ',React.createElement('em',null,concept.displayName),' ',i18n('detail.text.terms.resolvable.prefix'),' ',React.createElement('strong',null,process)),React.createElement('article',null,React.createElement('span',{className:'selection'},title))));},onResolve:function onResolve(){var _props6=this.props,conceptType=_props6.conceptType,mentionStart=_props6.start,mentionEnd=_props6.end,sign=_props6.title,resolvedFromTermMention=_props6.id;this.props.onResolve({conceptType:conceptType,mentionStart:mentionStart,mentionEnd:mentionEnd,sign:sign,resolvedFromTermMention:resolvedFromTermMention});}});var Term=createReactClass({displayName:'Term',propTypes:{term:PropTypes.oneOfType([PropTypes.shape(sharedProps),PropTypes.shape(selectionProps)]).isRequired,privileges:PropTypes.object.isRequired,actions:PropTypes.object.isRequired,getConceptOrDefault:PropTypes.func.isRequired},render:function render(){var _props7=this.props,term=_props7.term,privileges=_props7.privileges,actions=_props7.actions,getConceptOrDefault=_props7.getConceptOrDefault,vertices=_props7.vertices,edges=_props7.edges,onFocusElements=_props7.onFocusElements,rest=_objectWithoutProperties(_props7,['term','privileges','actions','getConceptOrDefault','vertices','edges','onFocusElements']);var type=term.type;var addTermToActions=function addTermToActions(func,name){if(name==='onResolve')return func;return function(event){return func(term,event);};};var itemProps=_extends({},term,_.mapObject(actions,addTermToActions),{getConceptOrDefault:getConceptOrDefault,vertices:vertices,edges:edges,onFocusElements:onFocusElements,onHoverTerm:this.onHoverTerm,canEdit:privileges.EDIT});switch(type){case'resolved':return React.createElement(Resolved,itemProps);case'suggestion':return React.createElement(Suggestion,itemProps);case'justification':return React.createElement(Justification,itemProps);case'selection':return React.createElement(TermSelection,itemProps);}return null;},onHoverTerm:function onHoverTerm(event){this.props.onHoverTerm(this.props.term.refId);}});return Term;});
//# sourceMappingURL=Term.js.map
