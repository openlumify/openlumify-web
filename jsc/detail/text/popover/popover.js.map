{"version":3,"sources":["../../../../js/detail/text/popover/popover.js"],"names":["define","defineComponent","withPopover","Attacher","rangeUtils","TextPopover","before","attacher","teardown","node","config","hideDialog","template","after","attr","selection","terms","sourceVertexId","targetVertexId","artifactId","propertyName","propertyKey","popover","find","path","params","behavior","onHoverTerm","id","trigger","comment","sourceInfo","openFullscreen","elementIds","document","reloadText","vertexId","closeDialog","clearSelection","attach","then","dialog","show","positionDialog"],"mappings":"AAAAA,OAAO,CACH,sBADG,CAEH,2BAFG,CAGH,yBAHG,CAIH,YAJG,CAAP,CAKG,SACCC,eADD,CAECC,WAFD,CAGCC,QAHD,CAICC,UAJD,CAIa,CAEZ,MAAOH,iBAAgBI,WAAhB,CAA6BH,WAA7B,CAAP,CAEA,QAASG,YAAT,EAAuB,CAEnB,KAAKC,MAAL,CAAY,UAAZ,CAAwB,UAAW,CAC/B,GAAI,KAAKC,QAAT,CAAmB,CACf,KAAKA,QAAL,CAAcC,QAAd,GACA,KAAKD,QAAL,CAAgB,IAAhB,CACH,CACJ,CALD,EAOA,KAAKD,MAAL,CAAY,YAAZ,CAA0B,SAASG,IAAT,CAAeC,MAAf,CAAuB,gBAC7CA,OAAOC,UAAP,CAAoB,IAApB,CACAD,OAAOE,QAAP,CAAkB,kCAAlB,CACA,KAAKC,KAAL,CAAW,mBAAX,CAAgC,UAAM,WAS9B,MAAKC,IATyB,CAE9BC,SAF8B,OAE9BA,SAF8B,CAG9BC,KAH8B,OAG9BA,KAH8B,CAI9BC,cAJ8B,OAI9BA,cAJ8B,CAK9BC,cAL8B,OAK9BA,cAL8B,CAM9BC,UAN8B,OAM9BA,UAN8B,CAO9BC,YAP8B,OAO9BA,YAP8B,CAQ9BC,WAR8B,OAQ9BA,WAR8B,CAWlC,MAAKd,QAAL,CAAgBJ,WACXM,IADW,CACN,MAAKa,OAAL,CAAaC,IAAb,CAAkB,kBAAlB,CADM,EAEXC,IAFW,CAEN,mCAFM,EAGXC,MAHW,CAGJ,CAAEV,mBAAF,CAAaC,WAAb,CAAoBG,qBAApB,CAAgCC,yBAAhC,CAA8CC,uBAA9C,CAA2DJ,6BAA3D,CAA2EC,6BAA3E,CAHI,EAIXQ,QAJW,CAIF,CACNC,YAAa,qBAACpB,QAAD,CAAWqB,EAAX,CAAkB,CAC3B,MAAKC,OAAL,CAAa,WAAb,CAA0B,CAAED,KAAF,CAA1B,EACH,CAHK,CAINE,QAAS,iBAACvB,QAAD,CAAWwB,UAAX,CAA0B,CAC/B,MAAKF,OAAL,CAAa,oBAAb,CAAmCE,UAAnC,EACH,CANK,CAONC,eAAgB,wBAACzB,QAAD,CAAW0B,UAAX,CAA0B,CACtC,MAAKJ,OAAL,CAAaK,QAAb,CAAuB,gBAAvB,CAAyCD,UAAzC,EACH,CATK,CAUNE,WAAY,qBAAM,CACd,MAAKN,OAAL,CAAaK,QAAb,CAAuB,aAAvB,CAAsC,CAAEE,SAAUjB,UAAZ,CAAtC,EACH,CAZK,CAaNkB,YAAa,sBAAM,CACfjC,WAAWkC,cAAX,GACA,MAAK9B,QAAL,GACH,CAhBK,CAJE,CAAhB,CAuBA,MAAKD,QAAL,CAAcgC,MAAd,GAAuBC,IAAvB,CAA4B,UAAM,CAC9B,MAAKC,MAAL,CAAYC,IAAZ,GACA,MAAKC,cAAL,GACH,CAHD,EAIH,CAtCD,EAuCH,CA1CD,EA2CH,CACJ,CAlED","file":"popover.js","sourcesContent":["define([\n    'flight/lib/component',\n    'util/popovers/withPopover',\n    'util/component/attacher',\n    'util/range'\n], function(\n    defineComponent,\n    withPopover,\n    Attacher,\n    rangeUtils) {\n\n    return defineComponent(TextPopover, withPopover);\n\n    function TextPopover() {\n\n        this.before('teardown', function() {\n            if (this.attacher) {\n                this.attacher.teardown();\n                this.attacher = null;\n            }\n        })\n\n        this.before('initialize', function(node, config) {\n            config.hideDialog = true;\n            config.template = '/detail/text/popover/popover.hbs';\n            this.after('setupWithTemplate', () => {\n                const {\n                    selection,\n                    terms,\n                    sourceVertexId,\n                    targetVertexId,\n                    artifactId,\n                    propertyName,\n                    propertyKey\n                } = this.attr;\n\n                this.attacher = Attacher()\n                    .node(this.popover.find('.popover-content'))\n                    .path('detail/text/popover/TermContainer')\n                    .params({ selection, terms, artifactId, propertyName, propertyKey, sourceVertexId, targetVertexId })\n                    .behavior({\n                        onHoverTerm: (attacher, id) => {\n                            this.trigger('hoverTerm', { id });\n                        },\n                        comment: (attacher, sourceInfo) => {\n                            this.trigger('commentOnSelection', sourceInfo);\n                        },\n                        openFullscreen: (attacher, elementIds) => {\n                            this.trigger(document, 'openFullscreen', elementIds);\n                        },\n                        reloadText: () => {\n                            this.trigger(document, 'textUpdated', { vertexId: artifactId });\n                        },\n                        closeDialog: () => {\n                            rangeUtils.clearSelection();\n                            this.teardown();\n                        }\n                    });\n\n                this.attacher.attach().then(() => {\n                    this.dialog.show();\n                    this.positionDialog();\n                })\n            })\n        })\n    }\n});\n"]}