{"version":3,"sources":["../../../../js/detail/item/types/flex.js"],"names":["define","defineComponent","domElement","FlexLayout","attributes","layoutConfig","children","before","syncStyles","node","container","_","toArray","forEach","el","item","after","on","event","data","target","renderChildren","attr","styling","calculateStyles","childElementCount","length","child","appendChild","element","removeChild","i","style","configuration","transformStyle","newStyles","options","styles","toRemove","split","keys","name","contains","removeStyles","$","css","isObject","flex","String","override","chain","flexDirection","display","extend","map","value","key","substring","toUpperCase","object"],"mappings":"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","file":"flex.js","sourcesContent":["define([\n    'flight/lib/component',\n    'util/domElement'\n], function(defineComponent, domElement) {\n    'use strict';\n\n    return defineComponent(FlexLayout);\n\n    function FlexLayout() {\n\n        this.attributes({\n            layoutConfig: null,\n            children: null\n        });\n\n        this.before('teardown', function() {\n            syncStyles(this.node, null, { container: true });\n            _.toArray(this.node.children).forEach(function(el) {\n                syncStyles(el, null, { item: true });\n            })\n        })\n\n        this.after('initialize', function() {\n\n            this.on('updateLayout', function(event, data) {\n                if (event.target === this.node) {\n                    this.renderChildren(data.layoutConfig, data.children);\n                }\n            })\n\n            this.renderChildren(this.attr.layoutConfig, this.attr.children);\n        });\n\n        this.renderChildren = function(layoutConfig, children) {\n            var styling = calculateStyles(layoutConfig)\n            syncStyles(this.node, styling, { container: true });\n\n            // Adding new children not in DOM\n            while (this.node.childElementCount < children.length) {\n                var child = children[this.node.childElementCount]\n                this.node.appendChild(child.element)\n            }\n\n            // Removing children that shouldn't be in DOM\n            while (this.node.childElementCount > children.length) {\n                this.node.removeChild(this.node.children[this.node.childElementCount - 1])\n            }\n\n            _.toArray(this.node.children).forEach(function(el, i) {\n                var child = children[i],\n                    style = child.configuration.style;\n\n                syncStyles(el, transformStyle(style), { item: true });\n            })\n        };\n    }\n\n    function syncStyles(el, newStyles, options) {\n        var styles = newStyles || {},\n            toRemove = (options.container ?\n                'flexDirection flexWrap display flexFlow justifyContent alignItems alignContent' :\n                'order alignSelf flex flexGrow flexShrink flexBasis'\n            ).split(' ');\n        _.keys(el.style).forEach(function(name) {\n            if (!(name in styles)) {\n                if (_.contains(toRemove, name)) {\n                    domElement.removeStyles(el, name);\n                }\n            }\n        })\n\n        if (newStyles) {\n            $(el).css(newStyles);\n        }\n    }\n\n    function transformStyle(css) {\n        if (!css || !_.isObject(css)) {\n            return;\n        }\n        // If it's an int, it can cause browsers issues\n        if (css.flex) {\n            css.flex = String(css.flex);\n        }\n        return css;\n    }\n\n    function calculateStyles(override) {\n        return _.chain({\n                flexDirection: 'column',\n                display: 'flex'\n            })\n            .extend(_.chain(override)\n                .map(function(value, key) {\n                    return ['flex' + key.substring(0, 1).toUpperCase() + key.substring(1), value];\n                })\n                .object()\n                .value()\n            )\n            .value()\n    }\n});\n"]}