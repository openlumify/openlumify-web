{"version":3,"sources":["../../js/fields/duration.js"],"names":["define","defineComponent","template","Duration","P","F","withPropertyField","withHistogram","DurationField","toSeconds","v","allValid","_","every","trim","split","n","number","isValidWithUnits","parse","milliseconds","NaN","e","after","attr","placeholder","i18n","$node","html","find","setValue","value","select","val","duration","getValue","isValid","name","property","title","isNumber","isNaN","vertex","singlePropValid","getMetadata","currentVal"],"mappings":"AACAA,OAAO,CACH,sBADG,CAEH,iBAFG,CAGH,aAHG,CAIH,cAJG,CAKH,wBALG,CAMH,qBANG,CAOH,iBAPG,CAAP,CAQG,SAASC,eAAT,CAA0BC,QAA1B,CAAoCC,QAApC,CAA8CC,CAA9C,CAAiDC,CAAjD,CAAoDC,iBAApD,CAAuEC,aAAvE,CAAsF,CACrF,aAEA,MAAON,iBAAgBO,aAAhB,CAA+BF,iBAA/B,CAAkDC,aAAlD,CAAP,CAEA,QAASE,UAAT,CAAmBC,CAAnB,CAAsB,CAClB,GAAI,CACA,GAAIC,UAAWC,EAAEC,KAAF,CAAQH,EAAEI,IAAF,GAASC,KAAT,CAAe,KAAf,CAAR,CAA+B,SAASC,CAAT,CAAY,CACtD,MAAOZ,GAAEa,MAAF,CAASC,gBAAT,CAA0BF,CAA1B,CAAP,CACH,CAFc,CAAf,CAIA,GAAIL,QAAJ,CAAc,CACV,MAAOR,UAASgB,KAAT,CAAeT,CAAf,EAAkBU,YAAlB,GAAmC,MAA1C,CACH,CAFD,IAEO,CACH,MAAOC,IAAP,CACH,CACJ,CAAC,MAAMC,CAAN,CAAS,CACP,MAAOD,IAAP,CACH,CACJ,CAED,QAASb,cAAT,EAAyB,CAErB,KAAKe,KAAL,CAAW,YAAX,CAAyB,UAAW,CAChC,KAAKC,IAAL,CAAUC,WAAV,CAAwBC,KAAK,+CAAL,CAAxB,CAEA,KAAKC,KAAL,CACKC,IADL,CACU1B,SAAS,KAAKsB,IAAd,CADV,EAEKK,IAFL,CAEU,OAFV,EAEmBL,IAFnB,CAEwB,SAFxB,CAEmC,+BAFnC,EAGH,CAND,EAQA,KAAKM,QAAL,CAAgB,SAASC,KAAT,CAAgB,CAC5B,KAAKC,MAAL,CAAY,eAAZ,EAA6BC,GAA7B,CAAiC5B,EAAEY,MAAF,CAASiB,QAAT,CAAkBH,KAAlB,CAAjC,EACH,CAFD,CAIA,KAAKI,QAAL,CAAgB,UAAW,CACvB,MAAO1B,WAAU,KAAKuB,MAAL,CAAY,eAAZ,EAA6BC,GAA7B,GAAmCnB,IAAnC,EAAV,CAAP,CACH,CAFD,CAIA,KAAKsB,OAAL,CAAe,SAASL,KAAT,CAAgB,CAC3B,GAAIM,MAAO,KAAKb,IAAL,CAAUc,QAAV,CAAmBC,KAA9B,CACA,MAAO3B,GAAE4B,QAAF,CAAWT,KAAX,GAAqB,CAACU,MAAMV,KAAN,CAAtB,EAAsC1B,EAAEqC,MAAF,CAASC,eAAT,CAAyBZ,KAAzB,CAAgCM,IAAhC,CAA7C,CACH,CAHD,CAKA,KAAKO,WAAL,CAAmB,UAAW,CAC1B,GAAIC,YAAa,KAAKV,QAAL,EAAjB,CACA,GAAIU,YAAc,CAACJ,MAAMI,UAAN,CAAnB,CAAsC,CAClC,MAAO,CAAE,uCAAwC,CAA1C,CAAP,CACH,CACD,MAAO,KAAP,CACH,CAND,CAOH,CACJ,CA5DD","file":"duration.js","sourcesContent":["\ndefine([\n    'flight/lib/component',\n    './doubleTpl.hbs',\n    'duration-js',\n    'util/parsers',\n    'util/vertex/formatters',\n    './withPropertyField',\n    './withHistogram'\n], function(defineComponent, template, Duration, P, F, withPropertyField, withHistogram) {\n    'use strict';\n\n    return defineComponent(DurationField, withPropertyField, withHistogram);\n\n    function toSeconds(v) {\n        try {\n            var allValid = _.every(v.trim().split(/\\s+/), function(n) {\n                return P.number.isValidWithUnits(n);\n            });\n\n            if (allValid) {\n                return Duration.parse(v).milliseconds() / 1000.0;\n            } else {\n                return NaN;\n            }\n        } catch(e) {\n            return NaN;\n        }\n    }\n\n    function DurationField() {\n\n        this.after('initialize', function() {\n            this.attr.placeholder = i18n('field.double.displaytype.duration.placeholder');\n\n            this.$node\n                .html(template(this.attr))\n                .find('input').attr('pattern', '^([\\\\d.]+[wdhms]+[\\\\s,;:]*)+$');\n        });\n\n        this.setValue = function(value) {\n            this.select('inputSelector').val(F.number.duration(value));\n        };\n\n        this.getValue = function() {\n            return toSeconds(this.select('inputSelector').val().trim());\n        };\n\n        this.isValid = function(value) {\n            var name = this.attr.property.title;\n            return _.isNumber(value) && !isNaN(value) && F.vertex.singlePropValid(value, name);\n        };\n\n        this.getMetadata = function() {\n            var currentVal = this.getValue();\n            if (currentVal && !isNaN(currentVal)) {\n                return { 'http://openlumify.org#inputPrecision': 0 };\n            }\n            return null;\n        };\n    }\n});\n"]}