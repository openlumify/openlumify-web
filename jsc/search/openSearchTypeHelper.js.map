{"version":3,"sources":["../../js/search/openSearchTypeHelper.js"],"names":["define","openSearchType","searchType","options","$searchPane","$","Promise","fulfill","reject","hasClass","document","on","handler","data","off","trigger","name","then","currentType","find","lookupAllComponents","forEach","c","filtersLoaded","length","advancedSearchActive","f","loadedHandler","event","target","node","clearSearch","toLowerCase"],"mappings":"AAAAA,OAAO,CAAC,cAAD,CAAP,CAAyB,UAAW,CAChC,aAEA,MAAO,CACHC,eAAgB,wBAASC,UAAT,CAAqBC,OAArB,CAA8B,CAC1C,GAAIC,aAAcC,EAAE,cAAF,CAAlB,CACA,MAAO,IAAIC,QAAJ,CAAY,SAASC,OAAT,CAAkBC,MAAlB,CAA0B,CACrC,GAAIJ,YAAYK,QAAZ,CAAqB,SAArB,CAAJ,CAAqC,CACjCF,UACH,CAFD,IAEO,CACHF,EAAEK,QAAF,EAAYC,EAAZ,CAAe,mBAAf,CAAoC,QAASC,QAAT,CAAiBC,IAAjB,CAAuB,CACvDR,EAAE,IAAF,EAAQS,GAAR,CAAY,mBAAZ,CAAiCF,OAAjC,EACAL,UACH,CAHD,EAGGQ,OAHH,CAGW,sBAHX,CAGmC,CAAEC,KAAM,QAAR,CAHnC,EAIH,CACJ,CATE,EAUFC,IAVE,CAUG,UAAW,CACb,GAAIC,aAAc,IAAlB,CACAd,YAAYe,IAAZ,CAAiB,UAAjB,EAA6BC,mBAA7B,GAAmDC,OAAnD,CAA2D,SAASC,CAAT,CAAY,CACnE,GAAIA,EAAEpB,UAAN,CAAkB,CACdgB,YAAcI,EAAEpB,UAAhB,CACH,CACJ,CAJD,EAMA,GAAIqB,eAAgBnB,YAAYe,IAAZ,CAAiB,iBAAjB,EAAoCK,MAAxD,CACIC,qBAAuBrB,YAAYe,IAAZ,CAAiB,qBAAjB,EAAwCK,MAAxC,GAAmD,CAD9E,CAGA,GAAIC,sBACA,CAACF,aADD,EAEA,CAACL,WAFD,EAGAA,cAAgBhB,UAHpB,CAGgC,CAC5B,MAAO,IAAII,QAAJ,CAAY,SAASoB,CAAT,CAAY,CAC3BrB,EAAEK,QAAF,EAAYC,EAAZ,CAAe,kBAAf,CAAmC,QAASgB,cAAT,CAAuBC,KAAvB,CAA8B,CACzDvB,EAAE,IAAF,EAAQS,GAAR,CAAY,kBAAZ,CAAgCa,aAAhC,EACAD,EAAEE,MAAMC,MAAR,EACH,CAHL,EAIKd,OAJL,CAIa,kBAJb,CAIiCb,UAJjC,EAKH,CANM,CAAP,CAOH,CACJ,CAjCE,EAkCFe,IAlCE,CAkCG,SAASa,IAAT,CAAe,CACjB,GAAI3B,SAAWA,QAAQ4B,WAAR,GAAwB,IAAvC,CAA6C,CACzC3B,YACKe,IADL,CACU,gBAAkBjB,WAAW8B,WAAX,EAD5B,EAEKjB,OAFL,CAEa,aAFb,EAGH,CAED,MAAOe,KAAP,CACH,CA1CE,CAAP,CA2CH,CA9CE,CAAP,CAgDH,CAnDD","file":"openSearchTypeHelper.js","sourcesContent":["define(['util/promise'], function() {\n    'use strict';\n\n    return {\n        openSearchType: function(searchType, options) {\n            var $searchPane = $('.search-pane');\n            return new Promise(function(fulfill, reject) {\n                    if ($searchPane.hasClass('visible')) {\n                        fulfill();\n                    } else {\n                        $(document).on('searchPaneVisible', function handler(data) {\n                            $(this).off('searchPaneVisible', handler);\n                            fulfill();\n                        }).trigger('menubarToggleDisplay', { name: 'search' });\n                    }\n                })\n                .then(function() {\n                    var currentType = null;\n                    $searchPane.find('.content').lookupAllComponents().forEach(function(c) {\n                        if (c.searchType) {\n                            currentType = c.searchType;\n                        }\n                    });\n\n                    var filtersLoaded = $searchPane.find('.search-filters').length,\n                        advancedSearchActive = $searchPane.find('.search-type.active').length === 0;\n\n                    if (advancedSearchActive ||\n                        !filtersLoaded ||\n                        !currentType ||\n                        currentType !== searchType) {\n                        return new Promise(function(f) {\n                            $(document).on('searchtypeloaded', function loadedHandler(event) {\n                                    $(this).off('searchtypeloaded', loadedHandler);\n                                    f(event.target);\n                                })\n                                .trigger('switchSearchType', searchType);\n                        })\n                    }\n                })\n                .then(function(node) {\n                    if (options && options.clearSearch === true) {\n                        $searchPane\n                            .find('.search-type-' + searchType.toLowerCase())\n                            .trigger('clearSearch');\n                    }\n\n                    return node;\n                })\n        }\n    }\n})\n"]}